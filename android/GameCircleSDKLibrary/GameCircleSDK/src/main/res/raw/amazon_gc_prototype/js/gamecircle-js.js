/*! Copyright 2013 Amazon Digital Services, Inc. All rights reserved. */
var PriorityQueue=function(e){function a(){c.sort(function(b,d){return d.pri-b.pri})}function f(b){var d;for(d=0;d<c.length;d+=1)if(c[d].obj===b)return d;return-1}var c=[];return{push:function(b,d){e&&c.length>=e&&c.pop();c.push({pri:d,obj:b});a()},pop:function(){return c.length>0?c.shift().obj:null},contains:function(b){return f(b)!==-1},remove:function(b){b=f(b);b!==-1&&c.splice(b,1)}}};
(function(e){function a(){var d=c.pop();if(d){b=1;var h=e.ajax(d.opts),g=setTimeout(function(){if(h.readyState===4){b=0;a()}else h.abort()},f);d.d.resolveSent();h.done(function(){d.d.resolve.apply(null,arguments)});h.fail(function(){d.d.reject.apply(null,arguments)});h.always(function(){clearTimeout(g);b=0;a()})}}var f=8E3,c=new PriorityQueue(100),b=0;e.ajaxQueue=function(d){var h=d.priority||1,g=e.Deferred(),j=g.promise();g.requestWasSent=0;g.sentHandlers=[];j.sent=function(l){g.requestWasSent?l():
g.sentHandlers.push(l);return j};g.resolveSent=function(){g.requestWasSent=1;e.each(g.sentHandlers,function(l,k){k()})};c.push({d:g,opts:d},h);b||a();return j}})(jQuery);
var ScreenReaderSelectionHack=function(){function e(){$("body").unbind("tap").bind("tap",function(){})}return{dispatchToScreenReaderElement:function(a){if(window.cvox&&window.cvox.ChromeVox&&window.cvox.ChromeVox.isActive){var f=document.activeElement;for(a=a;a&&a!==document.body&&a!==f;)a=a.parentNode;if(a===f)window.cvox.Focuser?window.cvox.Focuser.setFocus(document.body):document.body.focus();else{f=$(document.activeElement);$(f).tap();return true}}return false},captureAllTaps:function(){if(window.cvox){console.log("ScreenReaderSelectionHack: chromeVoxLoaded already loaded; binding tap to body");
e()}else document.addEventListener("chromeVoxLoaded",function(){console.log("ScreenReaderSelectionHack: got chromeVoxLoaded event; binding tap to body");e()})}}}();
(function(e){var a=typeof window.ontouchstart!=="undefined",f=a?"touchstart.tap":"mousedown.tap",c=a?"touchmove.tap":"mousemove.tap",b=a?"touchend.tap":"mouseup.tap";e.each(["touchstart","touchmove","touchend","tap","taphold"],function(d,h){e.fn[h]=function(g){return g?this.bind(h,g):this.trigger(h)};if(e.attrFn)e.attrFn[h]=true});e.event.special.tap={};e.event.special.tap.setup=function(d,h){var g=this,j=e(g),l=h&&h.length>0?"."+h.join("."):"",k=d&&d.tapTimeout||1500;j.bind(f+l,function(m){function n(t){if(t.type===
"touchstart"||t.type==="touchmove"||t.type==="touchend"){t.pageX=t.originalEvent.touches[0].pageX;t.pageY=t.originalEvent.touches[0].pageY}}function s(t){var o=m.type;m.type=t;e.event.handle.call(g,m);m.type=o}function q(){j.unbind(c+l+" "+b+l);clearTimeout(u)}var u;n(m);var p=m.pageX,r=m.pageY;u=setTimeout(function(){q();s("taphold")},k);j.unbind(c+l+" "+b+l);j.one(b+l,function(t){q();if(!ScreenReaderSelectionHack.dispatchToScreenReaderElement(g)){s("tap");g.nodeName.toLowerCase()!=="input"&&g.nodeName.toLowerCase()!==
"textarea"&&t.preventDefault()}}).bind(c+l,function(t){n(t);if(Math.abs(t.pageX-p)>10||Math.abs(t.pageY-r)>10)q()})})};e.event.special.tap.teardown=function(d){d=d&&d.length>0?"."+d.join("."):"";e(this).unbind(f+d+" "+c+d+" "+b+d)};e.event.special.taphold={};e.event.special.taphold.setup=function(d,h){var g=h&&h.length>0?"."+h.join("."):"";e(this).bind("tap"+g,d,e.noop)}})(jQuery);
(function(e){function a(c){var b,d={docFrag:document.createDocumentFragment(),height:0,remainderHeight:0};if(c.accumHeight>=c.minHeight||!c.source||c.source.length===0)return d;b=c.source;var h=c.accumHeight,g=document.createRange(),j;if(b.nodeType&&b.nodeType===3||b[0]&&b[0].nodeType===3){h={source:b,heightpx:c.maxHeight-h};if(c.bTruncMark){h.bTruncMark=true;h.truncChar=c.truncChar}if((c=f(h))&&c.docFrag){d.docFrag=c.docFrag;d.height=c.height;d.remainderHeight=c.remainderHeight}return d}if(b.nodeType)b=
e(b);var l;g.selectNodeContents(b[0]);j=g.getBoundingClientRect();if(!j||j.height+h<=c.maxHeight)return d;else l=j.height;g=document.createRange();j=null;var k=b.contents(),m,n;g.setStartBefore(k[0]);for(b=0;b<k.length;b+=1){g.setEndAfter(k[b]);if((j=g.getBoundingClientRect())&&j.height+h>c.maxHeight){m=k[b];break}else n=k[b]}b=document.createRange();b.selectNodeContents(m);if((b=b.getBoundingClientRect())&&b.height)h+=j.height-b.height;if(n){g.setEndAfter(n);d.docFrag=g.cloneContents()}if(h>=c.minHeight){d.height=
h;d.remainderHeight=l-d.height;return d}n=j=0;if(m.nodeType===3)g=document.createElement("span");else{n=e(m);g=document.createElement(m.tagName);j=parseInt(n.css("margin-top"),10);n=parseInt(n.css("margin-bottom"),10);if(isNaN(j))j=0;if(isNaN(n))n=0}recursiveParams={source:m,minHeight:c.minHeight,maxHeight:c.maxHeight,accumHeight:h+j+n};if(c.bTruncMark){recursiveParams.bTruncMark=true;recursiveParams.truncChar=c.truncChar}c=a(recursiveParams);g.appendChild(c.docFrag);d.docFrag.appendChild(g);d.height=
h+c.height;d.remainderHeight=l-d.height;return d}function f(c){var b={paramsOk:false},d=parseInt(c.heightpx,10);if(isNaN(d))return b;var h=null;if(c.source)h=c.source.length>0&&c.source[0]?c.source[0]:c.source;if(!h||h.nodeType===undefined||h.nodeType!==3)return b;var g=document.createRange(),j=function(s,q){g.setStart(h,s);g.setEnd(h,q);var u=g.getBoundingClientRect();return u?u.height:0};b.paramsOk=true;var l=0,k=h.textContent.length,m=j(0,k);if(m<=d)return b;for(;k-l>1;){var n=Math.floor((l+k)/
2);if(j(0,n)<d)l=n;else k=n-1}b.height=j(0,l);b.docFrag=g.cloneContents();d=e.trim(b.docFrag.textContent);if(c.bTruncMark&&d.length>3)d=d.substring(0,d.length-3)+String.fromCharCode(c.truncChar);b.docFrag.textContent=d;b.remainderHeight=m-b.height;return b}e.truncateHtmlToHeight=function(c){var b={paramsOk:false};if(!(c&&c.source&&c.source.length>0&&c.heightpx!==undefined))return b;b.paramsOk=true;var d=c.source,h=parseInt(c.heightpx,10);b.renderStateOk=d.height()!==0;if(!b.renderStateOk)return b;
var g=document.createRange();g.selectNodeContents(d[0]);g=g.getBoundingClientRect();if(!g||g.height<=h)return b;d={source:d,minHeight:c.minHeightpx||h,maxHeight:h,accumHeight:0};if(c.bTruncMark){d.bTruncMark=true;d.truncChar=c.truncChar||8230}if((c=a(d))&&c.docFrag&&c.docFrag.textContent){b.docFrag=c.docFrag;b.height=c.height;b.remainderHeight=c.remainderHeight}return b}})(jQuery);
(function(e){e.truncateHtmlToMaxNumOfLines=function(){function a(c,b){var d={};if(!c){d.message="Source is null";return d}if(!b||b<1){d.message="Max number of lines must be a positive integer";return d}var h=e(c).contents();if(h.length!==1||h[0].nodeType!==3){d.message="Source's child is not one text node";return d}d.textNodeToTruncate=h[0];return d}function f(c){return(c=c.getBoundingClientRect())?c.height:0}return function(c,b){var d={},h=a(c,b);if(h.message){d.message=h.message;return d}h=h.textNodeToTruncate;
var g=h.textContent,j=document.createRange(),l=String.fromCharCode(8230);j.selectNodeContents(h);var k=f(j);h.textContent=l;j.selectNodeContents(h);var m=f(j);k=Math.round(k/m);if(k<=b){h.textContent=g;d.truncatedContent=h;d.actualNumberOfLines=k;return d}k=0;for(var n=g.length,s;n-k>1;){s=Math.floor((n+k)/2);h.textContent=g.substring(0,s)+l;j.selectNodeContents(h);if(Math.round(f(j)/m)<=b)k=s;else n=s}h.textContent=g.substring(0,k)+l;d.truncatedContent=h;d.actualNumberOfLines=b;return d}}()})(jQuery);
(function(e){var a=typeof window.ontouchstart!=="undefined",f=a?"touchstart.uifeedback":"mousedown.uifeedback",c=a?"touchmove.uifeedback":"mousemove.uifeedback",b=a?"touchend.uifeedback":"mouseup.uifeedback";e.setUIFeedbackDelay=function(d){DEFAULT_FEEDBACK_DELAY=d};e.fn.addUIFeedback=function(){this.unbind(f).bind(f,function(d){return function(){d.data("feedback_pending",true);if(d.data("feedback_pending")){d.data("feedback_pending",false);d.data("feedback_shown",true);d.addClass("clicked");var h=
setTimeout(function(){d.data("feedback_shown",false);d.removeClass("clicked");d.unbind(c).unbind(b)},1400);d.data("feedback_end_timeout",h)}d.unbind(c).bind(c,function(){d.data("feedback_pending",false);d.data("feedback_shown",false);d.removeClass("clicked");d.unbind(c).unbind(b);clearTimeout(d.data("feedback_end_timeout"))});d.unbind(b).bind(b,function(){if(d.data("feedback_pending")){d.data("feedback_pending",false);d.data("feedback_shown",true);d.addClass("clicked")}if(d.data("feedback_shown")){clearTimeout(d.data("feedback_end_timeout"));
var g=setTimeout(function(){d.data("feedback_shown",false);d.removeClass("clicked");d.unbind(c).unbind(b)},1E3);d.data("feedback_hide_timeout",g)}})}}(this));return this}})(jQuery);
window.gls=function(e){window.stringBundle=window.stringBundle||{};var a=stringBundle[e],f=arguments;if(a)if(typeof f[1]==="object"){var c=f[1];a=a.replace(/\$\{(\w+?)\}/g,function(b,d){var h=c[d];return typeof h!=="undefined"?h:b})}else{if(f.length>1)a=a.replace(/\$\{([1-9]+?)\}/g,function(b,d){var h=f[d];return typeof h!=="undefined"?h:b})}else a=e;return a};
BrowserUtility=function(){return new function(){var e=this;this.launchLegalInformation=function(){return e.launch("http://www.amazon.com/gamecircle_legal")};this.launchCORChange=function(){return e.launch("https://www.amazon.com/gp/digital/fiona/manage?ie=UTF8&ref_=ya_manage_kindle&signInRedirect=1&#cor")};this.launchRevokeAuthToken=function(){return e.launch("https://www.amazon.com/ap/adam/ref=ya_iba")};this.launch=function(a){var f={};f[constants.NativeCallKeys.URL]=a;NativeTransport.callNative({nativeCall:constants.NativeCallTypes.OPEN_BROWSER,
args:f});return null}}}();DOMUtility=function(){return function(){this.convertSpanToAnchor=function(e,a,f){var c=a.find("#"+e);if(c.length===0)console.error("Span "+e+" not found");else{a=$('<a href="#"></a>');a.attr("id",e);a.html(c.html());c.removeAttr("id");c.html("");c.append(a);e="tap."+e;a.unbind(e).bind(e,f)}}}}();
EmailUtility=function(){return function(){function e(a){var f=applicationContext.getObject("ApplicationName"),c=applicationContext.getObject("ClientVersionString"),b=applicationContext.getObject("ContentVersionString"),d=applicationContext.getObject("DeviceId"),h=applicationContext.getObject("DeviceManufacturer"),g=applicationContext.getObject("DeviceModel"),j=applicationContext.getObject("DeviceType");a=a;a+="\n\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_application")+
": "+f+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_sdk_version")+": "+c+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_content_version")+": "+b+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_device_id")+": "+d+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_device_manufacturer")+": "+h+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_device_model")+
": "+g+"\n";a+=applicationContext.getObject("StringLocalizationWrapper").getString("email_device_type")+": "+j;return a}this.openHelpEmail=function(){var a=applicationContext.getObject("ApplicationName");a=applicationContext.getObject("StringLocalizationWrapper").getString("menu_help_email_subject",{gamename:a});var f=applicationContext.getObject("StringLocalizationWrapper").getString("menu_help_email_content");f=e(f);var c={},b="gamecircle-feedback@amazon.com";if(applicationContext.getObject("DeviceLanguageWasSupported"))b=
applicationContext.getObject("ElementLocalizationWrapper").getElement("help_and_feedback_email");c[constants.NativeCallKeys.MAIL_TO]=b;c[constants.NativeCallKeys.SUBJECT]=a;c[constants.NativeCallKeys.BODY]=f;c[constants.NativeCallKeys.EMAIL_ERROR_TITLE]=applicationContext.getObject("StringLocalizationWrapper").getString("menu_link_help");c[constants.NativeCallKeys.EMAIL_ERROR_MESSAGE]=applicationContext.getObject("StringLocalizationWrapper").getString("email_error_message");c[constants.NativeCallKeys.EMAIL_ERROR_BUTTON_TITLE]=
applicationContext.getObject("StringLocalizationWrapper").getString("email_error_button_title");NativeTransport.callNative({nativeCall:constants.NativeCallTypes.OPEN_EMAIL_EDITOR,args:c});return null};this.openFeedbackEmail=function(){var a=applicationContext.getObject("ApplicationName");a=applicationContext.getObject("StringLocalizationWrapper").getString("menu_feedback_email_subject",{gamename:a});var f=applicationContext.getObject("StringLocalizationWrapper").getString("menu_feedback_email_content");
f=e(f);var c={},b="gamecircle-feedback@amazon.com";if(applicationContext.getObject("DeviceLanguageWasSupported"))b=applicationContext.getObject("ElementLocalizationWrapper").getElement("help_and_feedback_email");c[constants.NativeCallKeys.MAIL_TO]=b;c[constants.NativeCallKeys.SUBJECT]=a;c[constants.NativeCallKeys.BODY]=f;c[constants.NativeCallKeys.EMAIL_ERROR_TITLE]=applicationContext.getObject("StringLocalizationWrapper").getString("menu_link_give_feedback");c[constants.NativeCallKeys.EMAIL_ERROR_MESSAGE]=
applicationContext.getObject("StringLocalizationWrapper").getString("email_error_message");c[constants.NativeCallKeys.EMAIL_ERROR_BUTTON_TITLE]=applicationContext.getObject("StringLocalizationWrapper").getString("email_error_button_title");NativeTransport.callNative({nativeCall:constants.NativeCallTypes.OPEN_EMAIL_EDITOR,args:c});return null}}}();
ExperimentWrapper=function(){return function(e){this.getTreatment=function(a){a=e[a];if(a===undefined||a===null)a="DEFAULT";return a};this.isTreatmentDefault=function(a){return a==="DEFAULT"}}}();if(typeof gcenv==="undefined")gcenv={};if(typeof gcenv.weblab==="undefined")gcenv.weblab={};
Fluidity=function(){var e={};Fluidity=function(){};Fluidity.start=function(a){var f={ticks:0,startTime:Date.now()};f.timeout=setInterval(function(){f.ticks++},0);e[a]=f};Fluidity.stop=function(a){clearInterval(e[a].timeout);Date.now()};return Fluidity}();Inheritance=function(){};Inheritance.inherit=function(e,a){e.parentconstructor=a;e.prototype=new a;e.prototype.constructor=e;e.prototype.getName=function(){return e.name}};
LifecyclePhases=function(){return{NO_PHASE:-1,CF_PHASE:0,ATF_PHASE:1,BTF_PHASE:2,CACHE_PHASE:3,AUTH_PHASE:4,IMAGE_PHASE:5,PRE_PHASE:6}}();
(function(e){var a=function(c,b){return e.map(c.split(" "),function(d){return d+b}).join(" ")},f=function(c){var b;if(c.charAt(0)!==".")b="."+c;return b};e.fn.rebind=function(c,b,d){var h=f(b),g=a(c,b);return this.each(function(){e(this).unbind(h).bind(g,d)})};e.fn.rebindOnce=function(c,b,d){var h=f(b),g=a(c,b);return this.each(function(){e(this).unbind(h).one(g,d)})}})(jQuery);
ScreenOrientation=function(){return{PORTRAIT:"portrait",LANDSCAPE:"landscape",getCurrentOrientation:function(){return applicationContext.getObject("ScreenSize").isWide()?ScreenOrientation.LANDSCAPE:ScreenOrientation.PORTRAIT},isLandscape:function(){return this.getCurrentOrientation()===this.LANDSCAPE},isPortrait:function(){return this.getCurrentOrientation()===this.PORTRAIT}}}();
ScreenSize=function(){var e=120,a=50;return function(f){function c(){h.detectNewScreenSize();if(q.isScreenSizeValid(d,b,parseInt($.url.param("w"),10),parseInt($.url.param("h"),10)))$(window).trigger("resize");else if(s<e){s++;setTimeout(c,a)}else hostinterface.logMessage("1")}var b,d,h=this,g,j,l,k,m,n=false,s=0,q=applicationContext.getObject("ScreenSizeValidator"),u=applicationContext.getObject("PageController");f||(f="resize");var p=function(){var r=window.devicePixelRatio,t=$('meta[name="viewport"]').attr("content");
if(t&&t.match(/target-densityDpi=device-dpi/))r=1;return r}();this.getScreenWidth=function(){return b};this.getScreenHeight=function(){return d};this.isWide=function(){return m===ScreenOrientation.LANDSCAPE};this.adjust=function(r){if(r.width&&r.height){b=r.width;d=r.height;r=window.outerWidth-window.innerWidth;var t=window.outerHeight-window.innerHeight;window.resizeTo&&typeof window.resizeTo==="function"&&window.resizeTo(b+r,d+t);b=window.outerWidth;d=window.outerHeight}else{b=window.innerWidth||
768;d=window.innerHeight||1004}this.detectNewScreenSize();g=d;j=b;this.bindToScreenSizeChange(this.detectNewScreenSize,"screenSizeDetectNewScreenSize");this.bindToScreenSizeChange(u.updateScreenSize,"pageControllerUpdateScreenSize");q.isScreenSizeValid(d,b,parseInt($.url.param("w"),10),parseInt($.url.param("h"),10))||setTimeout(function(){c()},a)};this.detectNewScreenSize=function(){if(applicationContext.isInsideIFrame()){$("body").hide();$("#gcholder").width()}b=window.innerWidth;d=window.innerHeight;
if(g<d&&j<b){g=d;j=b}$("#agc-app").width(b);$("#agc-app").height(d);applicationContext.isInsideIFrame()&&$("body").show();if(q.isScreenSizeValid(p*d,p*b,parseInt($.url.param("w"),10),parseInt($.url.param("h"),10))){if(!k||!l){k=d;l=b}var r=Math.abs(d-k)>=applicationContext.getEstimatedKeyboardHeight();if(l===b&&r){n=d<k;$(window).trigger(Event.KeyboardChange,n)}m||(m=b>d?ScreenOrientation.LANDSCAPE:ScreenOrientation.PORTRAIT);var t;if(Math.abs(l-b)>Math.max(b,d)/10)if(l<b)t=ScreenOrientation.LANDSCAPE;
else if(l>b)t=ScreenOrientation.PORTRAIT;if(t&&m!==t){m=t;$(window).trigger(Event.TOSOrientationChange,m)}k=d;l=b}};this.getScreenHeightWithoutKeyboard=function(){return m===ScreenOrientation.LANDSCAPE?g<j?g:j:g>j?g:j};this.bindToScreenSizeChange=function(r,t){t?$(window).unbind(f+"."+t).bind(f+"."+t,r):$(window).bind(f,r)};this.unbindScreenSizeChange=function(r){r&&$(window).unbind(f+"."+r)};this.bindToKeyboardChange=function(r,t){t?$(window).unbind(Event.KeyboardChange+"."+t).bind(Event.KeyboardChange+
"."+t,r):console.error("ERROR: bindToKeboardChange without specifying namespace will be ignored!")};this.unbindKeyboardChange=function(r){r?$(window).unbind(Event.KeyboardChange+"."+r):console.error("ERROR: unbindKeyboardChange without specifying namespace will be ignored!")};this.isKeyboardUp=function(){return n};this.bindToOrientationChange=function(r,t){t?$(window).unbind(Event.TOSOrientationChange+"."+t).bind(Event.TOSOrientationChange+"."+t,r):console.error("ERROR: bindToOrientationChange without specifying namespace will be ignored!")};
this.unbindOrientationChange=function(r){r?$(window).unbind(Event.TOSOrientationChange+"."+r):console.error("ERROR: unbindOrientationChange without specifying namespace will be ignored!")}}}();SimpleScreenSizeValidator=function(){return function(){this.isScreenSizeValid=function(e,a){return e!==0&&a!==0}}}();
Sprite=function(){function e(b,d){var h=d.alignment,g=d.buffer,j;if(d.hexColor){j=d.hexColor;if(j[0]==="#")j=j.substring(1);j={r:parseInt(j.substring(0,2),16),g:parseInt(j.substring(2,4),16),b:parseInt(j.substring(4,6),16)}}else j=d.color;var l=j;j=b||[];var k=d.useSSL?f:a,m;if(d.sizeTag){var n=d.sizeTag;if((xIndex=n.indexOf("X"))>=0)m=n.substring(xIndex+1,n.indexOf("_",xIndex));if((yIndex=n.indexOf("Y"))>=0)var s=n.substring(yIndex+1,n.indexOf("_",yIndex));m={width:m||DEFAULT_SIZE.width,height:s||
DEFAULT_SIZE.height}}else m=d.size;this.size=m;this.droppedImages=[];j.sort();this.offsets=[];for(i=0;i<j.length;i++)if(j[i].match(/no-book-cover/)||j[i].match(/png$/)){this.droppedImages.push(j[i]);j.splice(i,1);i--}else{this.offsets[j[i]]=-i*(parseInt(this.size.width,10)+parseInt(g,10));this.offsets.length++}m=this.size;if(j.length>0){m="._SP"+m.width+","+m.height+",";g=g+",";h=h+",";l=l.r+","+l.g+","+l.b+"|";s=j[0].indexOf(".");k=k+j[0].substring(0,s)+m+g+h+l;for(i=1;i<j.length;i++){k+=j[i];if(i<
j.length-1)k+=","}k+="_.jpg";j=k}else j=null;this.url=j}var a="http://ecx.images-amazon.com/images/I/",f="https://images-na.ssl-images-amazon.com/images/I/",c={alignment:"B",buffer:10,color:{r:18,g:18,b:18},hexColor:null,size:{width:100,height:144},sizeTag:null,useSSL:false};e.prototype={getURL:function(){return this.url},getImageOffset:function(b){return this.offsets[b]},getCSSObject:function(b){b=this.getImageOffset(b);if(typeof b!=="undefined")return{"background-image":"url("+this.getURL()+")",
"background-position":b+"px 0px","background-repeat":"no-repeat",height:this.size.height,width:this.size.width};return null},getDroppedImages:function(){return this.droppedImages}};return{create:function(b,d){var h=$.extend({},c,d);return new e(b,h)},getDefaultSettings:function(){return c},setDefaultSettings:function(b){c=$.extend(c,b)}}}();
StringLocalizationWrapper=function(){return function(e,a){this.getString=function(f,c){return StringsUtility.getString(f,e,a,c)};this.getStrings=function(f){f!==undefined&&f.length&&$(f).find(".agc-string").each(function(){var c=$(this).data("string");c!==undefined&&$(this).html(StringsUtility.getString(c,e,a))})}}}();ElementLocalizationWrapper=function(){return function(e,a){this.getElement=function(f,c){return ElementsUtility.getElement(f,e,a,c)}}}();
Event={Add:"add",AddNarration:"AddNarration",AjaxResponseReceived:"ajaxResponseReceived",Back:"back",BookListUpdated:"bookListUpdated",BorrowError:"BorrowError",BorrowReturn:"BorrowReturn",BorrowSucceeded:"BorrowSucceeded",BorrowTapped:"BorrowTapped",BuyOrderCreated:"BuyOrderCreated",BuyAlreadyPurchased:"BuyAlreadyPurchased",BuyAlreadyRented:"BuyAlreadyRented",BuyError:"BuyError",BuyMorePidsTapped:"BuyMorePidsTapped",BuyTapped:"BuyTapped",BuyAudibleOrderCreated:"BuyAudibleOrderCreated",ButtonTapped:"ButtonTapped",
Cancel:"cancel",CustomerReviewTouchpointTapped:"CustomerReviewTouchpointTapped",DetailPageStateUpdated:"detailPageStateUpdated",DigitalAssociateBuyTapped:"DigitalAssociateBuyTapped",DownloadBookTapped:"DownloadBookTapped",DownloadBookSent:"DownloadBookSent",DownloadTimeout:"downloadTimeout",ExtendedDetailsLoaded:"extendedDetailsLoaded",TransitionFromFilterPageToDetailPage:"filterToDetailTransition",FilterSelected:"filterSelected",HistoryBackEmptied:"historyBackEmptied",HistoryBackPopulated:"historyBackPopulated",
HistoryForwardEmptied:"historyForwardEmptied",HistoryForwardPopulated:"historyForwardPopulated",HushpuppyLearnMoreTapped:"HushpuppyLearnMoreTapped",ItemSelected:"itemSelected",ItemSetUpdated:"itemListUpdated",iTunesLinkTapped:"iTunesLinkTapped",InitialPageReady:"initialPageReady",LinkToAudibleTapped:"LinkToAudibleTapped",Loaded:"loaded",LoadNextPage:"loadNextPage",ParentSelected:"parentSelected",PreorderTapped:"PreorderTapped",PrimeBorrowLearnMore:"PrimeBorrowLearnMore",PrimeBorrowMonthlyLimit:"PrimeBorrowMonthlyLimit",
PrimeBorrowStateUnknown:"PrimeBorrowStateUnknown",ReadAndListenTapped:"ReadAndListenTapped",ReadInAppTapped:"ReadInAppTapped",ReadInBrowserTapped:"ReadInBrowserTapped",RefineBrowse:"refineBrowse",Refine:"refine",RentExternallyTapped:"RentExternallyTapped",Retry:"retry",SampleSent:"sampleSent",SampleTapped:"SampleTapped",Selected:"selected",SingleIssueTapped:"SingleIssueTapped",SizeChanged:"SizeChanged",SortSelected:"sortSelected",SubscribeExternallyTapped:"SubscribeExternallyTapped",SubscribeTapped:"SubscribeTapped",
SubscribeResubscribeRequired:"SubscribeRescribeRequired",SubscribeAlreadySubscribed:"SubscribeAlreadySubscribed",SubscribeSubscriptionCreated:"SubscribeSubscriptionCreated",Updated:"updated",LightBoxClosed:"lightBoxClosed",PageRequiresRefresh:"requiresRefresh",IframeFixUpCase:"iframeFixUpCase",KeyboardChange:"keyboardChange",TOSOrientationChange:"TOSOrientationChange",UnhandledUnbuyError:"UnhandledUnbuyError",WishListAddTapped:"WishListAddTapped",WishlistTapped:"WishlistTapped",PeriodicalFreeTrialTapped:"PeriodicalFreeTrialTapped",
AudiblePlaySampleTapped:"AudiblePlaySampleTapped",AudibleStopSampleTapped:"AudibleStopSampleTapped"};waitForRender=function(e){setTimeout(e,4)};
Utility=function(){return{createScaledImageUrl:function(e,a){if(!e||!a||e.match("no-img"))return e;var f=e.lastIndexOf("/");if(f<0)return e;var c=e.substring(0,f);f=e.substring(f+1,e.length);if(f.length<1)return e;f=f.split(".");var b=false,d;for(d=1;d<f.length-1;d++)if(f[d].indexOf("_")===0){f.splice(d,1,a);b=true;break}b||f.splice(f.length-1,0,a);f=f.join(".");return finalURL=c+"/"+f},getCookie:function(e){var a,f=document.cookie.split(";");for(a=0;a<f.length;a++){var c=f[a].split("=");if(c[1]&&
$.trim(c[0])===e)return unescape(c[1])}return null},htmlEncode:function(e){return e.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//,"&#x2F;")},refreshDOMElement:function(e){e.width(e.width()+1);setTimeout(function(){e.width(e.width()-1)},0)},simulateClickOnUrl:function(e){var a=document.createElement("a");a.href=e;a.target="_blank";e=document.createEvent("MouseEvents");e.initEvent("click",true,true);a.dispatchEvent(e)},isElementInsideViewport:function(e){var a=
$(window).scrollTop()+$(window).height();return $(e).offset().top<=a},isLocalStorageEnabled:function(){try{localStorage.setItem("testLocalStorage","1");localStorage.removeItem("testLocalStorage")}catch(e){return false}return true},preventLongPressMenu:function(e){function a(f){f=f||window.event;f.preventDefault();f.stopPropagation();f.cancelBubble=true;return f.returnValue=false}e.ontouchstart=a;e.ontouchmove=a;e.ontouchend=a;e.ontouchcancel=a},escapeRegExp:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,
"\\$&")},getDisplayableFileSize:function(e,a){for(var f=Math.pow(2,10);e>f;){e/=f;if(a==="KB")a="MB";else if(a==="MB")a="GB";else if(a==="GB")a="TB";else{e*=f;break}}e=Math.round(e*10)/10;return e+" "+a}}}();
DateFormatter=function(){var e={0:gls("kcptos_january"),1:gls("kcptos_february"),2:gls("kcptos_march"),3:gls("kcptos_april"),4:gls("kcptos_may"),5:gls("kcptos_june"),6:gls("kcptos_july"),7:gls("kcptos_august"),8:gls("kcptos_september"),9:gls("kcptos_october"),10:gls("kcptos_november"),11:gls("kcptos_december")};return{toMDY:function(a){var f=new Date;f.setTime(a);if(isNaN(f))return"INVALID DATE";return e[f.getMonth()]+" "+f.getDate()+", "+f.getFullYear()}}}();
JellybeanScrollingHack=function(){return{enableOnSelector:function(e){e.unbind("mousedown.jellybeanscrollinghack").bind("mousedown.jellybeanscrollinghack",function(){})}}}();
ApplicationContext=function(){var e=gls("GameCircleOverlay");return function(){console.log("ApplicationContext: contructor called");var a=this,f="",c="",b="",d="en",h="US",g="",j={en:"en",fr:"fr",de:"de",zh:"zh-cn",ja:"ja",es:"es",it:"it",pt:"pt"},l=true,k="",m="",n="",s="",q={},u=function(p){return a.getObject(p)};this.setFactory=function(p){a=p};this.executeInitializers=function(){};this.initialize=function(p){hostinterface.logMessage("ApplicationContext.initialize called");console.log("ApplicationContext: initialize()");
this.executeInitializers();this.addBodyBackgroundClass();if(p){g=p.appName;if(g===undefined||g===null)g="";f=p.gameCircleVersion;c=p.clientVersion;b=p.contentVersion;d=p.languageCode;if(d===undefined||d===null||!j.hasOwnProperty(d)){d="en";l=false}h=p.countryCode;h="US";moment.lang(j[d]);k=p.deviceId;m=p.deviceManufacturer;n=p.deviceModel;s=p.deviceType;q=p.experiments}a.initializeOverlay(p)};this.initializeOverlay=function(p){hostinterface.logMessage("ApplicationContext: initializeOverlay called");
u("OverlayController").init(p);this.removeParams();hostinterface.logMessage("ApplicationContext: end of initializeOverlay")};this.addBodyBackgroundClass=function(){$("body").addClass("body-background")};this.getCenterGapMargin=function(){return 0};this.removeParams=function(){};this.getPlatformName=function(){return e};this.doPageTransitionWith=function(p,r){r.call(p)};this.areTouchEventsSupported=function(){return typeof window.ontouchstart!=="undefined"};this.getTouchStartEvent=function(){return this.areTouchEventsSupported()?
"touchstart":"mousedown"};this.getTouchMoveEvent=function(){return this.areTouchEventsSupported()?"touchmove":"mousemove"};this.getTouchEndEvent=function(){return this.areTouchEventsSupported()?"touchend":"mouseup"};this.getSpinners=function(){return{smallSpinner:"img/gamecircle/spinner.gif"}};this.isInsideIFrame=function(){return false};this.getEstimatedKeyboardHeight=function(){return 150};this.needsScrollBoundaryRefresh=function(){return true};this.needsScreenResize=function(p){if(typeof p==="boolean")this.screenResize=
p;return this.screenResize};this.doScreenResize=function(){u("ScreenSize").detectNewScreenSize()};this.hidePagesOutOfViewport=function(){return false};this.preventLongPressMenu=function(){};this.newApplicationName=function(){return g};this.newDeviceLanguageWasSupported=function(){return l};this.newGameCircleVersionString=function(){return f};this.newClientVersionString=function(){return c};this.newContentVersionString=function(){return b};this.newDeviceId=function(){return k};this.newDeviceManufacturer=
function(){return m};this.newDeviceModel=function(){return n};this.newDeviceType=function(){return s};this.newExperimentWrapper=function(){return new ExperimentWrapper(q)};this.newFTUECORSelectionPageController=function(){var p=u("FTUECORSelectionPageView");return new FTUECORSelectionPageController(u("OverlayController"),p)};this.newFTUECORSelectionPageView=function(){return new FTUECORSelectionPageView($("#ftuecorselectionpage"))};this.newFTUECORSelectionWidgetDAO=function(){return new FTUECORSelectionWidgetDAO};
this.newFTUECORUnsupportedPageController=function(){var p=u("FTUECORUnsupportedPageView");return new FTUECORUnsupportedPageController(u("OverlayController"),p)};this.newFTUECORUnsupportedPageView=function(){return new FTUECORUnsupportedPageView($("#ftuecorunsupported"))};this.newFTUECORUnsupportedWidgetDAO=function(){return new FTUECORUnsupportedWidgetDAO};this.newFTUEAgeVerificationPageController=function(){var p=u("FTUEAgeVerificationPageView");return new FTUEAgeVerificationPageController(u("OverlayController"),
p)};this.newFTUEAgeVerificationPageView=function(){return new FTUEAgeVerificationPageView($("#ftueageverificationpage"))};this.newFTUEAgeVerificationWidgetDAO=function(){return new FTUEAgeVerificationWidgetDAO};this.newFTUEAgeViolationPageController=function(){var p=u("FTUEAgeViolationPageView");return new FTUEAgeViolationPageController(u("OverlayController"),p)};this.newFTUEAgeViolationPageView=function(){return new FTUEAgeViolationPageView($("#ftueageviolationpage"))};this.newFTUEAgeViolationWidgetDAO=
function(){return new FTUEAgeViolationWidgetDAO};this.newAchievementSignInPromptPageController=function(){var p=u("AchievementSignInPromptPageView");return new AchievementSignInPromptPageController(u("OverlayController"),p)};this.newAchievementSignInPromptPageView=function(){return new AchievementSignInPromptPageView($("#achievementsigninpromptpage"))};this.newAchievementSignInPromptWidgetDAO=function(){return new AchievementSignInPromptWidgetDAO};this.newLeaderboardSignInPromptPageController=function(){var p=
u("LeaderboardSignInPromptPageView");return new LeaderboardSignInPromptPageController(u("OverlayController"),p)};this.newLeaderboardSignInPromptPageView=function(){return new LeaderboardSignInPromptPageView($("#leaderboardsigninpromptpage"))};this.newLeaderboardSignInPromptWidgetDAO=function(){return new LeaderboardSignInPromptWidgetDAO};this.newFTUELoginPageController=function(){var p=u("FTUELoginPageView");return new FTUELoginPageController(u("OverlayController"),p)};this.newFTUELoginPageView=function(){return new FTUELoginPageView($("#ftueloginpage"))};
this.newFTUELoginWidgetDAO=function(){return new FTUELoginWidgetDAO};this.newFTUETOSPageController=function(){var p=u("FTUETOSPageView");return new FTUETOSPageController(u("OverlayController"),p)};this.newFTUETOSPageView=function(){return new FTUETOSPageView($("#ftuetospage"))};this.newFTUETOSWidgetDAO=function(){return new FTUETOSWidgetDAO};this.newProfilePageController=function(){var p=u("ProfilePageView");return new ProfilePageController(u("OverlayController"),p)};this.newProfilePageView=function(){return new ProfilePageView($("#profilepage"))};
this.newProfileWidgetDAO=function(){return new ProfileWidgetDAO};this.newEditProfilePageController=function(){var p=u("EditProfilePageView");return new EditProfilePageController(u("OverlayController"),p)};this.newEditProfilePageView=function(){return new EditProfilePageView($("#editprofilepage"))};this.newEditProfileWidgetDAO=function(){return new EditProfileWidgetDAO};this.newSettingsPageController=function(){var p=u("SettingsPageView");return new SettingsPageController(u("OverlayController"),p)};
this.newSettingsPageView=function(){return new SettingsPageView($("#settingspage"))};this.newSettingsWidgetDAO=function(){return new SettingsWidgetDAO};this.newLearnMorePageController=function(){var p=u("LearnMorePageView");return new LearnMorePageController(u("OverlayController"),p)};this.newLearnMorePageView=function(){return new LearnMorePageView($("#learnmorepage"))};this.newLearnMoreWidgetDAO=function(){return new LearnMoreWidgetDAO};this.newSummaryPageController=function(){var p=u("SummaryPageView");
return new SummaryPageController(u("OverlayController"),p)};this.newSummaryPageView=function(){return new SummaryPageView($("#summarypage"))};this.newSummaryWidgetDAO=function(){return new SummaryWidgetDAO};this.newAchievementsPageController=function(){var p=u("AchievementsPageView");return new AchievementsPageController(u("OverlayController"),p)};this.newAchievementsPageView=function(){return new AchievementsPageView($("#achievementpage"))};this.newAchievementsWidgetDAO=function(){return new AchievementsWidgetDAO};
this.newLeaderboardsPageController=function(){var p=u("LeaderboardsPageView");return new LeaderboardsPageController(u("OverlayController"),p)};this.newLeaderboardsPageView=function(){return new LeaderboardsPageView($("#leaderboardpage"))};this.newLeaderboardsWidgetDAO=function(){return new LeaderboardsWidgetDAO};this.newLeaderboardRanksPageController=function(){var p=u("LeaderboardRanksPageView");return new LeaderboardRanksPageController(u("OverlayController"),p)};this.newLeaderboardRanksPageView=
function(){return new LeaderboardRanksPageView($("#leaderboardrankspage"))};this.newLeaderboardRanksWidgetDAO=function(){return new LeaderboardRanksWidgetDAO};this.newNavigationWidgetDAO=function(){return new NavigationWidgetDAO};this.newMenuWidgetDAO=function(){return new MenuWidgetDAO};this.newRanksNavigationWidgetDAO=function(){return new RanksNavigationWidgetDAO};this.newEditProfileNavigationWidgetDAO=function(){return new EditProfileNavigationWidgetDAO};this.newEmailUtility=function(){return new EmailUtility};
this.newStringLocalizationWrapper=function(){return new StringLocalizationWrapper(d,h)};this.newLanguageCode=function(){return d};this.newCountryCode=function(){return h};this.newElementLocalizationWrapper=function(){return new ElementLocalizationWrapper(d,h)};this.newDOMUtility=function(){return new DOMUtility};this.newScreenSize=function(){return new ScreenSize};this.newNoOpController=function(){return new NoOpController};this.newOverlayController=function(){var p=new OverlayView($("#gcholder"));
return new OverlayController(p)};this.newPageController=function(){return new PageController};this.newReadyHandler=function(){return DefaultReadyHandler};this.newScreenSizeValidator=function(){return new SimpleScreenSizeValidator};document.ontouchmove=function(p){p.preventDefault()}}}();
ApplicationContextFactory=function(){var e={};return function(){this.create=function(){var a=[],f=new ApplicationContext;a.push("ApplicationContext");var c;a.push("SmallFormFactorApplicationContext");c=new SmallFormFactorApplicationContext;var b;a.push("StandaloneApplicationContext");b=new StandaloneApplicationContext;var d=$.extend(true,f,c,e,b);d.ancestry=a;d.objects={};d.setFactory(d);f.setFactory(d);c!==e&&c.setFactory(d);b!==e&&b.setFactory(d);d.getObject=function(h){var g=d.objects[h];if(!g){g=
d["new"+h];if(!g)return null;g=g.apply(d);d.objects[h]=g}return g};return d}}}();SmallFormFactorApplicationContext=function(){return function(){this.setFactory=function(){}}}();StandaloneApplicationContext=function(){return function(){this.setFactory=function(){};this.getPlatformName=function(){return gls("kcptos_kindle_ipad")};this.removeParams=function(){}}}();var applicationContextFactory=new ApplicationContextFactory;window.applicationContext=applicationContextFactory.create();initData=null;
Template=function(){var e={};return{initialize:function(a){var f=e[a];if(f)if(!f.initialized){$.template(a,f.template);f.initialized=true}},tmpl:function(a,f,c){this.initialize(a);return $.tmpl(a,f,c)},template:function(a,f){e[a]={template:f,initialized:false}}}}();
Lifecycle=function(e){function a(){$.each(m,function(r,t){var o=$("#"+s+r);arguments={parent:k,pageData:n,renderTarget:o,slotName:r,slotData:t};o=LifecycleControllerFactory.createController(arguments);l[r]={controller:o}})}function f(r,t,o){var v=u[t];if(t!==LifecyclePhases.NO_PHASE&&v)v.push([r,o||{}])}function c(){$.each(l,function(r,t){var o=t.controller.determinePhase();f(t.controller,o)})}function b(r){var t=$.Deferred(),o=$.Deferred(),v=[],w=[],z=u[r],B=Date.now();$.each(z,function(y,x){var A=
x[0],D=x[1],E=Date.now(),F=A.getFullyLoadedPromise(r);F.done(function(){g("widgetFullyLoaded",r,A,Date.now()-E)});w.push(F);D=A.loadPhase(D,r);D.done(function(C,G){f(A,C,G)});v.push(D)});$.when.apply(null,v).done(function(){t.resolve()});$.when.apply(null,w).done(function(){g("widgetsFullyLoaded",r,z,Date.now()-B);o.resolve()});return{phaseLoaded:t.promise(),phaseFullyLoaded:o.promise()}}function d(){var r=q[p++],t=b(r);g("phaseStarted",r);return t}function h(){function r(){p<q.length&&setTimeout(function(){var o=
d(),v=o.phaseLoaded;o=o.phaseFullyLoaded;var w=Date.now(),z=p-1;v.done(function(){g("phaseLoaded",z,Date.now()-w)});o.done(function(){g("phaseFullyLoaded",z,Date.now()-w);var B;B=z===q[q.length-1]?true:false;B&&g("lifecycleFinished",Date.now()-t);r()})},0)}var t=Date.now();r()}function g(r){var t=Array.prototype.slice.call(arguments,1);j[r]&&j[r].forEach(function(o){o.apply(null,t)})}var j={},l={},k=e.pageController,m=e.pageSlotData,n=e.pageData,s=e.pageSlotPrefix||"",q=[LifecyclePhases.CACHE_PHASE,
LifecyclePhases.AUTH_PHASE,LifecyclePhases.IMAGE_PHASE],u={};$.each(q,function(r,t){u[t]=[]});var p=0;return{start:function(){setTimeout(function(){a();c();h()},0)},on:function(r,t){j[r]=j[r]||[];j[r].push(t)}}};LifecycleWidgetAPI={determinePhase:function(){return LifecyclePhases.NO_PHASE},loadPhase:function(){var e=$.Deferred();e.resolve(LifecyclePhases.NO_PHASE);return e.promise()}};Template.template("AchievementSignInPrompt",'<div class="achievementsigninprompt-holder scroll-content"><div id="pageContent"><div class="signup-alert gcalert"><img class="agc-signup-alert-logo" src="img/gamecircle/prompts-amz-gc-logo-AB-Test-hdpi.png"><div id="agc-signup-alert"><div class="agc-signup-alert-icon"><img class="agc-ach-icon" src="img/gamecircle/prompts-sync-achievements-hdpi.png"/></div><div id="scrollable-content"><div class="agc-signup-alert-body"><h3 id="agc-signup-alert-title"></h3><p id="agc-signup-alert-description"></p></div></div></div><div class="button-group"><button id="nothanksbutton" class="btn btn-small btn-secondary"></button><button id="signinbutton" class="btn btn-small btn-primary"></button></div></div></div></div>');
Template.template("AchievementSignInPromptPage",'<div id="agc-main-content" class="transparent" style="overflow: hidden;"><div id="achievementsigninpromptwidgettag" class="scroll-wrapper"></div></div>');Template.template("Achievements",'<div class="achievements-holder scroll-content"><div id="pageContent">  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div class="page-hero">  <div class="pull-left img-margin-right"><img src="img/gamecircle/img-page-hero-achievements.png"></div><h2 id="header_achievements_headline_achievements_earned" class="page-title orange"></h2><div class="row"> {{if $data.header}} {{if $data.header.shownext}} <div class="pull-left img-margin-right iconOverlayContainer"><img src="${$data.header.next.image}" class="achievementBigIcon"><img src="${$data.header.next.ring}" class="iconOverlay achievementBigIconOverlay"></div><p class="meta"><em id="header_achievements_next_achievement">Next Achievement</em></p><h3 class="meta daily-title white">${$data.header.next.title}</h3><p class="meta light-gray">${$data.header.next.desc}</p><p id="header_achievements_percent_complete" class="meta dark-orange"></p> {{/if}} {{/if}} </div></div><div style="clear:both;"></div>  <div class="page-content">  <div class="btn-group btn-group-pagefilter"><div id="allButton" class="btn btn-small btn-pagefilter active">All</div><div id="unearnedButton" class="btn btn-small btn-pagefilter">Unearned</div><div id="earnedButton" class="btn btn-small btn-pagefilter">Earned</div></div>  <table class="table table-bordered table-white" id="achTable"><tr></tr></table>  <table class="table table-bordered table-white" id="hiddenAchievementCountTable"></table></div></div></div>');
Template.template("AchievementsPage",'<div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="achievementwidgettag"></div></div>');Template.template("EditProfile",'<div class="editprofile-holder scroll-content">  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div class="page-content"><fieldset class="editprofile"><label id="editNicknameLabel" class="editprofile"></label>  <div style="width:1px;height:1px;-webkit-transform:translate3d(0,0,0);float:right;"></div><input id="editAlias" type="text" class="editprofile" /></fieldset><div id="editAliasErrors" class="validation-message"></div><label id="selectPictureLabel"></label><div id="avatars"><ul> {{each avatars}} {{if avatarId}}<li><img id="${imageId}" src="${localAvatarUrl}" data-avatarId="${avatarId}" class="${className}" style="display: none" /><img id="${imageId}-blank" src="img/gamecircle/blank_profile.png" class="${className}"/></li> {{/if}} {{/each}} </ul></div></div></div>');
Template.template("EditProfileNavigation",'<div class=\'navbar-holder\'><div class="navbar"><div class="navbar-inner"><button id=\'backbutton\' class="btn btn-nav pull-left"><img src="img/gamecircle/icon-21-back.png"></button><button id=\'savebutton\' class="btn btn-nav btn-title-bar btn-primary pull-right">Save</button><h3 id="title" class="title-bar"></h3></div><div class="brand-bar"></div></div></div>');Template.template("EditProfilePage",'<div id="agc-main-header"><div id="editprofilenavigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="editprofilewidgettag"></div></div>');
Template.template("FTUEAgeVerification",'<div id="navigationwidgettag"><div class="navbar-holder"><div class="navbar"><div class="navbar-inner"><button id="cancelbutton" class="btn btn-nav pull-left agc-string" data-string="age_verification_cancel">Cancel</button><button id="continuebutton" class="btn btn-nav btn-title-bar btn-primary pull-right agc-string" data-string="age_verification_continue">Continue</button><h3 id="title" class="title-bar agc-string" data-string="global_headline_amazon_gamecircle"></h3></div><div class="brand-bar"></div></div></div><div id="ftueageverification-scroll-wrapper" class="ftueageverification-holder">  <div class="page-content"><label for="yearList" id="pickYear" class="agc-string" data-string="age_verification_prompt"></label><select id="yearList" class="input-xlarge"><option selected="selected" value="prompt" class="agc-string" data-string="age_verification_dropdown"></option> {{each years}} <option value="${$value}">${$value}</option> {{/each}} </select></div></div></div>');
Template.template("FTUEAgeVerificationPage",'<div id="ftueageverificationscroll"><div id="ftueageverificationwidgettag"></div></div>');Template.template("FTUEAgeViolation",'<div class="ftueageviolation-holder scroll-content" style="-webkit-transition-property: -webkit-transform; -webkit-transform-origin-x: 0px; -webkit-transform-origin-y: 0px; -webkit-transform: translate(0px, 0px) translateZ(0px); -webkit-transition-duration: 0ms;"><div class="ftue gcalert"><p id="ageViolation"></p><button id="dismissButton" class="btn btn-small btn-block btn-secondary btn-ftue"></button></div></div>');
Template.template("FTUEAgeViolationPage",'<div id="agc-main-content" class="transparent" style="overflow: hidden;"><div id="ftueageviolationwidgettag" class="scroll-wrapper"></div></div>');Template.template("FTUECORSelection",'<div id="navigationwidgettag"><div class="navbar-holder"><div class="navbar"><div class="navbar-inner"><button id="cancelbutton" class="btn btn-nav pull-left agc-string" data-string="country_picker_button_cancel">Cancel</button><button id="savebutton" class="btn btn-nav btn-title-bar btn-primary pull-right agc-string" data-string="country_picker_button_continue">Continue</button><h3 id="title" class="title-bar agc-string" data-string="global_headline_amazon_gamecircle"></h3></div><div class="brand-bar"></div></div></div><div id="ftuecorselection-scroll-wrapper" class="ftuecorselection-holder">  <div class="page-content"><label for="countryList" id="pickCountry" class="agc-string" data-string="country_picker_headline_pick"></label><select id=\'countrylist\' class="input-xlarge"><option selected="selected" value="prompt" class="agc-string" data-string="country_picker_dropdown"></option> {{each countries}} <option value="${code}">${name}</option> {{/each}} </select></div></div></div>');
Template.template("FTUECORSelectionPage",'<div id="ftuecorselectionscroll"><div id="ftuecorselectionwidgettag"></div></div>');Template.template("FTUECORUnsupported",'<div class="ftuecorunsupported-holder scroll-content" style="-webkit-transition-property: -webkit-transform; -webkit-transform-origin-x: 0px; -webkit-transform-origin-y: 0px; -webkit-transform: translate(0px, 0px) translateZ(0px); -webkit-transition-duration: 0ms;"><div class="ftue gcalert"><h4 id="agsTitle">Amazon GameCircle</h4><div id="scrollable-content"><p><span id=\'corUnsupported\'></span></p><p><a href="#"><span id=\'learnMoreLink\'></span></a></p></div><button id="dismissButton" class="btn btn-small btn-block"></button></div></div>');
Template.template("FTUECORUnsupportedPage",'<div id="agc-main-content" class="transparent" style="overflow: hidden;"><div id="ftuecorunsupportedwidgettag" class="scroll-wrapper"></div></div>');Template.template("FTUELogin",'<div class="ftuelogin-holder scroll-content page-content"><div class="ftue"><img class="agc-logo" src="img/gamecircle/agc-logo-150x47.png"><p id="signinDetails"></p><ul class="list-services-container"><li class="list-services"><div><img src="img/gamecircle/icons-32-leaderboard.png"></div><div><h6 id="leaderboardsSection" class="list-services meta"></h6><p id="leaderboardsDescription" class="list-services"></p></div></li><li class="list-services"><div><img src="img/gamecircle/icons-32-achievements.png"></div><div><h6 id="achievementsSection" class="list-services meta"></h6><p id="achievementsDescription" class="list-services"></p></div></li><li class="list-services"><div><img src="img/gamecircle/icons-32-sync.png"></div><div><h6 id="wsSection" class="list-services meta"></h6><p id="wsDescription" class="list-services"></p></div></li></ul><div class="button-group"><button id="newaccountbutton" class="btn btn-small btn-secondary"></button><button id="signinbutton" class="btn btn-small btn-primary"></button></div><p><a id="nothanksbutton" class="a-nothanks"></a></p><p id="tosDescription"><a id="termsofuselink"></a></p></div></div>');
Template.template("FTUELoginPage",'<div id=ftueloginscroll><div id="ftueloginwidgettag" class="scroll-wrapper"></div></div>');Template.template("FTUETOS",'<div class="ftuetos-holder scroll-content page-content"><div class="ftue"><img src="img/gamecircle/agc-logo-150x47.png"><p><span id=\'connectDetails\'></span></p><ul class="list-services-container"><li class="list-services"><div><img class="pull-left" src="img/gamecircle/icons-21-leaderboard.png"></div><div><h6 id=\'leaderboardsSection\' class="list-services meta"></h6><p id=\'leaderboardsDescription\' class="list-services"></p></div></li><li class="list-services"><div><img class="pull-left" src="img/gamecircle/icons-21-achievements.png"></div><div><h6 id=\'achievementsSection\' class="list-services meta"></h6><p id=\'achievementsDescription\' class="list-services"></p></div></li><li class="list-services"><div><img class="pull-left" src="img/gamecircle/icons-21-sync.png"></div><div><h6 id=\'wsSection\' class="list-services meta"></h6><p id=\'wsDescription\' class="list-services"></p></div></li></ul><button id="connectbutton" class="btn btn-small btn-primary btn-block btn-ftue"></button><p><a id=\'nothanksbutton\' class="a-nothanks"></a></p><p><small id=\'tosDescription\'><a id=\'termsofuselink\'></a></small></p></div></div>');
Template.template("FTUETOSPage",'<div id="ftuetosscroll"><div id="ftuetoswidgettag" class="scroll-wrapper"></div></div>');Template.template("GroupedButton",'<button id="buttonid" class="btn span2"><div class=\'buttontext\'>Button</div></button>');Template.template("LeaderboardSignInPrompt",'<div class="leaderboardsigninprompt-holder scroll-content"><div id="pageContent"><div class="signup-alert gcalert"><img class="agc-signup-alert-logo" src="img/gamecircle/prompts-amz-gc-logo-AB-Test-hdpi.png"><div id="agc-signup-alert"><div class="agc-signup-alert-icon"><img class="agc-lb-icon" src="img/gamecircle/prompts-post-scores-hdpi.png"/></div><div id="scrollable-content"><div class="agc-signup-alert-body"><h3 id="agc-signup-alert-title"></h3><p id="agc-signup-alert-description"></p></div></div></div><div class="button-group"><button id="nothanksbutton" class="btn btn-small btn-secondary"></button><button id="signinbutton" class="btn btn-small btn-primary"></button></div></div></div></div>');
Template.template("LeaderboardSignInPromptPage",'<div id="agc-main-content" class="transparent" style="overflow: hidden;"><div id="leaderboardsigninpromptwidgettag" class="scroll-wrapper"></div></div>');Template.template("Leaderboards",'<div class="leaderboards-holder scroll-content"><div id="pageContent">  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div class="page-hero">  <div class="pull-left img-margin-right"><img src="img/gamecircle/img-page-hero-leaderboards.png"></div><h2 id=\'leaderboardCount\' class="page-title orange"></h2><div class="row"><div class="pull-left img-margin-right iconOverlayContainer"><img id=\'bestLeaderboardIcon\' src="img/gamecircle/img-120x120.png" class="bestleaderboardIcon" style="display: none"><img id=\'bestLeaderboardIcon-blank\' src="img/gamecircle/blank_leaderboard.png" class="bestleaderboardIcon"><img src="img/gamecircle/leaderboard_ring_tab_gray.png" class="bestleaderboardIconOverlay iconOverlay"></div><p class="meta"><em id="headerLeaderboardDesc">Best Rank</em></p><h3 id=\'bestLeaderboardName\' class="meta daily-title white agc-text-overflow"></h3><p id=\'bestLeaderboardScore\' class="meta meta-gray"></p><p id=\'bestLeaderboardRank\' class="meta dark-orange"></p></div></div><div style="clear:both;"></div>  <div class="page-content">  <table class="table" id=\'leaderboardTable\'></table></div></div></div>');
Template.template("LeaderboardsPage",'<div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="leaderboardswidgettag"></div></div>');Template.template("LeaderboardRanks",'<div class="leaderboardranks-holder scroll-content">  <div class="page-content">  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div class="leaderboard-detail"><div id="datasetToggle" class="btn btn-small pull-right btn-page-hero" data-set="percentiles">Top 100</div><div class="pull-left img-margin-right iconOverlayContainer"><img id="leaderboardIcon" class="pull-left leaderboardIcon" style="display: none"><img id="leaderboardIcon-blank" src="img/gamecircle/blank_leaderboard.png" class="pull-left leaderboardIcon"><img src="img/gamecircle/leaderboard_ring_tab_gray.png" class="leaderboardIconOverlay iconOverlay"></div><h4 id="leaderboardName" class="meta-title agc-text-overflow"></h4><p id="leaderboardDesc" class="meta"></p><p id="playerRank" class="meta dark-orange"></p></div><div style="clear:both;"></div>  <div id="dataFilter" class="btn-group btn-group-pagefilter"><div id="todayButton" class="btn btn-small btn-pagefilter" data-filter="GLOBAL_DAY">Today</div><div id="weekButton" class="btn btn-small btn-pagefilter" data-filter="GLOBAL_WEEK">This Week</div><div id="allButton" class="btn btn-small btn-pagefilter active" data-filter="GLOBAL_ALL_TIME">All</div></div><div id="allPlayers"><table class="table table-bordered table-white leaderboardRanks"></table></div></div></div>');
Template.template("LeaderboardRanksPage",'<div id="agc-main-header"><div id="ranknavigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="leaderboardrankswidgettag"></div><div id="currentPlayerOverlay"><table class="table table-bordered table-white leaderboardRanks"></table></div></div>');Template.template("LearnMore",'<div class=\'learnmore-holder\'>  <div class="page-content">  <table class="table">  <tr><td style="border:none;"><a name="what_data"></a><h4 id="faq_headline_what_data" class="meta-title"></h4><p id="answer_what_data"></p></td></tr><tr><td style="border:none;"><a name="what_services_without_sign_in"></a><h4 id="faq_headline_what_services_without_sign_in" class="meta-title"></h4><p id="answer_what_services_without_sign_in"></p></td></tr><tr><td style="border:none;"><a name="does_game_support"></a><h4 id="faq_headline_does_game_support" class="meta-title"></h4><p id="answer_does_game_support"></p></td></tr><tr><td style="border:none;"><a name="no_share_info"></a><h4 id="faq_headline_no_share_info" class="meta-title"></h4><p id="answer_no_share_info"></p></td></tr><tr><td style="border:none;"><a name="turn_off_gamecircle"></a><h4 id="faq_headline_turn_off_gamecircle" class="meta-title"></h4><p id="answer_turn_off_gamecircle"></p></td></tr><tr><td style="border:none;"><a name="access_settings"></a><h4 id="faq_headline_access_settings" class="meta-title"></h4><p id="answer_access_settings"></p></td></tr><tr><td style="border:none;"><a name="work_on_my_devices"></a><h4 id="faq_headline_work_on_my_devices" class="meta-title"></h4><p id="answer_work_on_my_devices"></p></td></tr><tr><td style="border:none;"><a name="new_country"></a><h4 id="faq_headline_new_country" class="meta-title"></h4><p id="answer_new_country"></p></td></tr><tr><td style="border:none;"><a href="#"><span id="legalInformation"></span></a></td></tr></table></div></div>');
Template.template("LearnMorePage",'<div id="learnmorepage"><div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="learnmorewidgettag"></div></div></div>');Template.template("Menu",'<div id="agc-menu" style="width:100%;"><div id="agc-menu-content" class="wrapper"><div class="menu-holder scroll-content"><section class="menu-section"><h1 id="agc-game-title" class="agc-string" data-string="menu_headline_current_game"></h1><ul><li id="menuSummaryLink" class="agc-string agc-link" data-string="menu_link_game_summary" data-link="OverlayController:showSummary"><div id="totalTimePlayed" class="metadata"></div></li> {{if $data.achievementsExist}} <li id="menuAchievementsLink" class="agc-string agc-link" data-string="menu_link_achievements" data-link="OverlayController:showAchievements"><div id="achievementCount" class="metadata"></div></li> {{/if}} {{if $data.leaderboardsExist}} <li id="menuLeaderboardsLink" class="agc-string agc-link" data-string="menu_link_leaderboards" data-link="OverlayController:showLeaderboards"><div id="leaderboardRank" class="metadata"></div></li> {{/if}} </ul></section><section class="menu-section"><h1 id="agc-profile-title" class="agc-link" data-link="OverlayController:showProfile"><div class="profile-block"><div class="profile-link agc-string" data-string="menu_link_profile"></div><div class="profile-alias"></div></div><img id="menuProfileImage" class="profile-image" data-string="menu_link_profile" src="${localAvatarUrl}" style="display: none"/><img id="menuProfileImage-blank" class="profile-image" src="img-page-hero-guest.png"/><div style="clear:both;"></div></h1><ul><li id="menuSettingsLink" class="agc-string agc-link" data-string="menu_link_settings" data-link="OverlayController:showSettings"></li><li id="menuLearnMoreLink" class="agc-string agc-link" data-string="menu_link_learn_more" data-link="OverlayController:showLearnMore"></li><li id="menuHelpLink" class="agc-string agc-link" data-string="menu_link_help" data-link="EmailUtility:openHelpEmail"></li><li id="menuFeedbackLink" class="agc-string agc-link" data-string="menu_link_give_feedback" data-link="EmailUtility:openFeedbackEmail"></li></ul></section><img id="agc-menu-logo" src="img/gamecircle/agc-logo-400x125.png" /></div></div></div>');
Template.template("Navigation",'<div class=\'navbar-holder\'><div class="navbar"><div class="navbar-inner"><button id="agc-menu-button" class="btn btn-nav-beachball pull-left"><img src="img/gamecircle/icon-64-beachburger.png"></button><button id="agc-close-button" class="btn btn-nav pull-right"><img src="img/gamecircle/icon-21-x.png"></button><h3 id="title" class="title-bar"></h3></div><div class="brand-bar"></div></div></div>');Template.template("Profile",'<div class="profile-holder scroll-content">  <div>  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script><div class="page-hero"><div class="pull-left img-margin-right"><img id="pageHeroImage" class="pageHeroAvatarIcon" src="${localAvatarUrl}" style="display: none"/><img id="pageHeroImage-blank" class="pageHeroAvatarIcon" src="img/gamecircle/blank_profile.png"/></div><div class="page-hero-text"><div class="pull-left"><h2 id="youAreField" class="meta page-title light-gray">You are</h2><h1 id="profileAlias" class="page-title orange"></h1><p id="extraInfo"></p></div><div class="page-hero-buttons"><button id="loginButton" class="btn btn-small btn-page-hero btn-primary" style="display:none">Sign In</button><button id="editbutton" class="btn btn-small btn-page-hero">Edit</button></div></div></div><div style="clear:both;"></div>  <div class="page-content"><h4 id="aboutHiddenProfilesHeader" style="display:none">About Hidden Profiles</h4><p><span id="aboutHiddenProfiles" style="display:none"></span></p><button id="editSettingsButton" style="display:none" class="btn btn-small"></button></div></div></div>');
Template.template("ProfilePage",'<div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="profilewidgettag"></div></div>');Template.template("RanksNavigation",'<div class=\'navbar-holder\'><div class="navbar"><div class="navbar-inner"><button id=\'backbutton\' class="btn btn-nav pull-left"><img src="img/gamecircle/icon-21-back.png"></button><button id=\'closebutton\' class="btn btn-nav pull-right"><img src="img/gamecircle/icon-21-x.png"></button><h3 id="title" class="title-bar"></h3></div><div class="brand-bar"></div></div></div>');
Template.template("Skeleton",'<div id="agc-app"><div id="menuwidgettag"></div><div id="agc-main" style="left:0;width:100%;"><div id="activearea"><div id="ftueloginpage"></div><div id="ftuetospage"></div><div id="ftuecorselectionpage"></div><div id="ftuecorunsupported"></div><div id="ftueageverificationpage"></div><div id="ftueageviolationpage"></div><div id="summarypage"></div><div id="profilepage"></div><div id="editprofilepage"></div><div id="achievementpage"></div><div id="leaderboardpage"></div><div id="leaderboardrankspage"></div><div id="settingspage"></div><div id="learnmorepage"></div><div id="achievementsigninpromptpage"></div><div id="leaderboardsigninpromptpage"></div></div></div>  <div id="statusBar" class="page-status-bar"><img src="img/gamecircle/spinner.gif" /></div><div id="warningBar" class="page-warning-status-bar"></div><div id="errorBar" class="page-error-status-bar"></div></div>');
Template.template("Settings",'<div class="settings-holder scroll-content">  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div><div class="page-content page-content-settings"><div id="profileHiddenContainer"><ul class="nav nav-list"><li id="settingsHeader" class="settings-header">GameCircle Settings</li></ul>  <table class="table"><tbody>  <tr><td style="border:none;"><h4 id="profileHeader" class="meta-title">GameCircle Profile</h4><p id="profileInfo">If you hide your Amazon GameCircle public profile you will not be able to compare your progress with others across all your GameCircle games. You will still be able to track your achievements and see your high scores.</p></td><td class="span2" style="border:none;"><div class="btn-group pull-right"><div id="showProfileButton" class="btn btn-small">Show</div><div id="hideProfileButton" class="btn btn-small active">Hide</div></div></td></tr></tbody></table></div><ul class="nav nav-list"><li id="gameSettingsHeader" class="settings-header">Game Settings</li></ul><table class="table"><tbody><tr id="whispersyncEnabledContainer"><td><h4 id="wsHeader" class="meta-title">Whispersync for Games</h4><p id="wsInfo">This game saves your game progress to the Amazon Cloud with Whispersync for Games. You can turn off Whispersync for this game here.</p><td class="span2"><div class="btn-group pull-right"><div id="turnOnWSButton" class="btn btn-small">On</div><div id="turnOffWSButton" class="btn btn-small active">Off</div></div></td></td></tr><tr id="loginContainer"><td><h4 id="loginHeader" class="meta-title">Log in</h4><p id="loginInfo">You can login to GameCircle for this game here. This will turn on Whispersync as well as achievement and high score storage. Your data will still be stored on your device, and will be uploaded to Amazon.</p><td class="span2"><div class="btn-group pull-right"><div id="loginButton" class="btn btn-small">Log in</div></div></td></td></tr><tr id="logoutContainer"><td><h4 id="logoutHeader" class="meta-title">Log out</h4><p id="logoutInfo">You can log out of GameCircle for this game here. This will turn off Whispersync as well as achievement and high score storage. Your data will still be stored on your device, but it will not be uploaded to Amazon. If you want to log out of all games on your device please tap <a href="#" id="signOutAllGames">here</a></p><td class="span2"><div class="btn-group pull-right"><div id="logoutButton" class="btn btn-small">Log out</div></div></td></td></tr></tbody></table><br><h6 id="versionHeader" class="meta">Version</h6><p><small id="versionInfo"></small></p><p><small><a href="#"><span id="legalInformation"></span></a><br></small></p></div></div></div>');
Template.template("SettingsPage",'<div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="settingswidgettag"></div></div>');Template.template("Summary",'<div class="summary-holder scroll-content"><div>  <script type="text/javascript"> {{if $data.showStatus}} $("#statusBar").show(); {{else}} $("#statusBar").hide(); {{/if}} {{if $data.showWarning}} $("#warningBar").show().text(\'${$data.warningMessage}\'); {{else}} $("#warningBar").hide(); {{/if}} {{if $data.showError}} $("#errorBar").show().text(\'${$data.errorMessage}\'); {{else}} $("#errorBar").hide(); {{/if}} <\/script>  <div class="page-hero">  <div class="pull-left img-margin-right"><img id="pageHeroImage" class="pageHeroAvatarIcon" src="${localAvatarUrl}" style="display: none"/><img id="pageHeroImage-blank" class="pageHeroAvatarIcon" src="img/gamecircle/blank_profile.png"/></div><div class="page-hero-text"><div class="pull-left"><h2 id="youAreField" class="meta page-title light-gray">You are</h2><h1 id="profileAlias" class="page-title orange"></h1><p id="extraInfo"></p></div><div class="page-hero-buttons"><button id="loginButton" class="btn btn-small btn-page-hero btn-primary pull-right" style="display:none;">Sign In</button><button id="editbutton" class="btn btn-small btn-page-hero pull-right">Edit</button></div></div></div><div style="clear:both;"></div>  <div class="page-content"><table class="table"><tbody>   <tr id="timePlayedEntry"><td><img src="img/gamecircle/img-page-hero-time.png" class="pull-left img-margin-right" width="50" height="50"><h2 class="summary-title"><span id="totalTimePlayed"></span></h2><p id="time_played_desc" class="meta meta-summary">Time spent playing this game</p></td><td><div class="pull-right btn-link"></div></td></tr><tr id="achievementsEntry"><td><img src="img/gamecircle/img-page-hero-achievements.png" class="pull-left img-margin-right" width="50" height="50"><h2 id="achievementsEntryTotal" class="summary-title">#/#</h2><p id="achievements_earned_desc" class="meta meta-summary">Achievementments earned</p></td><td><div class="pull-right btn-link carrot-right"></div></td></tr><tr id="leaderboardsEntry"><td><img id="leaderboardEntryIcon" src="img/gamecircle/img-page-hero-leaderboards.png" class="pull-left img-margin-right" width="50" height="50"><h2 id="leaderboardEntryName" class="summary-title">38%</h2><p id="leaderboardEntryRank" class="meta meta-summary">Best leaderboard rank</p></td><td><div class="pull-right btn-link carrot-right"></div></td></tr></tbody></table></div></div></div>');
Template.template("SummaryPage",'<div id="agc-main-header"><div id="navigationwidgettag"></div></div><div id="agc-main-content" class="wrapper" style="overflow: hidden;"><div id="summarywidgettag"></div></div>');
LifecycleControllerFactory=function(){var e={};e.createController=function(a){var f=a.slotData,c=LifecycleWidgetAPI,b=f.view;a={parent:a.parent,renderTarget:a.renderTarget,slotData:f};if(b==="achievementwidgettag"){c=a.parent;b=a.slotData;a=new AchievementsWidgetView(a.renderTarget);c=new AchievementsWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="leaderboardswidgettag"){c=a.parent;b=a.slotData;a=new LeaderboardsWidgetView(a.renderTarget);c=new LeaderboardsWidgetController(c,a,
{requestParams:b.requestParams})}else if(b==="navigationwidgettag"){c=a.parent;b=a.slotData;a=new NavigationWidgetView(a.renderTarget);c=new NavigationWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ranknavigationwidgettag"){c=a.parent;b=a.slotData;a=new RanksNavigationWidgetView(a.renderTarget);c=new RanksNavigationWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="editprofilenavigationwidgettag"){c=a.parent;b=a.slotData;a=new EditProfileNavigationWidgetView(a.renderTarget);
c=new EditProfileNavigationWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="settingswidgettag"){c=a.parent;b=a.slotData;a=new SettingsWidgetView(a.renderTarget);c=new SettingsWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="learnmorewidgettag"){c=a.parent;b=a.slotData;a=new LearnMoreWidgetView(a.renderTarget);c=new LearnMoreWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="summarywidgettag"){c=a.parent;b=a.slotData;a=new SummaryWidgetView(a.renderTarget);
c=new SummaryWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="profilewidgettag"){c=a.parent;b=a.slotData;a=new ProfileWidgetView(a.renderTarget);c=new ProfileWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="editprofilewidgettag"){c=a.parent;b=a.slotData;a=new EditProfileWidgetView(a.renderTarget);c=new EditProfileWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftueloginwidgettag"){c=a.parent;b=a.slotData;a=new FTUELoginWidgetView(a.renderTarget);
c=new FTUELoginWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftuecorselectionwidgettag"){c=a.parent;b=a.slotData;a=new FTUECORSelectionWidgetView(a.renderTarget);c=new FTUECORSelectionWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftuecorunsupportedwidgettag"){c=a.parent;b=a.slotData;a=new FTUECORUnsupportedWidgetView(a.renderTarget);c=new FTUECORUnsupportedWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftueageverificationwidgettag"){c=
a.parent;b=a.slotData;a=new FTUEAgeVerificationWidgetView(a.renderTarget);c=new FTUEAgeVerificationWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftueageviolationwidgettag"){c=a.parent;b=a.slotData;a=new FTUEAgeViolationWidgetView(a.renderTarget);c=new FTUEAgeViolationWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="ftuetoswidgettag"){c=a.parent;b=a.slotData;a=new FTUETOSWidgetView(a.renderTarget);c=new FTUETOSWidgetController(c,a,{requestParams:b.requestParams})}else if(b===
"leaderboardrankswidgettag"){c=a.parent;b=a.slotData;a=new LeaderboardRanksWidgetView(a.renderTarget);c=new LeaderboardRanksWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="achievementsigninpromptwidgettag"){c=a.parent;b=a.slotData;a=new AchievementSignInPromptWidgetView(a.renderTarget);c=new AchievementSignInPromptWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="leaderboardsigninpromptwidgettag"){c=a.parent;b=a.slotData;a=new LeaderboardSignInPromptWidgetView(a.renderTarget);
c=new LeaderboardSignInPromptWidgetController(c,a,{requestParams:b.requestParams})}else if(b==="menuwidgettag"){c=a.parent;b=a.slotData;a=new MenuWidgetView(a.renderTarget);c=new MenuWidgetController(c,a,{requestParams:b.requestParams})}return $.extend(true,{},LifecycleWidgetAPI,c)};return e}();ViewAPI=function(){function e(){}e.prototype={render:function(){}};return e}();
ButtonView=function(e,a){this.renderTarget=e;this.template=null;this.defaultText=this.defaultClass="";this.templateName=a||"Button";this.render=function(f){this.template=Template.tmpl(this.templateName,f);this.defaultClass=this.template.find(".button").attr("class");this.defaultText=this.template.html();this.renderTarget.empty().append(this.template)};this.showDefaultState=function(){this.template.find(".buttontext").html(defaultText);this.template.find(".button").removeClass().addClass(this.defaultClass+
" "+state)};this.showState=function(f,c){var b="show"+f.charAt(0).toUpperCase()+f.slice(1);this[b]&&this[b].call(this,c)};this.renderState=function(f,c){if(c){c.text&&this.template.find(".buttontext").html(c.text);var b="button "+f;if(c.cssClass)b+=" "+c.cssClass;this.template.find(".button").removeClass().addClass(b)}};this.bindToTap=function(f){e.unbind("tap.buyboxbutton");f&&e.bind("tap.buyboxbutton",f)};this.show=function(){e.show()};this.hide=function(){e.hide()}};
ProgressButtonView=function(){function e(a,f){e.parentconstructor.call(this,a,f);var c=this.renderState;this.renderState=function(b,d){this.template.find(".progress").hide();c.call(this,b,d)};this.renderProgressState=function(b,d){this.renderState(b,d);this.processProgress(d)};this.processProgress=function(b){b=b.progress||0;b=Math.max(6,Math.floor(this.template.find(".button").width()*b));this.template.find(".progress").show().width(b)}}Inheritance.inherit(e,ButtonView);return e}();
ToggleButtonView=function(){function e(a,f,c){e.parentconstructor.call(this,a,f);this.showToggled=function(){hostinterface.logMessage("ToggleButtonView: showToggledState");this.renderState("toggled",{text:c,cssClass:"span2 active"});hostinterface.logMessage("ToggleButtonView: showToggledState end")};this.showUntoggled=function(){hostinterface.logMessage("ToggleButtonView: showUntoggledState");this.renderState("toggled",{text:c,cssClass:"span2"});hostinterface.logMessage("ToggleButtonView: showUntoggledState end")}}
Inheritance.inherit(e,ButtonView);return e}();AchievementSignInPromptPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("AchievementSignInPromptPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){}}}();
AchievementSignInPromptWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("AchievementSignInPrompt",{});var f=a.find("#agc-signup-alert-title"),c=a.find("#agc-signup-alert-description"),b=a.find("#nothanksbutton"),d=a.find("#signinbutton");f.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_achievement_headline"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_achievement_body"));
b.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_achievement_no_btn"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_achievement_yes_btn"));b.unbind("tap.dismissbutton").bind("tap.dismissbutton",function(){hostinterface.closeAlert()});d.unbind("tap.signupbutton.unbind").bind("tap.signupbutton.unbind",function(){var h=new GameCircleEvent("ExperimentConversion");h.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,
"InitSigninAlertTest");h.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,"T1");h.close();(new GameCircleEvent("InitSigninAlertTestConversion")).close();h={};h[constants.OverlayBindingKeys.OVERLAY_ACTION_CODE_KEY]=constants.OverlayActionCode.SHOW_LOGIN;hostinterface.showOverlay(JSON.stringify(h));hostinterface.closeAlert()});OverlayResizer.resizeAppend(e,a)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
AchievementsPageView=function(){return function(e){var a;this.render=function(){hostinterface.logMessage("AchievementsPageView: render");a=Template.tmpl("AchievementsPage");e.append(a);this.updateScreenSize();hostinterface.logMessage("AchievementsPageView: render ended")};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.Achievements)}}}();
AchievementsWidgetView=function(){return function(e){function a(l,k,m){var n=0;k.show();$.each(l,function(s,q){var u=true;if(q.hiddenValue&&q.progress<100)u=false;if(u){u="achievementIconId"+n;m.imageData.images.push({imageId:u,imageUrl:q.image});b(k,u,q.image,q.title,q.desc,q.unlockdate,q.progress);n++}})}function f(l){return l>=99.5?99:l>0&&l<=0.5?1:Math.round(l)}function c(l){l=Math.floor(l/5)*5;if(l<0||l>100||l%5!==0)l=0;return l}function b(l,k,m,n,s,q,u){var p=c(u);p=j[p];q=u<100?applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_percent_complete",
{perc_complete:f(u)}):moment(q).format("LL");m=$('<tr>             <td class="td-achievement-icon">                 <div class="pull-left iconOverlayContainer">                     <img id="'+k+'" src="'+ImageUtility.imageURLToLocalPath(m)+'" class="achievementIcon" style="display: none">                     <img id="'+k+'-blank" src="img/gamecircle/blank_achievement.png" class="achievementIcon">                     <img src="'+p+'" class="iconOverlay">                 </div>             </td>             <td>                 <h4 class="meta">'+
n+'</h4>                 <p class="meta">'+s+'</p>                 <p class="meta dark-orange">'+q+"</p>             </td>");$("#"+k,m).load(function(){$(this).show();$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide()});l.append(m)}function d(l){l.empty();l.append("<tr>                         </tr>")}var h="",g="All",j={0:"img/gamecircle/increments/achievement_ring_tab_orange_0.png",5:"img/gamecircle/increments/achievement_ring_tab_orange_5.png",10:"img/gamecircle/increments/achievement_ring_tab_orange_10.png",
15:"img/gamecircle/increments/achievement_ring_tab_orange_15.png",20:"img/gamecircle/increments/achievement_ring_tab_orange_20.png",25:"img/gamecircle/increments/achievement_ring_tab_orange_25.png",30:"img/gamecircle/increments/achievement_ring_tab_orange_30.png",35:"img/gamecircle/increments/achievement_ring_tab_orange_35.png",40:"img/gamecircle/increments/achievement_ring_tab_orange_40.png",45:"img/gamecircle/increments/achievement_ring_tab_orange_45.png",50:"img/gamecircle/increments/achievement_ring_tab_orange_50.png",
55:"img/gamecircle/increments/achievement_ring_tab_orange_55.png",60:"img/gamecircle/increments/achievement_ring_tab_orange_60.png",65:"img/gamecircle/increments/achievement_ring_tab_orange_65.png",70:"img/gamecircle/increments/achievement_ring_tab_orange_70.png",75:"img/gamecircle/increments/achievement_ring_tab_orange_75.png",80:"img/gamecircle/increments/achievement_ring_tab_orange_80.png",85:"img/gamecircle/increments/achievement_ring_tab_orange_85.png",90:"img/gamecircle/increments/achievement_ring_tab_orange_90.png",
95:"img/gamecircle/increments/achievement_ring_tab_orange_95.png",100:"img/gamecircle/increments/achievement_ring_tab_orange_100.png"};this.refreshImage=function(l,k){ImageUtility.refreshImage(l,k)};this.render=function(l,k,m,n,s){k={};var q={imageData:{images:[]}};if(m!==LifecyclePhases.AUTH_PHASE)k.showStatus=true;if(n){k.showError=true;k.errorMessage=n}if(s){k.showWarning=true;k.warningMessage=s}var u=m=0,p={image:"img/gamecircle/img-120x120.png",title:"",desc:"",unlockdate:0,progress:100,ring:j[0]};
if(l){m=l.length;var r=false;$.each(l,function(x,A){if(A.progress===100)u+=1;else if(!A.hiddenValue)if(!r){r=true;p=A;if(A.progress<100)p.unlockdate=f(A.progress);var D=c(A.progress);p.ring=j[D]}});k.header={earnedcount:u,totalcount:m,shownext:r,next:{title:p.title,desc:p.desc,date:p.unlockdate,image:p.image,ring:p.ring}};k.achievementsavailable=1;r&&q.imageData.images.push({imageId:"headerAchievementIcon",imageUrl:p.image})}h=Template.tmpl("Achievements",k);n=h.find("#header_achievements_headline_achievements_earned");
s=h.find("#header_achievements_percent_complete");k=h.find("#header_achievements_next_achievement");n.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_headline_achievements_earned",{ach_earned:u,ach_total:m}));s!==undefined&&s!==null&&s.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_percent_complete",{perc_complete:p.unlockdate}));k!==undefined&&k!==null&&k.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_next_achievement"));
var t=h.find("#allButton"),o=h.find("#unearnedButton"),v=h.find("#earnedButton");t.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_nav_all"));o.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_nav_unearned"));v.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_nav_earned"));if(l){var w=[],z=[],B=0;$.each(l,function(x,A){A.progress===100?w.push(A):z.push(A);A.hiddenValue&&
A.progress<100&&B++});var y=h.find("#achTable");if(t!==undefined&&o!==undefined&&v!==undefined){t.unbind("tap.allButtonLink").bind("tap.allButtonLink",function(){t.attr("class","btn btn-small btn-pagefilter active");o.attr("class","btn btn-small btn-pagefilter");v.attr("class","btn btn-small btn-pagefilter");g="All";if(y!==undefined){d(y);a(l,y,q)}ScrollHelper.scrollify(Page.Achievements);var x=new GameCircleEvent("ObjectClicked");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,
"allTab");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Achievements);x.close()});o.unbind("tap.unearnedButtonLink").bind("tap.unearnedButtonLink",function(){t.attr("class","btn btn-small btn-pagefilter");o.attr("class","btn btn-small btn-pagefilter active");v.attr("class","btn btn-small btn-pagefilter");g="Unearned";if(y!==undefined){d(y);a(z,y,q)}ScrollHelper.scrollify(Page.Achievements);var x=new GameCircleEvent("ObjectClicked");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,
"unearnedTab");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Achievements);x.close()});v.unbind("tap.earnedButtonLink").bind("tap.earnedButtonLink",function(){t.attr("class","btn btn-small btn-pagefilter");o.attr("class","btn btn-small btn-pagefilter");v.attr("class","btn btn-small btn-pagefilter active");g="Earned";if(y!==undefined)if(w.length===0)y.hide();else{d(y);a(w,y,q)}ScrollHelper.scrollify(Page.Achievements);var x=new GameCircleEvent("ObjectClicked");
x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"earnedTab");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Achievements);x.close()})}if(y!==undefined){m=l;if(g==="Unearned")m=z;else if(g==="Earned")m=w;a(m,y,q)}if(B>0){m=h.find("#hiddenAchievementCountTable");n="";s=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_hidden_achievements_detail_text");if(B===1)n=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_hidden_achievements_singular");
else if(B>=2)n=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_hidden_achievements_plural",{numberOfHiddenAchievements:B});m.append('<tr> <td class="td-achievement-icon"> <div class="pull-left iconOverlayContainer"> <img id="hiddenAchievementCountTableRow" src="img/gamecircle/blank_achievement.png" class="achievementIcon"> <img src="'+j[0]+'" class="iconOverlay"> </div> </td> <td> <h4 class="meta">'+n+'</h4> <p class="meta">'+s+"</p> </td>")}}e.empty();e.append(h);
ScrollHelper.scrollify(Page.Achievements);return q};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
EditProfileNavigationWidgetView=function(){return function(e){function a(c,b){var d=new GameCircleEvent("ObjectClicked");d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,c);d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,b);d.close()}var f="";this.render=function(){f=Template.tmpl("EditProfileNavigation",{});f.find("#title").html(applicationContext.getObject("ApplicationName"));e.empty();e.append(f);var c=f.find("#backbutton"),b=f.find("#savebutton");
b.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_button_save"));c.unbind("tap.menuButton").bind("tap.menuButton",function(){a("backButton",PageId.EditProfile);applicationContext.getObject("OverlayController").showProfile()});b.unbind("tap.savebutton").bind("tap.savebutton",function(){a("save",PageId.EditProfile);applicationContext.getObject("EditProfilePageController").saveProfile()})};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
EditProfilePageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("EditProfilePage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();var f=applicationContext.getObject("EditProfilePageController").getAvatarListWidth();a.find("#avatars").width(f);applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.EditProfile)}}}();
EditProfileWidgetView=function(){return function(e){this.refreshImage=function(f,c){ImageUtility.refreshImage(f,c);ScrollHelper.refreshScrollBounds(Page.EditProfile)};this.render=function(f,c,b,d){var h={imageData:{}},g={},j=[];if(f){g=f.profile;if(f.avatars){j=a(f.avatars,g.avatarId);h.imageData.images=j}}g={avatars:j};if(c!==LifecyclePhases.AUTH_PHASE)g.showStatus=true;if(b){g.showError=true;g.errorMessage=b}if(d){g.showWarning=true;g.warningMessage=d}var l=Template.tmpl("EditProfile",g);l.find("#editNicknameLabel").html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_edit_nickname"));
l.find("#selectPictureLabel").html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_select_picture"));(c=l.find("#editAlias"))&&f&&f.profile&&f.profile.alias&&c.attr("value",f.profile.alias);l.find("#avatars img").each(function(){var k=$(this);k.load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).remove();$(this).show()});k.unbind("tap.avatar").bind("tap.avatar",function(){l.find(".img-profile-selected").each(function(){$(this).removeClass("img-profile-selected")});
k.addClass("img-profile-selected")})});f=applicationContext.getObject("EditProfilePageController").getAvatarListWidth();l.find("#avatars").width(f);e.empty();e.append(l);ScrollHelper.scrollify(Page.EditProfile);return h};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)};var a=function(f,c){var b=[];for(i=0;i<f.length;i++)c===f[i].avatarId?b.unshift({avatarId:f[i].avatarId,className:"img-profile-selected",localAvatarUrl:f[i].localAvatarUrl,imageUrl:f[i].avatarUrl,imageId:"avatar-image-"+
i}):b.push({avatarId:f[i].avatarId,className:"img-profile",localAvatarUrl:f[i].localAvatarUrl,imageUrl:f[i].avatarUrl,imageId:"avatar-image-"+i});return b}}}();FTUEAgeVerificationPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("FTUEAgeVerificationPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUEAgeVerification)}}}();
FTUEAgeVerificationWidgetView=function(){return function(e){var a="";this.render=function(){var f=ServiceFactory.getGCSettings(),c=function(){var b={};b[constants.OverlayBindingKeys.OVERLAY_ACTION_CODE_KEY]=constants.OverlayActionCode.SHOW_AGE_VIOLATION;b.widthPercentage=0.8;b.heightPercentage=0.32;hostinterface.showAlert(JSON.stringify(b));hostinterface.closeOverlay()};$.when(f.getAgeViolation()).done(function(b){if(b)c();else{var d=function(){var j=(new Date).getFullYear();if(j===undefined||j<2013)j=
2013;return j};b=d();for(var h=[];b>=1900;)h.push(b--);b={years:h};hostinterface.logMessage("FTUEAgeVerificationWidgetView:"+JSON.stringify(b));a=Template.tmpl("FTUEAgeVerification",b);applicationContext.getObject("StringLocalizationWrapper").getStrings(a);var g={};g[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.AUTHENTICATE;a.find("#continuebutton").unbind("tap.continueButton").bind("tap.continueButton",function(){var j=$("#yearList").val();if(j!=="prompt")if(j=parseInt(j,
10))if(d()-j>13){NativeTransport.callNative({nativeCall:"backgroundTask",args:g});hostinterface.closeOverlay()}else{f.setAgeViolation(true);c()}});a.find("#cancelbutton").unbind("tap.cancelButton").bind("tap.cancelButton",function(){hostinterface.closeOverlay()});e.empty();e.append(a);ScrollHelper.scrollify(Page.FTUEAgeVerification)}})};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
FTUEAgeViolationPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("FTUEAgeViolationPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUEAgeViolation)}}}();
FTUEAgeViolationWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("FTUEAgeViolation",{});var f=a.find("#ageViolation"),c=a.find("#dismissButton");f.html(applicationContext.getObject("StringLocalizationWrapper").getString("age_violation_message"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("age_violation_ok"));f.unbind("tap.testtextbutton").bind("tap.testtextbutton",function(){var b={};b[constants.OverlayBindingKeys.OVERLAY_ACTION_CODE_KEY]=
constants.OverlayActionCode.SHOW_SUMMARY;hostinterface.showOverlay(JSON.stringify(b))});c.unbind("tap.dismissbutton").bind("tap.dismissbutton",function(){hostinterface.closeAlert()});OverlayResizer.resizeAppend(e,a)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
FTUECORSelectionPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("FTUECORSelectionPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUECORSelection)}}}();
FTUECORSelectionWidgetView=function(){return function(e){var a="";this.render=function(f){var c={};if(f&&f.countries)c.countries=f.countries;else console.log("TODO: error handling for missing countries.");a=Template.tmpl("FTUECORSelection",c);applicationContext.getObject("StringLocalizationWrapper").getStrings(a);a.find("#savebutton").unbind("tap.savebutton").bind("tap.savebutton",function(){var b=$("#countrylist").val();if(b!=="prompt"){var d={};d[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.UPDATE_COUNTRY_OF_RESIDENCE;
d[constants.BindingKeys.COUNTRY_OF_RESIDENCE]=b;NativeTransport.callNative({nativeCall:"backgroundTask",args:d});d=new GameCircleEvent("ObjectClicked");d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"saveButton");d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUECORSelection);d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_COUNTRY,b);d.close();hostinterface.closeOverlay()}});a.find("#cancelbutton").unbind("tap.cancelbutton").bind("tap.cancelbutton",
function(){var b=new GameCircleEvent("ObjectClicked");b.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"cancelButton");b.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUECORSelection);b.close();hostinterface.closeOverlay()});e.empty();e.append(a)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
FTUECORUnsupportedPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("FTUECORUnsupportedPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUECORUnsupported)}}}();
FTUECORUnsupportedWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("FTUECORUnsupported",{});var f=a.find("#dismissButton"),c=a.find("#learnMoreLink"),b=a.find("#agsTitle"),d=a.find("#corUnsupported");b.html(applicationContext.getObject("StringLocalizationWrapper").getString("country_picker_prompt_headline_country_not_supported"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("country_picker_prompt_desc_country_not_supported"));f.html(applicationContext.getObject("StringLocalizationWrapper").getString("country_picker_prompt_button_not_supported_ok"));
c.html(applicationContext.getObject("StringLocalizationWrapper").getString("country_picker_prompt_link_learn_more"));f.unbind("tap.dismissbutton").bind("tap.dismissbutton",function(){hostinterface.closeAlert()});c.unbind("tap.learnmorelink").bind("tap.learnmorelink",function(){var h={};h[constants.OverlayBindingKeys.OVERLAY_ACTION_CODE_KEY]=constants.OverlayActionCode.SHOW_LEARN_MORE;hostinterface.showOverlay(JSON.stringify(h))});OverlayResizer.resizeAppend(e,a)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
FTUELoginPageView=function(){return function(e){var a;this.render=function(){hostinterface.logMessage("FTUELoginPageView: render");a=Template.tmpl("FTUELoginPage");e.append(a);this.updateScreenSize();hostinterface.logMessage("FTUELoginPageView: render ended")};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUELogin)}}}();
FTUELoginWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("FTUELogin",{});var f=a.find("#signinDetails"),c=a.find("#gameSupports"),b=a.find("#leaderboardsSection"),d=a.find("#leaderboardsDescription"),h=a.find("#achievementsSection"),g=a.find("#achievementsDescription"),j=a.find("#wsSection"),l=a.find("#wsDescription"),k=a.find("#signinbutton"),m=a.find("#newaccountbutton"),n=a.find("#nothanksbutton"),s=a.find("#tosDescription");f.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_details_signin"));
c.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_features_supported"));b.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_leaderboards"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_leaderboards"));h.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_achievements"));g.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_achievements"));
j.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_whispersync"));l.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_whispersync"));k.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_button_signin"));m.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_button_new_account"));n.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_link_no_thanks"));
s.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_terms_of_use_signin"));var q={};q[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.AUTHENTICATE;k.unbind("tap.signinbutton").bind("tap.signinbutton",function(){NativeTransport.callNative({nativeCall:"backgroundTask",args:q});var u=new GameCircleEvent("ObjectClicked");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"signInButton");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,
PageId.FTUELogin);u.close();hostinterface.closeOverlay()});m.unbind("tap.newaccountbutton").bind("tap.newaccountbutton",function(){var u=new GameCircleEvent("ObjectClicked");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"newAccountButton");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUELogin);u.close();applicationContext.getObject("OverlayController").showFTUEAgeVerification()});n.unbind("tap.nothanksbutton").bind("tap.nothanksbutton",
function(){var u=new GameCircleEvent("ObjectClicked");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"noThanksButton");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUELogin);u.close();hostinterface.closeOverlay()});f=applicationContext.getObject("DOMUtility");f.convertSpanToAnchor("link_terms",a,function(){BrowserUtility.launchLegalInformation()});f.convertSpanToAnchor("link_play_data",a,function(){applicationContext.getObject("OverlayController").showLearnMore()});
e.empty();e.append(a);ScrollHelper.scrollify(Page.FTUELogin)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();FTUETOSPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("FTUETOSPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.FTUETOS)}}}();
FTUETOSWidgetView=function(){return function(e){var a="";this.render=function(f){a=Template.tmpl("FTUETOS",{});var c=a.find("#connectbutton"),b=a.find("#nothanksbutton"),d=a.find("#connectDetails"),h=a.find("#gameSupports"),g=a.find("#leaderboardsSection"),j=a.find("#leaderboardsDescription"),l=a.find("#achievementsSection"),k=a.find("#achievementsDescription"),m=a.find("#wsSection"),n=a.find("#wsDescription"),s=a.find("#tosDescription");d.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_details_connect"));
h.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_features_supported"));g.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_leaderboards"));j.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_leaderboards"));l.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_achievements"));k.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_achievements"));
m.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_headline_whispersync"));n.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_desc_whispersync"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_button_connect"));b.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_link_no_thanks"));s.html(applicationContext.getObject("StringLocalizationWrapper").getString("signinpage_terms_of_use_connect"));
d=false;if(f!==null&&f!==undefined)d=f.isKindle;var q={};q[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.AUTHENTICATE;c.unbind("tap.connectButton").bind("tap.connectButton",function(){var u=new GameCircleEvent("ObjectClicked");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"connectButton");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUETOS);u.close();NativeTransport.callNative({nativeCall:"backgroundTask",
args:q});hostinterface.closeOverlay()});b.unbind("tap.noThanksButton").bind("tap.noThanksButton",function(){var u=new GameCircleEvent("ObjectClicked");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"noThanksButton");u.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUETOS);u.close();hostinterface.closeOverlay()});if(d){q[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.SET_OPT_IN;c.unbind("tap.connectButton").bind("tap.connectButton",
function(){q[constants.NativeCallKeys.HAS_OPTED_IN]=true;NativeTransport.callNative({nativeCall:"backgroundTask",args:q});hostinterface.closeOverlay()});b.unbind("tap.noThanksButton").bind("tap.noThanksButton",function(){q[constants.NativeCallKeys.HAS_OPTED_IN]=false;NativeTransport.callNative({nativeCall:"backgroundTask",args:q});hostinterface.closeOverlay()})}else{q[constants.ServiceActionCode.ACTION_CODE_KEY]=constants.ServiceActionCode.AUTHENTICATE;c.unbind("tap.connectButton").bind("tap.connectButton",
function(){NativeTransport.callNative({nativeCall:"backgroundTask",args:q});hostinterface.closeOverlay()});b.unbind("tap.noThanksButton").bind("tap.noThanksButton",function(){hostinterface.closeOverlay()})}f=applicationContext.getObject("DOMUtility");f.convertSpanToAnchor("link_terms",a,function(){BrowserUtility.launchLegalInformation()});f.convertSpanToAnchor("link_play_data",a,function(){applicationContext.getObject("OverlayController").showLearnMore()});e.empty();e.append(a);ScrollHelper.scrollify(Page.FTUETOS)};
this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();LeaderboardSignInPromptPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("LeaderboardSignInPromptPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){}}}();
LeaderboardSignInPromptWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("LeaderboardSignInPrompt",{});var f=a.find("#agc-signup-alert-title"),c=a.find("#agc-signup-alert-description"),b=a.find("#nothanksbutton"),d=a.find("#signinbutton");f.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_leaderboard_headline"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_leaderboard_body"));
b.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_leaderboard_no_btn"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("signin_prompt_leaderboard_yes_btn"));b.unbind("tap.dismissbutton").bind("tap.dismissbutton",function(){hostinterface.closeAlert()});d.unbind("tap.signupbutton.unbind").bind("tap.signupbutton.unbind",function(){var h=new GameCircleEvent("ExperimentConversion");h.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,
"InitSigninAlertTest");h.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,"T1");h.close();(new GameCircleEvent("InitSigninAlertTestConversion")).close();h={};h[constants.OverlayBindingKeys.OVERLAY_ACTION_CODE_KEY]=constants.OverlayActionCode.SHOW_LOGIN;hostinterface.showOverlay(JSON.stringify(h));hostinterface.closeAlert()});OverlayResizer.resizeAppend(e,a)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
LeaderboardsPageView=function(){return function(e){var a;this.render=function(){hostinterface.logMessage("LeaderboardsPageView: render");a=Template.tmpl("LeaderboardsPage");e.append(a);this.updateScreenSize();hostinterface.logMessage("LeaderboardsPageView: render ended")};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();var f=applicationContext.getObject("ScreenSize").getScreenWidth();if(f){a.find("#leaderboardTable tr:first td").not("td.leaderboard-name").each(function(){f-=
parseInt($(this).width(),10)});a.find("td.leaderboard-name h4").width(f-20)}applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.Leaderboards)}}}();
LeaderboardsWidgetView=function(){return function(e){function a(g,j,l){var k=0;$("#bestLeaderboardIcon").load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});$.each(g.leaderboards,function(m,n){var s="leaderboardIconId"+k;l.imageData.images.push({imageId:s,imageUrl:n.LEADERBOARD_ICON_URL});j?c(s,n.LEADERBOARD_ID,n.LEADERBOARD_NAME,n.LEADERBOARD_DISPLAY_TEXT,n.LEADERBOARD_DATA_FORMAT,n.LEADERBOARD_PERCENTILE_RANK,n.LEADERBOARD_PLAYER_SCORE,n.LEADERBOARD_ICON_URL):
f(s,n.LEADERBOARD_ID,n.LEADERBOARD_NAME,n.LEADERBOARD_DISPLAY_TEXT,n.LEADERBOARD_DATA_FORMAT,n.LEADERBOARD_PERCENTILE_RANK,n.LEADERBOARD_PLAYER_SCORE,n.LEADERBOARD_ICON_URL);k++})}function f(g,j,l,k,m,n,s,q){m=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked");var u="";if(n&&n!==-1){m=h.formatScore(s,k);u=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_ranked",{rank:n})}l=$('<tr id="leaderboardEntry'+
j+'">                 <td class="leaderboard-icon">                     <div class="pull-left img-margin-right iconOverlayContainer">                         <img id="'+g+'" src="'+ImageUtility.imageURLToLocalPath(q)+'" class="leaderboardIcon" style="display: none">                         <img id="'+g+'-blank" src="img/gamecircle/blank_leaderboard.png" class="leaderboardIcon">                         <img src="img/gamecircle/leaderboard_ring_tab_gray.png" class="leaderboardIconOverlay iconOverlay">                     </div>                 </td>                 <td class="leaderboard-name">                     <h4 class="meta-title agc-text-overflow">'+
l+'</h4>                     <p class="meta">'+m+'</p>                     <p class="meta dark-orange">'+u+'</p>                 </td>                 <td class="leaderboard-button">                     <button class="pull-right btn-link carrot-right"></button>                 </td>             </tr>');l.find("#"+g).load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});$("#leaderboardTable").append(l);g=$("#leaderboardEntry"+j);if(g!==undefined){var p={};p.leaderboardIdToDisplay=
j;g.unbind("tap.menuLeaderboardRanksLink").bind("tap.menuLeaderboardRanksLink",function(){if(applicationContext.getObject("PageController").isMenuDisplayed()===false){var r=new GameCircleEvent("ObjectClicked");r.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"displayLeaderboard");r.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Leaderboards);r.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,j);
r.close();applicationContext.getObject("OverlayController").showLeaderboardRanks(p)}})}}function c(g,j,l,k,m,n,s,q){m=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked");if(s&&s!==-1)m=h.formatScore(s,k);l=$('<tr id="leaderboardEntry'+j+'">                         <td class="leaderboard-icon">                             <div class="pull-left img-margin-right iconOverlayContainer">                                 <img id="'+g+'" src="'+ImageUtility.imageURLToLocalPath(q)+
'" class="leaderboardIcon" style="display: none">                                 <img id="'+g+'-blank" src="img/gamecircle/blank_leaderboard.png" class="leaderboardIcon">                                 <img src="img/gamecircle/leaderboard_ring_tab_gray.png" class="leaderboardIconOverlay iconOverlay">                             </div>                         </td>                         <td class="leaderboard-name">                             <h4 class="meta-title agc-text-overflow">'+l+'</h4>                             <p class="meta">'+
m+'</p>                         </td>                         <td class="leaderboard-button">                             <button class="pull-right btn-link carrot-right"></button>                         </td>                     </tr>');$("#leaderboardTable").append(l);l.find("#"+g).load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});g=$("#leaderboardEntry"+j);if(g!==undefined){var u={};u.leaderboardIdToDisplay=j;g.unbind("tap.menuLeaderboardRanksLink").bind("tap.menuLeaderboardRanksLink",
function(){if(applicationContext.getObject("PageController").isMenuDisplayed()===false){var p=new GameCircleEvent("ObjectClicked");p.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"displayLeaderboardForGuest");p.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Leaderboards);p.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,j);p.close();applicationContext.getObject("OverlayController").showLeaderboardRanks(u)}})}}
function b(g,j,l){return l==="DESCENDING"?g===undefined?j:j===undefined?g:g>=j?g:j:g===undefined?j:j===undefined?g:g<=j?g:j}var d="",h=new ScoreFormatter;this.refreshImage=function(g,j){ImageUtility.refreshImage(g,j)};this.render=function(g,j,l,k,m){var n={};j={imageData:{images:[]}};if(l!==LifecyclePhases.AUTH_PHASE)n.showStatus=true;if(k){n.showError=true;n.errorMessage=k}if(m){n.showWarning=true;n.warningMessage=m}d=Template.tmpl("Leaderboards",n);l=d.find("#headerLeaderboardDesc");l!==undefined&&
l!==null&&l.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_best_rank"));e.empty();e.append(d);if(g){k=g.leaderboards;k.sort(function(B,y){if(B===undefined||B===null||B.LEADERBOARD_POSITION===undefined||B.LEADERBOARD_POSITION===null)return-1;if(y===undefined||y===null||y.LEADERBOARD_POSITION===undefined||y.LEADERBOARD_POSITION===null)return-1;var x=parseInt(B.LEADERBOARD_POSITION,10),A=parseInt(y.LEADERBOARD_POSITION,10);if(isNaN(x)||isNaN(A))return-1;
return x-A});l=g.isGuest;m=k.length;var s={IconUrl:"img/gamecircle/img-120x120.png",name:"",displayText:"",percentileRank:"",playerScore:""},q=101,u=Number.MAX_VALUE,p=Number.MIN_VALUE;if(l){var r=0;$.each(k,function(B,y){if(y.LEADERBOARD_SORT_ORDER==="DESCENDING"){if(b(p,y.LEADERBOARD_PLAYER_SCORE,y.LEADERBOARD_SORT_ORDER)===y.LEADERBOARD_PLAYER_SCORE)p=y.LEADERBOARD_PLAYER_SCORE}else if(b(u,y.LEADERBOARD_PLAYER_SCORE,y.LEADERBOARD_SORT_ORDER)===y.LEADERBOARD_PLAYER_SCORE)u=y.LEADERBOARD_PLAYER_SCORE});
r=Math.min(p,u)===u?u:p;$.each(k,function(B,y){if(y.LEADERBOARD_PLAYER_SCORE===r){s={IconUrl:y.LEADERBOARD_ICON_URL,name:y.LEADERBOARD_NAME,displayText:y.LEADERBOARD_DISPLAY_TEXT,percentileRank:y.LEADERBOARD_PERCENTILE_RANK,playerScore:y.LEADERBOARD_PLAYER_SCORE};return false}})}else{var t=0;$.each(k,function(B,y){if(q>y.LEADERBOARD_PERCENTILE_RANK&&y.LEADERBOARD_PERCENTILE_RANK>-1)q=y.LEADERBOARD_PERCENTILE_RANK});t=q;$.each(k,function(B,y){if(y.LEADERBOARD_PERCENTILE_RANK===t){s={IconUrl:y.LEADERBOARD_ICON_URL,
name:y.LEADERBOARD_NAME,displayText:y.LEADERBOARD_DISPLAY_TEXT,percentileRank:y.LEADERBOARD_PERCENTILE_RANK,playerScore:y.LEADERBOARD_PLAYER_SCORE};return false}})}var o=d.find("#leaderboardCount"),v=d.find("#bestLeaderboardIcon"),w=d.find("#bestLeaderboardName");n=d.find("#bestLeaderboardScore");k=d.find("#bestLeaderboardRank");var z="";z=m===1?applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_headline_num_leaderboards_singular"):applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_headline_num_leaderboards_plural",
{num_leaderboards:m});o.html(z);v.attr("src",s.IconUrl);w.html(s.name);m=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked");if(s.playerScore&&s.playerScore!==-1)m=h.formatScore(s.playerScore,s.displayText);n.html(m);if(l)k.html("");else{m="";if(s.percentileRank&&s.percentileRank!==-1)m=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_ranked",{rank:s.percentileRank});k.html(m)}a(g,l,j)}ScrollHelper.scrollify(Page.Leaderboards);
return j};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
LeaderboardRanksPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("LeaderboardRanksPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();if(a.find("#allPlayers tr").length){var f=$("#allPlayers").outerWidth();a.find("table.leaderboardRanks").width(f);if(navigator.userAgent.match(/Android/)){var c=parseInt(a.find("#allPlayers table").css("border-left-width"),10)+parseInt(a.find("#allPlayers table").css("border-right-width"),
10)+a.find("#allPlayers table tr:eq(0) td:eq(0)").outerWidth()+a.find("#allPlayers table tr:eq(0) td:eq(1)").outerWidth()+parseInt(a.find("#allPlayers table tr:eq(0) td:eq(2)").css("padding-left"),10)+parseInt(a.find("#allPlayers table tr:eq(0) td:eq(2)").css("padding-right"),10);f=f-c-10;a.find("table.leaderboardRanks td.profile h5.alias").width(f)}}applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.LeaderboardRanks)}}}();
LeaderboardRanksWidgetView=function(){return function(e){function a(){u=$("#allPlayers tr.currentPlayer");ScrollHelper.scrollify(Page.LeaderboardRanks,{onScrollTo:function(){$("#currentPlayerOverlay").updatePosition()},onScrollEnd:function(){$("#currentPlayerOverlay").updatePosition()}});$("#currentPlayerOverlay").updatePosition()}function f(p,r){var t=p.detailedList,o=p.leaderboardInfo.LEADERBOARD_DISPLAY_TEXT,v=p.profile.playerId,w=0,z=applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_profile_is_hidden_2");
$("#allPlayers table").css({"margin-bottom":"0px",display:"block"});a();$.each(t,function(B,y){var x="leaderboardEntryIconId"+w;r.imageData.images.push({imageId:x,imageUrl:y.avatarUrl});var A=y.alias;if(A==="Hidden")A=z;c(x,y.rank,y.avatarUrl,A,y.score,o,v===y.playerId);w++})}function c(p,r,t,o,v,w,z){r=$('<tr>                               <td class="rank">                                   <p class="percentile">'+r+'</p>                               </td>                               <td class="avatar">                                   <img class="leaderboardAvatarIcon" id="'+
p+'" src="'+ImageUtility.imageURLToLocalPath(t)+'" width="40" height="40" style="display: none">                                   <img class="leaderboardAvatarIcon" id="'+p+'-blank" src="img/gamecircle/blank_profile.png" width="40" height="40">                               </td>                               <td class="profile">                                   <h5 class="alias">'+o+'</h5>                                   <p class="score">'+n.formatScore(v,w)+"</p>                               </td>                           </tr>");
$("#"+p,r).load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});if(z){$(r).addClass("currentPlayer");$(".alias",r).append(" ("+applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_you")+") ");$("#currentPlayerOverlay table").html(r.clone(true))}$("#allPlayers table").append(r)}function b(p,r){var t=p.detailedList,o=p.leaderboardInfo.LEADERBOARD_DISPLAY_TEXT,v=p.profile.playerId,w=p.dataFilter,z=0,B=applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_profile_is_hidden_2");
$("#currentPlayerOverlay table").empty();$("#allPlayers table").css({"margin-bottom":"0px",display:"block"});a();$.each(t,function(y,x){var A="leaderboardEntryIconId"+z;r.imageData.images.push({imageId:A,imageUrl:x.avatarUrl});var D=x.alias;if(D==="Hidden")D=B;d(A,x.rank,x.avatarUrl,D,x.score,o,v===x.playerId);z++});if(!$("#currentPlayerOverlay table").html()&&w==="GLOBAL_ALL_TIME"){t=$('<tr class="currentPlayer fixedToBottom">                               <td class="rank">                                   <p class="percentile">'+
p.leaderboardInfo.LEADERBOARD_PERCENTILE_RANK+'</p>                               </td>                               <td class="avatar">                                   <img class="leaderboardAvatarIcon" id="'+p.profile.avatarId+'" src="'+ImageUtility.imageURLToLocalPath(p.profile.avatarUrl)+'" width="40" height="40" style="display: none">                                   <img class="leaderboardAvatarIcon" id="'+p.profile.avatarId+'-blank" src="img/gamecircle/blank_profile.png" width="40" height="40">                               </td>                               <td class="profile">                                   <h5 class="alias">'+
p.profile.alias+" ("+applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_you")+')</h5>                                   <p class="score">'+n.formatScore(p.leaderboardInfo.LEADERBOARD_PLAYER_SCORE,o)+"</p>                               </td>                           </tr>");$(t).find("#"+p.profile.avatarId).load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});$("#currentPlayerOverlay table").append(t);$("#allPlayers table").css({"margin-bottom":"68px",
display:"block"});a()}}function d(p,r,t,o,v,w,z){r=$('<tr>                               <td class="rank">                                   <p>'+r+'</p>                               </td>                               <td class="avatar">                                   <img class="leaderboardAvatarIcon" id="'+p+'" src="'+ImageUtility.imageURLToLocalPath(t)+'" width="40" height="40" style="display: none">                                   <img class="leaderboardAvatarIcon" id="'+p+'-blank" src="img/gamecircle/blank_profile.png" width="40" height="40">                               </td>                               <td class="profile">                                   <h5 class="alias">'+
o+'</h5>                                   <p class="score">'+n.formatScore(v,w)+"</p>                               </td>                           </tr>");$(r).find("#"+p).load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});if(z){r.addClass("currentPlayer");$(".alias",r).append(" ("+applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_you")+") ");$("#currentPlayerOverlay table").html(r.clone(true))}$("#allPlayers table").append(r)}
function h(p,r){var t=new GameCircleEvent("ObjectClicked");t.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,r);t.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.LeaderboardRanks);t.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,p);t.close()}function g(p){p==="percentiles"?$("#datasetToggle").html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_button_top_100")).attr("data-set",
p):$("#datasetToggle").html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_button_all_rankings")).attr("data-set",p)}function j(p){if(p==="GLOBAL_DAY"){$("#todayButton").addClass("active");$("#weekButton").removeClass("active");$("#allButton").removeClass("active")}else if(p==="GLOBAL_WEEK"){$("#todayButton").removeClass("active");$("#weekButton").addClass("active");$("#allButton").removeClass("active")}else if(p==="GLOBAL_ALL_TIME"){$("#todayButton").removeClass("active");
$("#weekButton").removeClass("active");$("#allButton").addClass("active")}}function l(p,r){var t={requestParams:{leaderboardIdToDisplay:p,dataSet:$("#datasetToggle").attr("data-set"),dataFilter:$("#dataFilter > div.active").attr("data-filter")},successHandler:function(o){o.dataFilter=t.requestParams.dataFilter;if(o)if(o.leaderboardInfo){var v={imageData:{images:[]}};if(o.dataSet==="percentiles"){$("#datasetToggle").html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_button_top_100"));
f(o,v)}else{$("#datasetToggle").html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_button_all_rankings"));b(o,v)}k(v.imageData);navigator.userAgent.match(/Android/)&&$("td.profile h5.alias").width(q)}else o.error&&$("#errorBar").html(o.error).show();$("#statusBar").hide();a()}};q=q||$("table.leaderboardRanks td.profile h5.alias").width();$("#warningBar").hide();$("#errorBar").hide();$("#statusBar").show();$("table.leaderboardRanks").empty();$.extend(t.requestParams,
r);s.getData(t,false)}function k(p){if(p.images.length>0){var r=p.images.splice(0,2);NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:{imageData:{images:r}}}).always(function(){$.each(r,function(t,o){ImageUtility.refreshImage(o.imageId,o.imageUrl)});k(p)})}}var m="",n=new ScoreFormatter,s=applicationContext.getObject("LeaderboardRanksWidgetDAO");applicationContext.getObject("LeaderboardRanksPageView");var q=0;this.refreshImage=function(p,r){ImageUtility.refreshImage(p,
r)};var u=null;$.fn.updatePosition=function(){if(u!==null&&u.length===1){var p=u.position();p.bottom=p.top+u.outerHeight();if($(this).has(".fixedToBottom").length||p.bottom>=$("#agc-main-content").outerHeight())$(this).css({bottom:0,display:"block",top:"auto"});else p.top<=0?$(this).css({bottom:"auto",display:"block",top:0}):$(this).css({bottom:"auto",display:"none",top:"auto"});navigator.userAgent.match(/Android/)?$(this).find("table").css("table-layout","auto"):$(this).find("table").css("table-layout",
"fixed")}};this.render=function(p,r,t,o,v){var w={},z={imageData:{images:[]}};if(t!==LifecyclePhases.AUTH_PHASE)w.showStatus=true;if(o){w.showError=true;w.errorMessage=o}if(v){w.showWarning=true;w.warningMessage=v}e.empty();m=Template.tmpl("LeaderboardRanks",w);var B=m.find("#datasetToggle"),y=m.find("#leaderboardIcon");v=m.find("#leaderboardName");w=m.find("#leaderboardDesc");t=m.find("#playerRank");var x=m.find("#todayButton"),A=m.find("#weekButton"),D=m.find("#allButton");navigator.userAgent.match(/Android/)?
m.find("table.leaderboardRanks").css("table-layout","auto"):m.find("table.leaderboardRanks").css("table-layout","fixed");var E=r.leaderboardIdToDisplay;o=r.dataSet;r=r.dataFilter;x.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_nav_today"));A.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_nav_this_week"));D.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_detail_nav_all"));
if(o===undefined)o="percentiles";if(r===undefined)r="GLOBAL_ALL_TIME";B.unbind("tap.leaderboardRanksDatasetLink").bind("tap.leaderboardRanksDatasetLink",function(){if(!$("#statusBar").is(":visible")){var C=$(this).attr("data-set")==="percentiles"?"leaderboardRanksDatasetLink_Top100":"leaderboardRanksDatasetLink_Percentiles";h(E,C);C=$(this).attr("data-set")==="percentiles"?"top100":"percentiles";g(C);l(E,{dataSet:C})}a()});x.unbind("tap.leaderboardRanksDayLink").bind("tap.leaderboardRanksDayLink",
function(){if(!$(this).hasClass("active")&&!$("#statusBar").is(":visible")){h(E,"leaderboardRanksDayLink");var C=$(this).attr("data-filter");j(C);l(E,{dataFilter:C})}a()});A.unbind("tap.leaderboardRanksWeekLink").bind("tap.leaderboardRanksWeekLink",function(){if(!$(this).hasClass("active")&&!$("#statusBar").is(":visible")){h(E,"leaderboardRanksWeekLink");var C=$(this).attr("data-filter");j(C);l(E,{dataFilter:C})}a()});D.unbind("tap.leaderboardRanksGlobalLink").bind("tap.leaderboardRanksGlobalLink",
function(){if(!$(this).hasClass("active")&&!$("#statusBar").is(":visible")){h(E,"leaderboardRanksGlobalLink");var C=$(this).attr("data-filter");j(C);l(E,{dataFilter:C})}a()});if(p&&p.leaderboardInfo){D=p.leaderboardInfo;var F=D.LEADERBOARD_ICON_URL;x=D.LEADERBOARD_PERCENTILE_RANK;A=D.LEADERBOARD_PLAYER_SCORE;B=D.LEADERBOARD_DISPLAY_TEXT;y.attr("src",F);y.load(function(){$("#leaderboardIcon-blank").hide();y.show()});v.html(D.LEADERBOARD_NAME);w.html(D.LEADERBOARD_DESC);if(p.isGuest){v=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked");
if(A&&A!==-1)v=n.formatScore(A,B);t.html(v)}else{v=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked");if(x&&x!==-1)v=applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboards_ranked",{rank:x});t.html(v)}}e.append(m);g(o);j(r);if(p){p.dataFilter=r;o==="percentiles"?f(p,z):b(p,z)}a();return z};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
LearnMorePageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("LearnMorePage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.LearnMore)}}}();
LearnMoreWidgetView=function(){return function(e){var a="";this.render=function(){a=Template.tmpl("LearnMore",{});e.empty();e.append(a);var f=a.find("#faq_headline_what_data"),c=a.find("#answer_what_data"),b=a.find("#faq_headline_what_services_without_sign_in"),d=a.find("#answer_what_services_without_sign_in"),h=a.find("#faq_headline_does_game_support"),g=a.find("#answer_does_game_support"),j=a.find("#faq_headline_no_share_info"),l=a.find("#answer_no_share_info"),k=a.find("#faq_headline_turn_off_gamecircle"),
m=a.find("#answer_turn_off_gamecircle"),n=a.find("#faq_headline_access_settings"),s=a.find("#answer_access_settings"),q=a.find("#faq_headline_work_on_my_devices"),u=a.find("#answer_work_on_my_devices"),p=a.find("#faq_headline_new_country"),r=a.find("#answer_new_country"),t=a.find("#legalInformation");f.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_what_data"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_what_data"));
b.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_what_services_without_sign_in"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_what_services_without_sign_in"));h.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_does_game_support"));g.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_does_game_support"));j.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_no_share_info"));
l.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_no_share_info"));k.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_turn_off_gamecircle"));m.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_turn_off_gamecircle"));n.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_access_settings"));s.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_access_settings"));
q.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_work_on_my_devices"));u.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_work_on_my_devices"));p.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_faq_headline_new_country"));r.html(applicationContext.getObject("StringLocalizationWrapper").getString("learnmore_answer_new_country"));f=applicationContext.getObject("DOMUtility");
f.convertSpanToAnchor("link_tapping",a,function(){BrowserUtility.launchCORChange()});f.convertSpanToAnchor("turn_off_link_tapping",a,function(){BrowserUtility.launchRevokeAuthToken()});t.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_link_legal_information"));t.unbind("tap.legalInformation").bind("tap.legalInformation",function(){BrowserUtility.launchLegalInformation()});ScrollHelper.scrollify(Page.LearnMore)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
MenuWidgetView=function(){return function(e){function a(c){var b=new GameCircleEvent("ObjectClicked");b.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,c);b.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Menu);b.close()}var f;this.refreshImage=function(c,b){ImageUtility.refreshImage(c,b)};this.render=function(c){var b={imageData:{}},d={};d.achievementsExist=true;d.leaderboardsExist=true;if(c){d.achievementsExist=c.achievementsExist;
d.leaderboardsExist=c.leaderboardsExist;if(c.isGuest)d.localAvatarUrl="img/gamecircle/img-page-hero-guest.png";else if(c.localAvatarUrl){d.localAvatarUrl=c.localAvatarUrl;if(c.avatarUrl)b.imageData.images=[{imageId:"menuProfileImage",imageUrl:c.avatarUrl}];else console.error("MenuWidgetView: missing avatar url")}else d.localAvatarUrl="img/gamecircle/img-200x200.png"}f=Template.tmpl("Menu",d);var h=applicationContext.getObject("StringLocalizationWrapper");f.find(".agc-string").each(function(){var r=
$(this).data("string");r!==undefined&&$(this).html(h.getString(r)+$(this).html())});d=f.find("#totalTimePlayed");var g=f.find("#leaderboardRank"),j=f.find("#achievementCount"),l=f.find(".profile-alias"),k=f.find("#menuProfileImage"),m=f.find("#menuProfileImage-blank"),n=applicationContext.getObject("ApplicationName");n!==undefined&&n!==null&&n!==""&&f.find("#agc-game-title").html(n);f.find(".agc-link").each(function(){var r=$(this).data("link");if(r!==undefined&&r!==null){var t=r.split(":");if(t!==
undefined&&t.length===2){r="tap."+t[0]+":"+t[1];$(this).unbind(r).bind(r,function(){a($(this).attr("id"));if(t[0]==="OverlayController"){var o=t[1];$.when(applicationContext.getObject("PageController").hideMenu()).then(function(){applicationContext.getObject("OverlayController")[o]()})}else{var v=applicationContext.getObject(t[0]);v&&v[t[1]]()}})}}});k.load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});$("#logoutButton").live("click",function(){l!==undefined&&
l.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_headline_you_are_a_guest_2"));$(".menu-section .metadata").hide();m.show();k.hide()});if(c){if(l!==undefined)if(c.isGuest||!c.profile)l.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_headline_you_are_a_guest_2"));else c.profile.hidden?l.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_profile_is_hidden_2")):l.html(c.profile.alias);
var s=c.achievements;var q=n=0;if(s!==undefined){n=s.length;$.each(s,function(r,t){t.progress===100&&q++})}s=c.leaderboards;s.sort(function(r,t){if(r===undefined||r===null||r.LEADERBOARD_POSITION===undefined||r.LEADERBOARD_POSITION===null)return-1;if(t===undefined||t===null||t.LEADERBOARD_POSITION===undefined||t.LEADERBOARD_POSITION===null)return-1;var o=0;if(r.LEADERBOARD_POSITION<t.LEADERBOARD_POSITION)o=-1;else if(r.LEADERBOARD_POSITION>t.LEADERBOARD_POSITION)o=1;return o});var u=false,p=101;s!==
undefined&&$.each(s,function(r,t){if(p>t.LEADERBOARD_PERCENTILE_RANK&&t.LEADERBOARD_PERCENTILE_RANK>-1){u=true;p=t.LEADERBOARD_PERCENTILE_RANK}});if(p<0)u=false;j.html(q+"/"+n);u?g.html(p+"%"):g.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked"));j=c.totalTimePlayed;if(d!==undefined&&d!==null){c="";if(j!==undefined&&j!==null&&!isNaN(j)){g=Math.floor(j/1E3/3600);j=Math.floor((j-g*3600*1E3)/1E3/60);c=g>0?applicationContext.getObject("StringLocalizationWrapper").getString("menu_data_time_played_hours_minimal",
{number:g})+" ":"";if(j>0)c+=applicationContext.getObject("StringLocalizationWrapper").getString("menu_data_time_played_minutes_minimal",{number:j});else if(g===undefined||g===null||g===0)c=""}d.html(c)}}d=k.position().left-k.outerWidth()-parseInt(k.css("border-left-width"),10);l.css("max-width",d+"px");e.empty();e.append(f);ScrollHelper.scrollify(Page.Menu);return b};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
NavigationWidgetView=function(){return function(e){function a(c,b){var d=new GameCircleEvent("ObjectClicked");d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,c);d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,b);return d}var f="";this.render=function(c,b){var d=b.pageLoaded;if(d===undefined||d===null)d="UNSPECIFIED";f=Template.tmpl("Navigation",{});f.find("#title").html(applicationContext.getObject("ApplicationName"));f.find("#agc-menu-button").unbind("tap.agcmenubutton").bind("tap.agcmenubutton",
function(){var h=applicationContext.getObject("PageController"),g;if(h.isMenuDisplayed()===true){g=a("menuClickClose",PageId.Menu);g.startTime("MenuClickClose");h.hideMenu();g.endTime("MenuClickClose")}else{g=a("menuClickOpen",d);g.startTime("MenuClickOpen");h.showMenu(d);g.endTime("MenuClickOpen")}g.close()});f.find("#agc-close-button").unbind("tap.agcclosebutton").bind("tap.agcclosebutton",function(){a("closeButton",d);hostinterface.closeOverlay()});e.empty();e.append(f)};this.isInsideViewport=
function(){return Utility.isElementInsideViewport(e)}}}();OverlayView=function(){return function(e){var a=null;this.render=function(){a=Template.tmpl("Skeleton");e.empty();e.append(a)}}}();ProfilePageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("ProfilePage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.Profile)}}}();
ProfileWidgetView=function(){return function(e){var a="";this.refreshImage=function(f,c){ImageUtility.refreshImage(f,c)};this.render=function(f,c,b,d){var h={imageData:{}};console.log("ProfileWidgetView data: "+JSON.stringify(f));var g={};if(c!==LifecyclePhases.AUTH_PHASE)g.showStatus=true;if(b){g.showError=true;g.errorMessage=b}if(d){g.showWarning=true;g.warningMessage=d}if(f)if(f.isGuest)g.localAvatarUrl="img/gamecircle/img-page-hero-guest.png";else if(f.localAvatarUrl){g.localAvatarUrl=f.localAvatarUrl;
if(f.avatarUrl)h.imageData.images=[{imageId:"pageHeroImage",imageUrl:f.avatarUrl}];else console.error("ProfileWidgetView: missing avatar url")}else g.localAvatarUrl="img/gamecircle/img-200x200.png";console.log("ProfileWidgetView localAvatarUrl: "+g.localAvatarUrl+" imageCache: "+JSON.stringify(h));a=Template.tmpl("Profile",g);e.empty();e.append(a);ScrollHelper.scrollify(Page.Profile);c=a.find("#editbutton");if(c!==undefined){c.html(applicationContext.getObject("StringLocalizationWrapper").getString("toast_welcome_first_time_button_edit"));
f&&(f.profile&&f.profile.hidden||f.isGuest)?c.css("display","none"):c.unbind("tap.menuEditProfileLink").bind("tap.menuEditProfileLink",function(){hostinterface.logMessage("ProfileWidgetView: edit button clicked");applicationContext.getObject("OverlayController").showEditProfile();var m=new GameCircleEvent("ObjectClicked");m.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"editButton");m.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,
PageId.Profile);m.close()})}c=a.find("#aboutHiddenProfilesHeader");b=a.find("#aboutHiddenProfiles");d=a.find("#editSettingsButton");g=a.find("#pageHeroImage");c.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_hidden_headline"));b.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_hidden_text"));d.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_hidden_edit_settings"));g.load(function(){$("#"+
$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});g=a.find("#loginButton");if(f){var j=a.find("#profileAlias"),l=a.find("#extraInfo"),k=a.find("#youAreField");if(f.isGuest||!f.profile){if(g!==undefined){g.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_signin_button"));f.isKindle?g.attr("style","display:none"):g.attr("style","display:")}if(k!==undefined&&j!==undefined&&l!==undefined){k.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_guest_you_are_a_guest_1"));
j.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_guest_you_are_a_guest_2"));l.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_signin_text"))}}else{g!==undefined&&g.attr("style","display:none");if(k!==undefined&&j!==undefined&&l!==undefined){k.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_you_are"));if(f.profile.hidden){j.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_profile_is_hidden_2"));
c.attr("style","display:");b.attr("style","display:");d.attr("style","display:");d.unbind("tap.profileSettingsButton").bind("tap.profileSettingsButton",function(){applicationContext.getObject("OverlayController").showSettings()})}else j.html(f.profile.alias);f.timePlayed&&f.timePlayed.lastTimePlayed&&l.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_last_played_date",{date:moment(f.timePlayed.lastTimePlayed).format("LL")}))}}}g.unbind("tap.loginButton").bind("tap.loginButton",
function(){var m=ServiceFactory.getRequestFactory().createLoginRequest();ServiceFactory.getRequestRouter().handleRequest(m);m=new GameCircleEvent("ObjectClicked");m.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"loginButton");m.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Profile);m.close()});return h};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
RanksNavigationWidgetView=function(){return function(e){function a(c,b){var d=new GameCircleEvent("ObjectClicked");d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,c);d.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,b);d.close()}var f="";this.render=function(){f=Template.tmpl("RanksNavigation",{});f.find("#title").html(applicationContext.getObject("ApplicationName"));e.empty();e.append(f);var c=f.find("#backbutton"),b=f.find("#closebutton");
c.unbind("tap.menuButton").bind("tap.menuButton",function(){a("backButton",PageId.LeaderboardRanks);applicationContext.getObject("OverlayController").showLeaderboards()});b.unbind("tap.closeButton").bind("tap.closeButton",function(){a("closeButton",PageId.LeaderboardRanks);hostinterface.closeOverlay()})};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();
SettingsPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("SettingsPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.Settings)}}}();
SettingsWidgetView=function(){return function(e){var a="";this.render=function(f,c,b,d){var h={};if(c!==LifecyclePhases.AUTH_PHASE)h.showStatus=true;if(b){h.showError=true;h.errorMessage=b}if(d){h.showWarning=true;h.warningMessage=d}a=Template.tmpl("Settings",h);d=a.find("#versionInfo");var g=a.find("#showProfileButton"),j=a.find("#hideProfileButton"),l=a.find("#turnOnWSButton"),k=a.find("#turnOffWSButton");c=a.find("#logoutButton");b=a.find("#loginButton");a.find("#signOutAllGames");var m=a.find("#loginContainer"),
n=a.find("#logoutContainer"),s=a.find("#profileHiddenContainer"),q=a.find("#whispersyncEnabledContainer");h=a.find("#settingsHeader");var u=a.find("#profileHeader"),p=a.find("#profileInfo"),r=a.find("#gameSettingsHeader"),t=a.find("#wsHeader"),o=a.find("#wsInfo"),v=a.find("#loginHeader"),w=a.find("#loginInfo"),z=a.find("#logoutHeader"),B=a.find("#logoutInfo"),y=a.find("#versionHeader"),x=a.find("#legalInformation");h.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_subheadline_gamecircle_settings"));
u.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_profile_headline"));p.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_profile_desc"));r.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_subheadline_game_settings"));t.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_whispersync_headline"));o.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_whispersync_desc"));
v.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signin_headline"));w.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signin_desc"));z.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signout_headline"));B.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signout_desc"));y.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_version_headline"));
x.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_link_legal_information"));c.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signout_button_signout"));b.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_signin_button_signin"));x.unbind("tap.legalInformation").bind("tap.legalInformation",function(){BrowserUtility.launchLegalInformation()});applicationContext.getObject("DOMUtility").convertSpanToAnchor("learnmore_link",
a,function(){BrowserUtility.launchRevokeAuthToken()});h=applicationContext.getObject("GameCircleVersionString");u=applicationContext.getObject("ClientVersionString");p=applicationContext.getObject("ContentVersionString");if(d){r="";if(h)r+="GameCircle "+h;r+=" (";if(u)r+="Client "+u+", ";if(u)r+="Content "+p;r+=")";d.text(r)}d=!f||f.isKindle;if(!f||f.isGuest){d?m.css("display","none"):m.css("display","");n.css("display","none");s.css("display","none");q.css("display","none")}else{m.css("display",
"none");n.css("display","")}var A=f&&f.whispersyncEnabled,D=function(){if(A){l.attr("class","btn btn-small active");l.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_whispersync_button_on"));k.attr("class","btn btn-small")}else{l.attr("class","btn btn-small");l.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_whispersync_button_on"));k.attr("class","btn btn-small active")}k.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_whispersync_button_off"))};
D();var E=f&&f.profile&&f.profile.hidden,F=function(){if(E){j.attr("class","btn btn-small active");j.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_profile_button_hide"));g.attr("class","btn btn-small")}else{j.attr("class","btn btn-small");j.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_profile_button_hide"));g.attr("class","btn btn-small active")}g.html(applicationContext.getObject("StringLocalizationWrapper").getString("settingspage_profile_button_show"))};
F();c.unbind("tap.logoutButton").bind("tap.logoutButton",function(){var C=new GameCircleEvent("ObjectClicked");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"logout");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Settings);C.close();C=ServiceFactory.getRequestFactory().createLogoutRequest();ServiceFactory.getRequestRouter().handleRequest(C).always(function(){ServiceFactory.getGCSettings().getGuestMode().always(function(G){if(G){m.css("display",
"");n.css("display","none");s.css("display","none");q.css("display","none");ScrollHelper.refreshScrollBounds(Page.Settings)}else console.error("TODO: Display logout failed message")})})});b.unbind("tap.loginButton").bind("tap.loginButton",function(){var C=new GameCircleEvent("ObjectClicked");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"loginButton");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Settings);C.close();C=
ServiceFactory.getRequestFactory().createLoginRequest();ServiceFactory.getRequestRouter().handleRequest(C)});f=function(){A=!A;ServiceFactory.getGCSettings().setWhispersyncEnabledUserSetting(A).always(function(){console.log("WhispersyncEnabled is "+A);var C=new GameCircleEvent("ObjectClicked");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"toggleWhispersync");C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Settings);C.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,
A);C.close();D()})};l.unbind("tap.turnOnWSButton").bind("tap.turnOnWSButton",f);k.unbind("tap.turnOffWSButton").bind("tap.turnOffWSButton",f);f=function(){E=!E;var C=ServiceFactory.getRequestFactory().createUpdateProfileHiddenRequest(E);ServiceFactory.getRequestRouter().handleRequest(C).always(function(){console.log("ProfileHidden is "+E);F()})};g.unbind("tap.showProfileButton").bind("tap.showProfileButton",f);j.unbind("tap.hideProfileButton").bind("tap.hideProfileButton",f);e.empty();e.append(a);
ScrollHelper.scrollify(Page.Settings)};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();SummaryPageView=function(){return function(e){var a;this.render=function(){a=Template.tmpl("SummaryPage");e.append(a);this.updateScreenSize()};this.updateScreenSize=function(){applicationContext.needsScreenResize()&&applicationContext.doScreenResize();applicationContext.needsScrollBoundaryRefresh()&&ScrollHelper.refreshScrollBounds(Page.Summary)}}}();
SummaryWidgetView=function(){return function(e){var a="";this.refreshImage=function(f,c){ImageUtility.refreshImage(f,c)};this.render=function(f,c,b,d,h){c={imageData:{}};var g={};a=Template.tmpl("Summary",g);if(b!==LifecyclePhases.AUTH_PHASE)g.showStatus=true;if(d){g.showError=true;g.errorMessage=d}if(h){g.showWarning=true;g.warningMessage=h}if(f){if(f.isGuest)g.localAvatarUrl="img/gamecircle/img-page-hero-guest.png";else if(f.localAvatarUrl){g.localAvatarUrl=f.localAvatarUrl;if(f.avatarUrl)c.imageData.images=
[{imageId:"pageHeroImage",imageUrl:f.avatarUrl}];else console.error("SummaryWidgetView: missing avatar url")}else g.localAvatarUrl="img/gamecircle/img-200x200.png";f.achievements.length===0&&a.find("#achievementsEntry").hide();f.leaderboards.length===0&&a.find("#leaderboardsEntry").hide();f.totalTimePlayed<6E4&&a.find("#timePlayedEntry").hide()}e.empty();b=a.find("#achievementsEntry");d=a.find("#leaderboardsEntry");a.find("#timePlayedEntry");h=a.find("#totalTimePlayed");a.find("#leaderboardEntryIcon");
var j=a.find("#leaderboardEntryName"),l=a.find("#achievementsEntryTotal"),k=a.find("#editbutton");g=a.find("#loginButton");var m=a.find("#youAreField"),n=a.find("#profileAlias"),s=a.find("#extraInfo"),q=a.find("#pageHeroImage"),u=a.find("#time_played_desc"),p=a.find("#achievements_earned_desc"),r=a.find("#leaderboardEntryRank");k.html(applicationContext.getObject("StringLocalizationWrapper").getString("toast_welcome_first_time_button_edit"));u.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_desc"));
p.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_achievements_earned_desc"));r.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_desc"));q.load(function(){$("#"+$(this).attr("id")+"-blank",$(this).parent()).hide();$(this).show()});if(f){if(k!==undefined)f&&(f.profile&&f.profile.hidden||f.isGuest)?k.css("display","none"):k.unbind("tap.editButton").bind("tap.editButton",function(){hostinterface.logMessage("ProfileWidgetView: edit button clicked");
applicationContext.getObject("OverlayController").showEditProfile();var w=new GameCircleEvent("ObjectClicked");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"editButton");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Summary);w.close()});if(f.isGuest||!f.profile){if(g!==undefined){g.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_signin_button"));f.isKindle?g.attr("style","visibility:hidden"):
g.attr("style","visibility:visible")}if(m!==undefined&&n!==undefined&&s!==undefined){m.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_headline_you_are_a_guest_1"));n.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_headline_you_are_a_guest_2"));s.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_signin_desc"))}}else{g!==undefined&&g.attr("style","visibility:hidden");if(m!==undefined&&
n!==undefined&&s!==undefined){m.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_you_are"));f.profile.hidden?n.html(applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_profile_is_hidden_2")):n.html(f.profile.alias);f.lastTimePlayed&&s.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_last_played_date",{date:moment(f.lastTimePlayed).format("LL")}))}}m=f.achievements;var t=k=0;if(m!==undefined){k=m.length;
$.each(m,function(w,z){z.progress===100&&t++})}m=f.leaderboards;m.sort(function(w,z){if(w===undefined||w===null||w.LEADERBOARD_POSITION===undefined||w.LEADERBOARD_POSITION===null)return-1;if(z===undefined||z===null||z.LEADERBOARD_POSITION===undefined||z.LEADERBOARD_POSITION===null)return-1;var B=0;if(w.LEADERBOARD_POSITION<z.LEADERBOARD_POSITION)B=-1;else if(w.LEADERBOARD_POSITION>z.LEADERBOARD_POSITION)B=1;return B});var o=false,v=101;m!==undefined&&$.each(m,function(w,z){if(v>z.LEADERBOARD_PERCENTILE_RANK&&
z.LEADERBOARD_PERCENTILE_RANK>-1){o=true;v=z.LEADERBOARD_PERCENTILE_RANK}});if(v<0)o=false;l.html(t+"/"+k);if(o)j.html(v+"%");else{j.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_leaderboard_rank_unranked"));f.isGuest?r.html(applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_guest_signin_submit_score")):r.html("")}l=f.totalTimePlayed;if(h!==undefined&&h!==null){f="";if(l!==undefined&&l!==null&&!isNaN(l)){j=Math.floor(l/1E3/3600);l=Math.floor((l-
j*3600*1E3)/1E3/60);f=j>0?j>1?applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_hours_plural",{number:j})+" ":applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_hours_singular")+" ":"";f+=l>0?l>1?applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_minutes_plural",{number:l}):applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_minutes_singular"):
j===undefined||j===null||j===0?applicationContext.getObject("StringLocalizationWrapper").getString("gamepage_time_played_minutes_null"):""}h.html(f)}g.unbind("tap.loginButton").bind("tap.loginButton",function(){if(applicationContext.getObject("PageController").isMenuDisplayed()===false){var w=new GameCircleEvent("ObjectClicked");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"loginButton");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,
PageId.Summary);w.close();w=ServiceFactory.getRequestFactory().createLoginRequest();ServiceFactory.getRequestRouter().handleRequest(w)}})}b!==undefined&&b.unbind("tap.menuAchievementsLink").bind("tap.menuAchievementsLink",function(){if(applicationContext.getObject("PageController").isMenuDisplayed()===false){var w=new GameCircleEvent("ObjectClicked");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"menuAchievementsLink");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,
PageId.Summary);w.close();applicationContext.getObject("OverlayController").showAchievements()}});d!==undefined&&d.unbind("tap.menuLeaderboardsLink").bind("tap.menuLeaderboardsLink",function(){if(applicationContext.getObject("PageController").isMenuDisplayed()===false){var w=new GameCircleEvent("ObjectClicked");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,"menuLeaderboardsLink");w.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,
PageId.Summary);w.close();applicationContext.getObject("OverlayController").showLeaderboards()}});e.append(a);ScrollHelper.scrollify(Page.Summary);return c};this.isInsideViewport=function(){return Utility.isElementInsideViewport(e)}}}();function BaseController(){this.eventHandlers={}}
BaseController.prototype={getName:function(){return"Undefined"},handleEvent:function(e){e.args=e.args||{};e.args.error=e.args.error||null;e.args.target=e.args.target||this;e.args.previousTarget=e.args.currentTarget;e.args.currentTarget=this;var a=true,f=this.eventHandlers[e.name];if(f){a=f.call(this,e.args);if(typeof a==="undefined")a=true}a&&this.bubbleEvent(e)},getNetworkInfo:function(){return NativeTransport.callNative({nativeCall:constants.NativeCallTypes.GET_NETWORK_INFO})},bubbleEvent:function(e){this.parent&&
typeof this.parent.handleEvent==="function"&&this.parent.handleEvent(e)}};
ButtonController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;this.buttonId=c;this.view=f;var d={};this.currentState=this.DEFAULT_STATE="default";this.showDefaultState=function(){this.show();this.currentState=this.DEFAULT_STATE;this.view.showDefaultState();this.view.bindToTap(d[this.DEFAULT_STATE])};this.showState=function(h,g){hostinterface.logMessage("ButtonController: state");this.currentState=h;this.view.render();this.view.showState(h,g);this.view.bindToTap(d[h]);
hostinterface.logMessage("ButtonController: state end")};this.bindToTapInState=function(h,g){var j=function(){g();b.handleEvent({name:Event.ButtonTapped,args:{state:h,buttonId:c}})};d[h]=j;h===this.currentState&&this.view.bindToTap(j)};this.show=function(){this.view.show()};this.hide=function(){this.view.hide()}}Inheritance.inherit(e,BaseController);return e}();
ToggleButtonController=function(){function e(a,f,c){hostinterface.logMessage("ToggleButtonController: constructor");e.parentconstructor.call(this,a,f,c);hostinterface.logMessage("ToggleButtonController: constructor1");f.render();this.TOGGLED="toggled";this.UNTOGGLED="untoggled";hostinterface.logMessage("ToggleButtonController: constructor3");this.bindToTapInState(this.TOGGLED,function(){hostinterface.logMessage("ToggleButtonController: toggled state clicked");applicationContext.getObject("OverlayController").showLeaderboards()});
hostinterface.logMessage("ToggleButtonController: constructor4");this.bindToTapInState(this.UNTOGGLED,function(){hostinterface.logMessage("ToggleButtonController: untoggled state clicked")});hostinterface.logMessage("ToggleButtonController: constructor end")}Inheritance.inherit(e,ButtonController);$.extend(e.prototype,{showToggled:function(){hostinterface.logMessage("ToggleButtonController: showToggled");this.showState(this.TOGGLED);hostinterface.logMessage("ToggleButtonController: showToggled end")},
showUntoggled:function(){hostinterface.logMessage("ToggleButtonController: showUntoggled");this.showState(this.UNTOGGLED);hostinterface.logMessage("ToggleButtonController: showUntoggled end")}});return e}();
AchievementSignInPromptPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadAchievementSignInPromptPage=function(b){applicationContext.getObject("PageController").showAchievementSignInPrompt(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{achievementsigninpromptwidgettag:{view:"achievementsigninpromptwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",
function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
AchievementSignInPromptWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("AchievementSignInPromptWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
AchievementsPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadAchievementsPage=function(b){applicationContext.getObject("PageController").showAchievements(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.Achievements}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.Achievements}},achievementwidgettag:{view:"achievementwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
AchievementsWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=$.Deferred(),l=true;c.render(undefined,b.requestParams,h);this.load=function(k){var m={},n,s;if(l){if(h===LifecyclePhases.AUTH_PHASE&&k.error)s=k.error}else{n=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",
1)}m.renderResults=c.render(k.achievementArray,b.requestParams,h,s,n);d.handleEvent({name:Event.Loaded});return m};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");
h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=j;j=$.Deferred();d.getNetworkInfo().always(function(r){l=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})}};applicationContext.getObject("AchievementsWidgetDAO").getData(s,true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");
h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,q);q=j;j=$.Deferred();q.resolve()}};applicationContext.getObject("AchievementsWidgetDAO").getData(s,false);break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;
a(k.renderResults.imageData,c,g,n,j);break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return j.promise()}}function a(f,c,b,d,h){if(f.images.length>0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c,b,d,h);else{b.endTime("ImagesLoaded");
b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}Inheritance.inherit(e,BaseController);return e}();
EditProfileNavigationWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=$.Deferred();f.render();this.load=function(g){f.render(g);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=
function(g,j){var l=$.Deferred();switch(j){case LifecyclePhases.CACHE_PHASE:d=LifecyclePhases.CACHE_PHASE;l.resolve(LifecyclePhases.AUTH_PHASE,{});var k=h;h=$.Deferred();k.resolve();break;case LifecyclePhases.AUTH_PHASE:d=LifecyclePhases.AUTH_PHASE;k={requestParams:c.requestParams,successHandler:function(m){b.load(m);l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()},errorHandler:function(){l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve();console.log("ERROR!")}};applicationContext.getObject("EditProfileNavigationWidgetDAO").getData(k);
break;default:l.resolve(LifecyclePhases.NO_PHASE,{})}return l.promise()};this.getFullyLoadedPromise=function(){return h.promise()}}Inheritance.inherit(e,BaseController);return e}();
EditProfilePageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadEditProfilePage=function(b){hostinterface.logMessage("EditProfilePageController: loadEditProfilePage");applicationContext.getObject("PageController").showEditProfile(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.EditProfile}},editprofilenavigationwidgettag:{view:"editprofilenavigationwidgettag",
requestParams:{pageLoaded:PageId.EditProfile}},editprofilewidgettag:{view:"editprofilewidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});hostinterface.logMessage("EditProfilePageController: loadEditProfilePage: lifecycle start");b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)});hostinterface.logMessage("EditProfilePageController: loadEditProfilePage: end")};
this.saveProfile=function(){console.log("Saving profile...");var b=null;$(".img-profile-selected").each(function(){b=$(this).attr("data-avatarId")});var d=null,h=$("#editAlias");if(h)d=h.attr("value");if(b||d){h={};if(d!==undefined&&d!==null&&d.length>0)h.alias=d;if(b!==undefined&&b!==null&&b.length>0)h.avatarId=b;console.log("update profile request: "+JSON.stringify(h));applicationContext.getObject("EditProfileWidgetDAO").updateProfile(h).always(function(g){var j=g&&constants.NativeCallResultCode.SUCCESS===
g.getType();if(j&&g.getResultMap()&&!g.getResultMap().errorCode)applicationContext.getObject("OverlayController").showProfile();else{g=applicationContext.getObject("StringLocalizationWrapper").getString("profilepage_error_name_taken");var l=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");j=j?g:l;if(g=$("#editAliasErrors")){g.html(Utility.htmlEncode(j));g.css("display","block")}else console.error("TODO: display error")}})}else applicationContext.getObject("OverlayController").showProfile()};
this.getAvatarListWidth=function(){var b=applicationContext.getObject("ScreenSize").getScreenWidth();return parseInt((b-20)/96,10)*96}}Inheritance.inherit(e,BaseController);return e}();
EditProfileWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=true,l=$.Deferred();c.render();this.load=function(k){var m,n;if(j){if(h===LifecyclePhases.AUTH_PHASE&&k.error)n=k.error}else{m=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",1)}var s={};s.renderResults=
c.render(k,h,n,m);d.handleEvent({name:Event.Loaded});return s};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,
successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=l;l=$.Deferred();d.getNetworkInfo().always(function(r){j=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})},errorHandler:function(){n.resolve(LifecyclePhases.AUTH_PHASE,{});var q=l;l=$.Deferred();d.getNetworkInfo().always(function(u){j=u!==null&&u[constants.NativeCallKeys.CONNECTED];q.resolve()});console.log("ERROR!")}};applicationContext.getObject("EditProfileWidgetDAO").getData(s,
true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,q);l.resolve()},errorHandler:function(){n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve();console.log("ERROR!")}};applicationContext.getObject("EditProfileWidgetDAO").getData(s);
break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;if(k&&k.renderResults&&k.renderResults.imageData)a(k.renderResults.imageData,c,g,n,l);else{g.endTime("ImagesLoaded");g.endTime("TotalLoadTime");g.close();n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve()}break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return l.promise()}}function a(f,c,b,d,h){if(f&&f.images&&f.images.length>
0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c,b,d,h);else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}
Inheritance.inherit(e,BaseController);return e}();
FTUEAgeVerificationPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUEAgeVerificationPage=function(b){applicationContext.getObject("PageController").showFTUEAgeVerification(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftueageverificationwidgettag:{view:"ftueageverificationwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});
b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUEAgeVerificationWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:d=LifecyclePhases.AUTH_PHASE;h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUEAgeVerificationWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
FTUEAgeViolationPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUEAgeViolationPage=function(b){hostinterface.logMessage("loadFTUEAgeViolationPage:"+JSON.stringify(b));applicationContext.getObject("PageController").showFTUEAgeViolation(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftueageviolationwidgettag:{view:"ftueageviolationwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});
b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUEAgeViolationWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUEAgeViolationWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
FTUECORSelectionPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUECORSelectionPage=function(b){applicationContext.getObject("PageController").showFTUECORSelection(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftuecorselectionwidgettag:{view:"ftuecorselectionwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();
var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUECORSelectionWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:d=LifecyclePhases.AUTH_PHASE;h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUECORSelectionWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
FTUECORUnsupportedPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUECORUnsupportedPage=function(b){applicationContext.getObject("PageController").showFTUECORUnsupported(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftuecorunsupportedwidgettag:{view:"ftuecorunsupportedwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();
var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUECORUnsupportedWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUECORUnsupportedWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
FTUELoginPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUELoginPage=function(b){applicationContext.getObject("PageController").showFTUELogin(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftueloginwidgettag:{view:"ftueloginwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,
args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUELoginWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};
this.loadPhase=function(j,l){hostinterface.logMessage("FTUELoginWidgetController: loadPhase");var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){hostinterface.logMessage("FTUELoginWidgetController: successHandler");
b.load(n);h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUELoginWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}hostinterface.logMessage("FTUELoginWidgetController: loadPhase ended");return k.promise()};this.getFullyLoadedPromise=
function(){return g.promise()}}Inheritance.inherit(e,BaseController);return e}();
FTUETOSPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadFTUETOSPage=function(b){applicationContext.getObject("PageController").showFTUETOS(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{ftuetoswidgettag:{view:"ftuetoswidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,
args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
FTUETOSWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};
this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("FTUETOSWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);return e}();
LeaderboardSignInPromptPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadLeaderboardSignInPromptPage=function(b){applicationContext.getObject("PageController").showLeaderboardSignInPrompt(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{leaderboardsigninpromptwidgettag:{view:"leaderboardsigninpromptwidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",
function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
LeaderboardSignInPromptWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);
h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("LeaderboardSignInPromptWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);
return e}();
LeaderboardsPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadLeaderboardsPage=function(b){applicationContext.getObject("PageController").showLeaderboards(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.Leaderboards}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.Leaderboards}},leaderboardswidgettag:{view:"leaderboardswidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
LeaderboardsWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=$.Deferred(),l=true;c.render(undefined,b.requestParams,h);this.load=function(k){var m,n;if(l){if(h===LifecyclePhases.AUTH_PHASE&&k.error)n=k.error}else{m=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",
1)}var s={};s.renderResults=c.render(k,b.requestParams,h,n,m);d.handleEvent({name:Event.Loaded});return s};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");
h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=j;j=$.Deferred();d.getNetworkInfo().always(function(r){l=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})}};applicationContext.getObject("LeaderboardsWidgetDAO").getData(s,true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");
h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,q);q=j;j=$.Deferred();q.resolve()}};applicationContext.getObject("LeaderboardsWidgetDAO").getData(s,false);break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;
a(k.renderResults.imageData,c,g,n,j);break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return j.promise()}}function a(f,c,b,d,h){if(f.images.length>0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c,b,d,h);else{b.endTime("ImagesLoaded");
b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}Inheritance.inherit(e,BaseController);return e}();
LeaderboardRanksPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadLeaderboardRanksPage=function(b){applicationContext.getObject("PageController").showLeaderboardRanks(true);f.render(b);b=new Lifecycle({pageController:c,pageSlotData:{ranknavigationwidgettag:{view:"ranknavigationwidgettag"},leaderboardrankswidgettag:{view:"leaderboardrankswidgettag",requestParams:{leaderboardIdToDisplay:b.leaderboardIdToDisplay,dataSet:b.dataSet,dataFilter:b.dataFilter,
pageLoadEventCollector:b.pageLoadEventCollector}}},pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
LeaderboardRanksWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=$.Deferred(),l=true;c.render(undefined,b.requestParams,h);this.load=function(k){var m,n;if(l){if(h===LifecyclePhases.AUTH_PHASE&&k.error)n=k.error}else{m=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",
1)}var s={};s.renderResults=c.render(k,b.requestParams,h,n,m);d.handleEvent({name:Event.Loaded});return s};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");
h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=j;j=$.Deferred();d.getNetworkInfo().always(function(r){l=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})}};applicationContext.getObject("LeaderboardRanksWidgetDAO").getData(s,true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");
h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,q);q=j;j=$.Deferred();q.resolve()}};applicationContext.getObject("LeaderboardRanksWidgetDAO").getData(s,false);break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;
a(k.renderResults.imageData,c,g,n,j);break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return j.promise()}}function a(f,c,b,d,h){if(f.images.length>0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c,b,d,h);else{b.endTime("ImagesLoaded");
b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}Inheritance.inherit(e,BaseController);return e}();
LearnMorePageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadLearnMorePage=function(b){applicationContext.getObject("PageController").showLearnMore(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.LearnMore}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.LearnMore}},learnmorewidgettag:{view:"learnmorewidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
LearnMoreWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=$.Deferred();f.render();this.load=function(j){f.render(j);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};
this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;k.resolve(LifecyclePhases.AUTH_PHASE,{});var m=g;g=$.Deferred();m.resolve();break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;m={requestParams:c.requestParams,successHandler:function(n){b.load(n);h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");
h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("LearnMoreWidgetDAO").getData(m);break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}Inheritance.inherit(e,BaseController);return e}();
MenuWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=$.Deferred();c.render(e.lastMenuValues,b.requestParams);this.load=function(j){var l={};l.renderResults=c.render(j,b.requestParams,h);d.handleEvent({name:Event.Loaded});return l};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===
LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(j,l){var k=$.Deferred();switch(l){case LifecyclePhases.CACHE_PHASE:h=LifecyclePhases.CACHE_PHASE;var m={requestParams:b.requestParams,successHandler:function(n){var s=false;if(n===undefined||n===null||n.error)s=true;else e.lastSummaryValues=n;d.load(n);k.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:s});var q=g;g=$.Deferred();d.getNetworkInfo().always(function(u){isConnected=u!==null&&u[constants.NativeCallKeys.CONNECTED];
q.resolve()})},errorHandler:function(){k.resolve(LifecyclePhases.AUTH_PHASE,{});console.log("ERROR!");var n=g;g=$.Deferred();d.getNetworkInfo().always(function(s){isConnected=s!==null&&s[constants.NativeCallKeys.CONNECTED];n.resolve()})}};applicationContext.getObject("SummaryWidgetDAO").getData(m,true);break;case LifecyclePhases.AUTH_PHASE:h=LifecyclePhases.AUTH_PHASE;m={requestParams:b.requestParams,successHandler:function(n){if(n!==undefined||n!==null||!n.error)e.lastSummaryValues=n;n=d.load(n);
k.resolve(LifecyclePhases.IMAGE_PHASE,n);g.resolve()},errorHandler:function(){k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve();console.log("ERROR!")}};applicationContext.getObject("SummaryWidgetDAO").getData(m,false);break;case LifecyclePhases.IMAGE_PHASE:h=LifecyclePhases.IMAGE_PHASE;if(j&&j.renderResults&&j.renderResults.imageData&&j.renderResults.imageData.images){imageData=j.renderResults.imageData;console.log("MenuWidgetController: caching "+imageData.images.length+" images.");a(imageData,
c,k,g)}else{console.error("MenuWidgetController: No images to cache in IMAGE_PHASE");k.resolve(LifecyclePhases.NO_PHASE,{});g.resolve()}break;default:k.resolve(LifecyclePhases.NO_PHASE,{})}return k.promise()};this.getFullyLoadedPromise=function(){return g.promise()}}function a(f,c,b,d){if(f&&f.images&&f.images.length>0){var h=f.images.splice(0,2),g={};g.imageData={images:h};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:g}).always(function(){$.each(h,function(j,
l){c.refreshImage(l.imageId,l.imageUrl)});if(f.images.length>0)a(f,c);else{b.resolve(LifecyclePhases.NO_PHASE,{});d.resolve()}})}else{b.resolve(LifecyclePhases.NO_PHASE,{});d.resolve()}}Inheritance.inherit(e,BaseController);return e}();
NavigationWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=$.Deferred();f.render(undefined,c.requestParams);this.load=function(g){f.render(g,c.requestParams);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};
this.loadPhase=function(g,j){var l=$.Deferred();switch(j){case LifecyclePhases.CACHE_PHASE:d=LifecyclePhases.CACHE_PHASE;l.resolve(LifecyclePhases.AUTH_PHASE,{});var k=h;h=$.Deferred();k.resolve();break;case LifecyclePhases.AUTH_PHASE:d=LifecyclePhases.AUTH_PHASE;k={requestParams:c.requestParams,successHandler:function(m){b.load(m);l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()},errorHandler:function(){l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve();console.log("ERROR!")}};applicationContext.getObject("NavigationWidgetDAO").getData(k);
break;default:l.resolve(LifecyclePhases.NO_PHASE,{})}return l.promise()};this.getFullyLoadedPromise=function(){return h.promise()}}Inheritance.inherit(e,BaseController);return e}();NoOpController=function(){function e(){}Inheritance.inherit(e,BaseController);$.extend(e.prototype,{update:function(){}});return e}();
OverlayController=function(){function e(a){e.parentconstructor.call(this);a.render();var f,c,b,d,h,g,j,l,k,m,n,s,q,u,p,r,t;this.eventHandlers[Event.AjaxResponseReceived]=function(){};this.eventHandlers[Event.InitialPageReady]=function(){t&&t.resolve()};this.init=function(o){function v(){var z=$("body");z.removeClass(ScreenOrientation.PORTRAIT).removeClass(ScreenOrientation.LANDSCAPE);z.addClass(ScreenOrientation.getCurrentOrientation());applicationContext.needsScreenResize(true)}hostinterface.logMessage("OverlayController: init called");
var w=applicationContext.getObject("ScreenSize");w.adjust({width:parseInt($.url.param("w"),10),height:parseInt($.url.param("h"),10)});v();w.bindToOrientationChange(v,"overlayControllerAddOrientationClass");f=applicationContext.getObject("AchievementsPageController");c=applicationContext.getObject("LeaderboardsPageController");b=applicationContext.getObject("LeaderboardRanksPageController");d=applicationContext.getObject("ProfilePageController");h=applicationContext.getObject("EditProfilePageController");
g=applicationContext.getObject("SettingsPageController");j=applicationContext.getObject("LearnMorePageController");l=applicationContext.getObject("SummaryPageController");k=applicationContext.getObject("FTUELoginPageController");m=applicationContext.getObject("FTUECORSelectionPageController");n=applicationContext.getObject("FTUECORUnsupportedPageController");s=applicationContext.getObject("FTUETOSPageController");q=applicationContext.getObject("FTUEAgeVerificationPageController");u=applicationContext.getObject("FTUEAgeViolationPageController");
p=applicationContext.getObject("AchievementSignInPromptPageController");r=applicationContext.getObject("LeaderboardSignInPromptPageController");hostinterface.logMessage("OverlayController: init: determining which page to show...");if(o!==undefined&&o.initialPage!==undefined){hostinterface.logMessage("OverlayController: init:   well, at least there is data to go on");switch(o.initialPage){case Page.Summary:hostinterface.logMessage("OverlayController: init:   summary page selected");this.showSummary();
break;case Page.Profile:hostinterface.logMessage("OverlayController: init:   profile page selected");this.showProfile();break;case Page.EditProfile:hostinterface.logMessage("OverlayController: init:   edit profile page selected");this.showEditProfile();break;case Page.Achievements:hostinterface.logMessage("OverlayController: init:   achievements page selected");this.showAchievements();break;case Page.Leaderboards:hostinterface.logMessage("OverlayController: init:   leaderboards page selected");this.showLeaderboards();
break;case Page.LeaderboardRanks:hostinterface.logMessage("OverlayController: init:   leaderboard ranks page selected");this.showLeaderboardRanks(o);break;case Page.Settings:hostinterface.logMessage("OverlayController: init:   settings page selected");this.showSettings();break;case Page.LearnMore:hostinterface.logMessage("OverlayController: init:   learnmore page selected");this.showLearnMore();break;case Page.FTUELogin:hostinterface.logMessage("OverlayController: init:   FTUE Login page selected");
this.showFTUELogin();break;case Page.FTUETOS:hostinterface.logMessage("OverlayController: init:   FTUE TOS page selected");this.showFTUETOS();break;case Page.FTUECORSelection:hostinterface.logMessage("OverlayController: init:   FTUE COR page selected");this.showFTUECORSelection();break;case Page.FTUECORUnsupported:hostinterface.logMessage("OverlayController: init:   FTUE COR unsupported page selected");this.showFTUECORUnsupported();break;case Page.FTUEAgeVerification:hostinterface.logMessage("OverlayController: init:   FTUE age verification page selected");
this.showFTUEAgeVerification();break;case Page.FTUEAgeViolation:hostinterface.logMessage("OverlayController: init:   FTUE age violation page selected");this.showFTUEAgeViolation();break;case Page.AchievementSignInPrompt:hostinterface.logMessage("OverlayController: init:   Achievement Sign In Prompt page selected");this.showAchievementSignInPrompt();break;case Page.LeaderboardSignInPrompt:hostinterface.logMessage("OverlayController: init:   Leaderboard Sign In Prompt page selected");this.showLeaderboardSignInPrompt();
break;default:hostinterface.logMessage("OverlayController: init:   No suitable page found.  Defaulting to summary");this.showSummary()}}else{hostinterface.logMessage("OverlayController: init:   No input data...defaulting to summary instead");this.showSummary()}};this.showFTUELogin=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUELogin);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,
constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;k.loadFTUELoginPage(o);return t.promise()};this.showFTUETOS=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUETOS);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");
o.pageLoadEventCollector=v;s.loadFTUETOSPage(o);return t.promise()};this.showFTUECORSelection=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUECORSelection);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;m.loadFTUECORSelectionPage(o);
return t.promise()};this.showFTUECORUnsupported=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUECORUnsupported);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;n.loadFTUECORUnsupportedPage(o);return t.promise()};this.showFTUEAgeVerification=
function(o){t=$.Deferred();if(o===undefined||o===null)o={};hostinterface.logMessage("OverlayController: init:   age verification page showing");var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUEAgeVerification);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;q.loadFTUEAgeVerificationPage(o);
return t.promise()};this.showFTUEAgeViolation=function(o){t=$.Deferred();hostinterface.logMessage("showFTUEAgeViolation:"+JSON.stringify(o));if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.FTUEAgeViolation);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=
v;u.loadFTUEAgeViolationPage(o);return t.promise()};this.showAchievementSignInPrompt=function(o){t=$.Deferred();hostinterface.logMessage("showAchievementSignInPrompt:"+JSON.stringify(o));if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.AchievementSignInPrompt);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);
v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;p.loadAchievementSignInPromptPage(o);return t.promise()};this.showLeaderboardSignInPrompt=function(o){t=$.Deferred();hostinterface.logMessage("showLeaderboardSignInPrompt:"+JSON.stringify(o));if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.LeaderboardSignInPrompt);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,
constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;r.loadLeaderboardSignInPromptPage(o);return t.promise()};this.showProfile=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Profile);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);
v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;d.loadProfilePage(o);return t.promise()};this.showEditProfile=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.EditProfile);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=
v;h.loadEditProfilePage(o);return t.promise()};this.showSettings=function(o){t=$.Deferred();if(o===undefined||o===null)o={};ServiceFactory.getGCSettings().canLaunchKindleSettings().always(function(v){if(v)NativeTransport.callNative({nativeCall:constants.NativeCallTypes.LAUNCH_KINDLE_SETTINGS,args:{}});else{v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Settings);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,
constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;g.loadSettingsPage(o)}});return t.promise()};this.showLearnMore=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.LearnMore);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");
o.pageLoadEventCollector=v;j.loadLearnMorePage(o);return t.promise()};this.showSummary=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Summary);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;l.loadSummaryPage(o);return t.promise()};
this.showAchievements=function(o){t=$.Deferred();if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Achievements);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;f.loadAchievementsPage(o);return t.promise()};this.showLeaderboards=function(o){t=$.Deferred();
if(o===undefined||o===null)o={};var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.Leaderboards);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;c.loadLeaderboardsPage(o);return t.promise()};this.showLeaderboardRanks=function(o){t=$.Deferred();if(o===undefined||o===null)o={};hostinterface.logMessage("OverlayController: init:   leaderboard ranks page showing");
var v=new GameCircleEvent("PageView");v.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,PageId.LeaderboardRanks);v.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_IN_GAME);v.startTime("TotalLoadTime");o.pageLoadEventCollector=v;b.loadLeaderboardRanksPage(o);hostinterface.logMessage("OverlayController: init:   leaderboard ranks page end");return t.promise()}}Inheritance.inherit(e,BaseController);
return e}();
PageController=function(){function e(){var c=parseInt($("#agc-menu-button").parent().css("padding-left"),10);return $("#agc-main").width()-$("#agc-menu-button").outerWidth()-c*2}this.SUMMARY=Page.Summary;this.PROFILE=Page.Profile;this.EDIT_PROFILE=Page.EditProfile;this.ACHIEVEMENTS=Page.Achievements;this.LEADERBOARDS=Page.Leaderboards;this.LEADERBOARD_RANKS=Page.LeaderboardRanks;this.SETTINGS=Page.Settings;this.LEARN_MORE=Page.LearnMore;this.FTUE_LOGIN=Page.FTUELogin;this.FTUE_COR_SELECTION=Page.FTUECORSelection;
this.FTUE_TOS=Page.FTUETOS;this.FTUE_COR_UNSUPPORTED=Page.FTUECORUnsupported;this.FTUE_AGE_VERIFICATION=Page.FTUEAgeVerification;this.FTUE_AGE_VIOLATION=Page.FTUEAgeViolation;this.ACHIEVEMENT_SIGN_IN_PROMPT=Page.AchievementSignInPrompt;this.LEADERBOARD_SIGN_IN_PROMPT=Page.LeaderboardSignInPrompt;var a;parseFloat($("#activearea").css("-webkit-transition-duration"),10);this.getCurrentPage=function(){return a};this.getCurrentPageView=function(){var c;if(a===this.ACHIEVEMENTS)c=applicationContext.getObject("AchievementsPageView");
else if(a===this.EDIT_PROFILE)c=applicationContext.getObject("EditProfilePageView");else if(a===this.ACHIEVEMENT_SIGN_IN_PROMPT)c=applicationContext.getObject("AchievementSignInPromptPageView");else if(a===this.LEADERBOARD_SIGN_IN_PROMPT)c=applicationContext.getObject("LeaderboardSignInPromptPageView");else if(a===this.FTUE_AGE_VERIFICATION)c=applicationContext.getObject("FTUEAgeVerificationPageView");else if(a===this.FTUE_AGE_VIOLATION)c=applicationContext.getObject("FTUEAgeViolationPageView");else if(a===
this.FTUE_COR_SELECTION)c=applicationContext.getObject("FTUECORSelectionPageView");else if(a===this.FTUE_COR_UNSUPPORTED)c=applicationContext.getObject("FTUECORUnsupportedPageView");else if(a===this.FTUE_LOGIN)c=applicationContext.getObject("FTUELoginPageView");else if(a===this.FTUE_TOS)c=applicationContext.getObject("FTUETOSPageView");else if(a===this.LEADERBOARD_RANKS)c=applicationContext.getObject("LeaderboardRanksPageView");else if(a===this.LEADERBOARDS)c=applicationContext.getObject("LeaderboardsPageView");
else if(a===this.LEARN_MORE)c=applicationContext.getObject("LearnMorePageView");else if(a===this.PROFILE)c=applicationContext.getObject("ProfilePageView");else if(a===this.SETTINGS)c=applicationContext.getObject("SettingsPageView");else if(a===this.SUMMARY)c=applicationContext.getObject("SummaryPageView");return c};this.leavePreviousPage=function(){switch(this.getCurrentPage()){case this.ACHIEVEMENTS:case this.LEADERBOARDS:case this.SUMMARY:case this.PROFILE:case this.EDIT_PROFILE:case this.LEADERBOARD_RANKS:case this.SETTINGS:case this.LEARN_MORE:case this.FTUE_LOGIN:case this.FTUE_COR_SELECTION:case this.FTUE_TOS:case this.FTUE_COR_UNSUPPORTED:case this.FTUE_AGE_VERIFICATION:case this.FTUE_AGE_VIOLATION:case this.ACHIEVEMENT_SIGN_IN_PROMPT:case this.LEADERBOARD_SIGN_IN_PROMPT:$("body").css("overflow",
"hidden")}$("#ftueloginpage,#ftuecorselectionpage,#ftuetospage,#ftuecorunsupported,#ftueageverificationpage,#ftueageviolationpage,#summarypage,#profilepage,#editprofilepage,#achievementpage,#leaderboardpage,#leaderboardrankspage,#settingspage,#learnmorepage,#achievementsigninpromptpage,#leaderboardsigninpromptpage").empty();$("#ftueloginpage,#ftuecorselectionpage,#ftuetospage,#ftuecorunsupported,#ftueageverificationpage,#ftueageviolationpage,#summarypage,#profilepage,#editprofilepage,#achievementpage,#leaderboardpage,#leaderboardrankspage,#settingspage,#learnmorepage,#achievementsigninpromptpage,#leaderboardsigninpromptpage").hide()};
var f=false;this.showMenu=function(){$("#agc-menu").show();$("#agc-main").stop().animate({left:e()+"px"},{duration:400,easing:"linear",queue:false,complete:function(){$("#agc-main").unbind("touchstart.agcmain").one("touchstart.agcmain",function(){$("#agc-main").stop().animate({left:"0"},{duration:400,easing:"linear",queue:false,complete:function(){ScrollHelper.enable(true);f=false;$("#agc-menu").hide()}})});ScrollHelper.enable(false);f=true}})};this.hideMenu=function(){$("#agc-main").stop().animate({left:"0"},
{duration:400,easing:"linear",queue:false,complete:function(){ScrollHelper.enable(true);f=false;$("#agc-menu").hide()}})};this.isMenuDisplayed=function(){return f};this.showFTUELogin=function(c){c!==false&&this.leavePreviousPage();$("#ftueloginpage").show();a=this.FTUE_LOGIN};this.isFTUELoginShown=function(){return a===this.FTUE_LOGIN};this.showFTUECORSelection=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#ftuecorselectionpage").show();a=this.FTUE_COR_SELECTION};
this.isFTUECORSelectionShown=function(){return a===this.FTUE_COR_SELECTION};this.showFTUECORUnsupported=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#ftuecorunsupported").show();a=this.FTUE_COR_UNSUPPORTED};this.isFTUECORUnsupported=function(){return a===this.FTUE_COR_UNSUPPORTED};this.showFTUEAgeVerification=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#ftueageverificationpage").show();a=this.FTUE_AGE_VERIFICATION};
this.isFTUEAgeVerification=function(){return a===this.FTUE_AGE_VERIFICATION};this.showFTUEAgeViolation=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#ftueageviolationpage").show();a=this.FTUE_AGE_VIOLATION};this.isFTUEAgeViolation=function(){return a===this.FTUE_AGE_VIOLATION};this.showAchievementSignInPrompt=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#achievementsigninpromptpage").show();a=this.ACHIEVEMENT_SIGN_IN_PROMPT};
this.isAchievementSignInPrompt=function(){return a===this.ACHIEVEMENT_SIGN_IN_PROMPT};this.showLeaderboardSignInPrompt=function(c){$("body").css("overflow","visible");c!==false&&this.leavePreviousPage();$("#leaderboardsigninpromptpage").show();a=this.LEADERBOARD_SIGN_IN_PROMPT};this.isLeaderboardSignInPrompt=function(){return a===this.LEADERBOARD_SIGN_IN_PROMPT};this.showFTUETOS=function(c){c!==false&&this.leavePreviousPage();$("#ftuetospage").show();a=this.FTUE_TOS};this.isFTUETOSShown=function(){return a===
this.FTUE_TOS};this.showProfile=function(c){c!==false&&this.leavePreviousPage();$("#profilepage").show();a=this.PROFILE};this.isProfileShown=function(){return a===this.PROFILE};this.showEditProfile=function(c){c!==false&&this.leavePreviousPage();$("#editprofilepage").show();a=this.EDIT_PROFILE};this.isEditProfileShown=function(){return a===this.EDIT_PROFILE};this.showSettings=function(c){c!==false&&this.leavePreviousPage();$("#settingspage").show();a=this.SETTINGS};this.isSettingsShown=function(){return a===
this.SETTINGS};this.showLearnMore=function(c){c!==false&&this.leavePreviousPage();$("#learnmorepage").show();a=this.LEARN_MORE};this.isLearnMoreShown=function(){return a===this.LEARN_MORE};this.showSummary=function(c){c!==false&&this.leavePreviousPage();$("#summarypage").show();a=this.SUMMARY};this.isSummaryShown=function(){return a===this.SUMMARY};this.showAchievements=function(c){c!==false&&this.leavePreviousPage();$("#achievementpage").show();a=this.ACHIEVEMENTS};this.isAchievementsShown=function(){return a===
this.ACHIEVEMENTS};this.showLeaderboards=function(c){c!==false&&this.leavePreviousPage();$("#leaderboardpage").show();a=this.LEADERBOARDS};this.isLeaderboardsShown=function(){return a===this.LEADERBOARDS};this.showLeaderboardRanks=function(c){c!==false&&this.leavePreviousPage();$("#leaderboardrankspage").show();a=this.LEADERBOARD_RANKS};this.isLeaderboardRanksShown=function(){return a===this.LEADERBOARD_RANKS};this.updateScreenSize=function(){var c=(typeof this===PageController?this:applicationContext.getObject("PageController")).getCurrentPageView();
c!==undefined&&c!==null&&c.updateScreenSize();f&&$("#agc-main").css("left",e()+"px");var b=$("#activearea"),d=b.css("-webkit-transition-duration");b.css("-webkit-transition-duration","0");setTimeout(function(){b.css("-webkit-transition-duration",d)},0)}};
ProfilePageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadProfilePage=function(b){applicationContext.getObject("PageController").showProfile(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.Profile}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.Profile}},profilewidgettag:{view:"profilewidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
ProfileWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=true,l=$.Deferred();c.render();this.load=function(k){var m,n;if(j){if(h===LifecyclePhases.AUTH_PHASE&&k.error)n=k.error}else{m=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",1)}var s={};s.renderResults=c.render(k,
h,n,m);d.handleEvent({name:Event.Loaded});return s};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,
successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=l;l=$.Deferred();d.getNetworkInfo().always(function(r){j=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})},errorHandler:function(){n.resolve(LifecyclePhases.AUTH_PHASE,{});var q=l;l=$.Deferred();d.getNetworkInfo().always(function(u){j=u!==null&&u[constants.NativeCallKeys.CONNECTED];q.resolve()});console.log("ERROR!")}};applicationContext.getObject("ProfileWidgetDAO").getData(s,
true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,q);l.resolve()},errorHandler:function(){n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve();console.log("ERROR!")}};applicationContext.getObject("ProfileWidgetDAO").getData(s,
false);break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;if(k&&k.renderResults&&k.renderResults.imageData&&k.renderResults.imageData.images){imageData=k.renderResults.imageData;console.log("ProfileWidgetController: caching "+imageData.images.length+" images.");a(imageData,c,g,n,l)}else{console.error("ProfileWidgetController: No images to cache in IMAGE_PHASE");g.endTime("ImagesLoaded");g.endTime("TotalLoadTime");g.close();
n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve()}break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return l.promise()}}function a(f,c,b,d,h){if(f&&f.images&&f.images.length>0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c,b,d,h);else{b.endTime("ImagesLoaded");
b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}Inheritance.inherit(e,BaseController);return e}();
RanksNavigationWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=$.Deferred();f.render();this.load=function(g){f.render(g);b.handleEvent({name:Event.Loaded})};this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=
function(g,j){var l=$.Deferred();switch(j){case LifecyclePhases.CACHE_PHASE:d=LifecyclePhases.CACHE_PHASE;l.resolve(LifecyclePhases.AUTH_PHASE,{});var k=h;h=$.Deferred();k.resolve();break;case LifecyclePhases.AUTH_PHASE:d=LifecyclePhases.AUTH_PHASE;k={requestParams:c.requestParams,successHandler:function(m){b.load(m);l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()},errorHandler:function(){l.resolve(LifecyclePhases.NO_PHASE,{});h.resolve();console.log("ERROR!")}};applicationContext.getObject("RanksNavigationWidgetDAO").getData(k);
break;default:l.resolve(LifecyclePhases.NO_PHASE,{})}return l.promise()};this.getFullyLoadedPromise=function(){return h.promise()}}Inheritance.inherit(e,BaseController);return e}();
SettingsPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadSettingsPage=function(b){applicationContext.getObject("PageController").showSettings(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.Settings}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.Settings}},settingswidgettag:{view:"settingswidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
SettingsWidgetController=function(){function e(a,f,c){e.parentconstructor.call(this);var b=this;this.parent=a;var d=LifecyclePhases.PRE_PHASE,h=c.requestParams.pageLoadEventCollector;h.startTime("NoDataLoaded");var g=true,j=$.Deferred();f.render();this.load=function(l){var k,m;if(g){if(d===LifecyclePhases.AUTH_PHASE&&l.error)m=l.error}else{k=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");h.addCount("Error_NetworkError",1)}f.render(l,d,m,k);b.handleEvent({name:Event.Loaded})};
this.determinePhase=function(){if(d===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(d===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(d===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(l,k){var m=$.Deferred();switch(k){case LifecyclePhases.CACHE_PHASE:h.endTime("NoDataLoaded");h.startTime("CachedDataLoaded");d=LifecyclePhases.CACHE_PHASE;var n={requestParams:c.requestParams,successHandler:function(s){var q=false;
if(s===undefined||s===null||s.error)q=true;b.load(s);m.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:q});b.getNetworkInfo().always(function(u){g=u!==null&&u[constants.NativeCallKeys.CONNECTED];j.resolve()})},errorHandler:function(){m.resolve(LifecyclePhases.AUTH_PHASE,{});b.getNetworkInfo().always(function(s){g=s!==null&&s[constants.NativeCallKeys.CONNECTED];j.resolve()});console.log("ERROR!")}};applicationContext.getObject("SettingsWidgetDAO").getData(n,true);break;case LifecyclePhases.AUTH_PHASE:h.endTime("CachedDataLoaded");
h.startTime("AuthDataLoaded");d=LifecyclePhases.AUTH_PHASE;n={requestParams:c.requestParams,successHandler:function(s){if(s===undefined||s===null||s.error)l.cacheDataError?h.addCount("Error_NoDataCachedOrAuth",1):h.addCount("Error_CachedDataCantGetAuth",1);b.load(s);h.endTime("AuthDataLoaded");h.startTime("ImagesLoaded");h.endTime("ImagesLoaded");h.endTime("TotalLoadTime");h.close();m.resolve(LifecyclePhases.NO_PHASE,{});j.resolve()},errorHandler:function(){m.resolve(LifecyclePhases.NO_PHASE,{});
j.resolve();console.log("ERROR!")}};applicationContext.getObject("SettingsWidgetDAO").getData(n,false);break;default:m.resolve(LifecyclePhases.NO_PHASE,{})}return m.promise()};this.getFullyLoadedPromise=function(){return j.promise()}}Inheritance.inherit(e,BaseController);return e}();
SummaryPageController=function(){function e(a,f){var c=this;e.parentconstructor.call(this);this.parent=a;this.loadSummaryPage=function(b){applicationContext.getObject("PageController").showSummary(true);f.render();b=new Lifecycle({pageController:c,pageSlotData:{menuwidgettag:{view:"menuwidgettag",requestParams:{pageLoaded:PageId.Summary}},navigationwidgettag:{view:"navigationwidgettag",requestParams:{pageLoaded:PageId.Summary}},summarywidgettag:{view:"summarywidgettag",requestParams:{pageLoadEventCollector:b.pageLoadEventCollector}}},
pageData:{pageId:"",strContext:""}});b.on("widgetsFullyLoaded",function(){f.updateScreenSize()});b.start();var d={name:Event.InitialPageReady,args:{}};waitForRender(function(){c.handleEvent(d)})}}Inheritance.inherit(e,BaseController);return e}();
SummaryWidgetController=function(){function e(f,c,b){e.parentconstructor.call(this);var d=this;this.parent=f;var h=LifecyclePhases.PRE_PHASE,g=b.requestParams.pageLoadEventCollector;g.startTime("NoDataLoaded");var j=true,l=$.Deferred();c.render(e.lastSummaryValues,b.requestParams,h);this.load=function(k){var m,n;if(j){if(h===LifecyclePhases.AUTH_PHASE&&k.error)n=k.error}else{m=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_no_internet");g.addCount("Error_NetworkError",
1)}var s={};s.renderResults=c.render(k,b.requestParams,h,n,m);d.handleEvent({name:Event.Loaded});return s};this.determinePhase=function(){if(h===LifecyclePhases.PRE_PHASE)return LifecyclePhases.CACHE_PHASE;else if(h===LifecyclePhases.CACHE_PHASE)return LifecyclePhases.AUTH_PHASE;else if(h===LifecyclePhases.AUTH_PHASE)return LifecyclePhases.IMAGE_PHASE};this.loadPhase=function(k,m){var n=$.Deferred();switch(m){case LifecyclePhases.CACHE_PHASE:g.endTime("NoDataLoaded");g.startTime("CachedDataLoaded");
h=LifecyclePhases.CACHE_PHASE;var s={requestParams:b.requestParams,successHandler:function(q){var u=false;if(q===undefined||q===null||q.error)u=true;else e.lastSummaryValues=q;d.load(q);n.resolve(LifecyclePhases.AUTH_PHASE,{cacheDataError:u});var p=l;l=$.Deferred();d.getNetworkInfo().always(function(r){j=r!==null&&r[constants.NativeCallKeys.CONNECTED];p.resolve()})},errorHandler:function(){n.resolve(LifecyclePhases.AUTH_PHASE,{});console.log("ERROR!");var q=l;l=$.Deferred();d.getNetworkInfo().always(function(u){j=
u!==null&&u[constants.NativeCallKeys.CONNECTED];q.resolve()})}};applicationContext.getObject("SummaryWidgetDAO").getData(s,true);break;case LifecyclePhases.AUTH_PHASE:g.endTime("CachedDataLoaded");g.startTime("AuthDataLoaded");h=LifecyclePhases.AUTH_PHASE;s={requestParams:b.requestParams,successHandler:function(q){if(q===undefined||q===null||q.error)k.cacheDataError?g.addCount("Error_NoDataCachedOrAuth",1):g.addCount("Error_CachedDataCantGetAuth",1);else e.lastSummaryValues=q;q=d.load(q);n.resolve(LifecyclePhases.IMAGE_PHASE,
q);l.resolve()},errorHandler:function(){n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve();console.log("ERROR!")}};applicationContext.getObject("SummaryWidgetDAO").getData(s,false);break;case LifecyclePhases.IMAGE_PHASE:g.endTime("AuthDataLoaded");g.startTime("ImagesLoaded");h=LifecyclePhases.IMAGE_PHASE;if(k&&k.renderResults&&k.renderResults.imageData&&k.renderResults.imageData.images){imageData=k.renderResults.imageData;console.log("SummaryWidgetController: caching "+imageData.images.length+" images.");
a(imageData,c,g,n,l)}else{console.error("SummaryWidgetController: No images to cache in IMAGE_PHASE");g.endTime("ImagesLoaded");g.endTime("TotalLoadTime");g.close();n.resolve(LifecyclePhases.NO_PHASE,{});l.resolve()}break;default:n.resolve(LifecyclePhases.NO_PHASE,{})}return n.promise()};this.getFullyLoadedPromise=function(){return l.promise()}}function a(f,c,b,d,h){if(f&&f.images&&f.images.length>0){var g=f.images.splice(0,2),j={};j.imageData={images:g};NativeTransport.callNative({nativeCall:constants.NativeCallTypes.DOWNLOAD_IMAGES,
args:j}).always(function(){$.each(g,function(l,k){c.refreshImage(k.imageId,k.imageUrl)});if(f.images.length>0)a(f,c);else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}})}else{b.endTime("ImagesLoaded");b.endTime("TotalLoadTime");b.close();d.resolve(LifecyclePhases.NO_PHASE,{});h.resolve()}}Inheritance.inherit(e,BaseController);return e}();
AchievementSignInPromptWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){a.successHandler([])}};return e}();
AchievementsWidgetDAO=function(){function e(f){this.serviceData=f}var a=function(f){var c=[];if(f instanceof Result)if(f.getType()===constants.NativeCallResultCode.SUCCESS){f=f.getResultMap().achievements.achievements;f!==undefined&&$.each(f,function(b,d){var h={},g=d.achievementMeta,j=d.playerInfo;h.progress=j.progress;var l=g.largeIconUrl,k=g.lockedLargeIconUrl;h.image=h.progress===100?l:k;h.unlockdate=j.unlocked?j.dateUnlocked:0;h.title=g.title;h.desc=g.description;h.hiddenValue=g.hiddenValue;
h.XP=g.pointValue;c.push(h)})}return c};e.prototype={getData:function(f,c){var b=[],d=ServiceFactory.getRequestFactory().createGetAchievementsRequest(constants.NativeCallKeys.SELF_PLAYER_ID,c);ServiceFactory.getRequestRouter().handleRequest(d).always(function(h){b=a(h);var g={achievementArray:b};if(h.getType()!==constants.NativeCallResultCode.SUCCESS)g.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");f.successHandler(g)})}};return e}();
EditProfileNavigationWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("EditProfileNavigationWidgetDAO: getData start");a.successHandler([]);hostinterface.logMessage("EditProfileNavigationWidgetDAO: getData end")}};return e}();
EditProfileWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a,f){hostinterface.logMessage("EditProfileWidgetDAO: getData start: "+f);var c=ServiceFactory.getRequestFactory().createGetProfileRequest(f);c=ServiceFactory.getRequestRouter().handleRequest(c);var b=ServiceFactory.getRequestFactory().createGetAvatarsRequest(f);b=ServiceFactory.getRequestRouter().handleRequest(b);$.when(c,b).always(function(d,h){var g=d.getResultMap(),j=h.getResultMap(),l;console.log("EditProfileWidgetDAO: profile result: "+
JSON.stringify(g));console.log("EditProfileWidgetDAO: avatars result: "+JSON.stringify(j));var k=[];for(l=0;l<j.length;l++)k.push(j[l].avatarUrl);k=applicationContext.getObject("ProfileWidgetDAO").getLocalAvatarUrls(k);for(l=0;l<j.length;l++)j[l].localAvatarUrl=k[j[l].avatarUrl];g={profile:g,avatars:j};if(d.getType()!==constants.NativeCallResultCode.SUCCESS||h.getType()!==constants.NativeCallResultCode.SUCCESS)g.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");
a.successHandler(g)});hostinterface.logMessage("EditProfileWidgetDAO: getData end")},updateProfile:function(a){a=ServiceFactory.getRequestFactory().createUpdateProfileRequest(a);return ServiceFactory.getRequestRouter().handleRequest(a)}};return e}();
FTUEAgeVerificationWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("FTUEAgeVerificationWidgetDAO: start");a.successHandler([]);hostinterface.logMessage("FTUEAgeVerificationWidgetDAO: end")}};return e}();
FTUEAgeViolationWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("FTUEAgeViolationWidgetDAO: start");a.successHandler([]);hostinterface.logMessage("FTUEAgeViolationWidgetDAO: end")}};return e}();
FTUECORSelectionWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){var f=applicationContext.getObject("LanguageCode"),c=applicationContext.getObject("CountryCode");f=ServiceFactory.getRequestFactory().createGetDisplayableCountriesRequest(f,c);ServiceFactory.getRequestRouter().handleRequest(f).always(function(b){var d={};if(b&&b.getResultMap())d.countries=b.getResultMap().countries;else console.log("FTUECORSelectionWidgetDAO: No countries.");a.successHandler(d)})}};
return e}();FTUECORUnsupportedWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){a.successHandler({})}};return e}();FTUELoginWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){a.successHandler([])}};return e}();
FTUETOSWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){var f=[];ServiceFactory.getGCSettings().isKindle().always(function(c){isKindle=false;if(c!==null&&c!==undefined)isKindle=c;f.isKindle=isKindle;a.successHandler(f)})}};return e}();LeaderboardSignInPromptWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){a.successHandler([])}};return e}();
LeaderboardsWidgetDAO=function(){function e(c){this.serviceData=c}var a=function(c){var b=[];c=c.getResultMap().LeaderboardList;c!==undefined&&$.each(c,function(d,h){var g={},j=h.PercentileRank,l=h.PlayerRank,k=h.PlayerScore,m=h.LeaderboardInfo;g.LEADERBOARD_ID=m.LeaderboardId;g.LEADERBOARD_NAME=m.Name;g.LEADERBOARD_DISPLAY_TEXT=m.DisplayText;g.LEADERBOARD_DATA_FORMAT=m.DataFormat;g.LEADERBOARD_ICON_URL=m.IconUrl;g.LEADERBOARD_SORT_ORDER=m.SortOrder;g.LEADERBOARD_POSITION=m.Position;g.LEADERBOARD_PERCENTILE_RANK=
j;g.LEADERBOARD_PLAYER_RANK=l;g.LEADERBOARD_PLAYER_SCORE=k;b.push(g)});return b},f=function(c,b){var d={};$.each(b,function(h,g){d[g.leaderboardId]=g.score});$.each(c,function(h,g){g.LEADERBOARD_PLAYER_SCORE=d[g.LEADERBOARD_ID]});return c};e.prototype={getData:function(c,b){var d=[],h=$.Deferred(),g=false,j=false;ServiceFactory.getGCSettings().getGuestMode().always(function(l){g=l;l=ServiceFactory.getRequestFactory().createGetLeaderboardsForGameRequest("gameId",b);ServiceFactory.getRequestRouter().handleRequest(l).always(function(k){j=
j||k.getType()!==constants.NativeCallResultCode.SUCCESS;d=a(k);if(g){k=ServiceFactory.getRequestFactory().createGetHighestScoreSubmissionsRequest();ServiceFactory.getRequestRouter().handleRequest(k).always(function(m){m&&m.getType()===constants.NativeCallResultCode.SUCCESS&&f(d,m.getResultMap().HighestScoreSubmissions);h.resolve()})}else h.resolve()})});$.when(h).always(function(){var l={};l.leaderboards=d;l.isGuest=g;if(j)l.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");
c.successHandler(l)})}};return e}();
LeaderboardRanksWidgetDAO=function(){function e(d){this.serviceData=d}var a=function(d,h){var g={},j=d.getResultMap().LeaderboardList;j!==undefined&&$.each(j,function(l,k){var m={},n=k.PercentileRank,s=k.PlayerRank,q=k.PlayerScore,u=k.LeaderboardInfo;m.LEADERBOARD_ID=u.LeaderboardId;m.LEADERBOARD_NAME=u.Name;m.LEADERBOARD_DESC=u.MetaData;m.LEADERBOARD_DISPLAY_TEXT=u.DisplayText;m.LEADERBOARD_DATA_FORMAT=u.DataFormat;m.LEADERBOARD_ICON_URL=u.IconUrl;m.LEADERBOARD_PERCENTILE_RANK=n;m.LEADERBOARD_PLAYER_RANK=
s;m.LEADERBOARD_PLAYER_SCORE=q;if(h===m.LEADERBOARD_ID){g=m;return false}});return g},f=function(d,h){var g=[],j=d.getResultMap().LeaderboardInfo,l=d.getResultMap().RankList;if(j!==undefined&&l!==undefined){var k=h;$.each(l,function(m,n){var s=k,q=n.Username,u=n.AvatarUrl,p=n.PlayerId,r={};r.score=n.Score;r.rank=s;r.alias=q;r.avatarUrl=u;r.playerId=p;g.push(r);k++})}return g},c=function(d){var h=[];d=d.getResultMap().PercentileList;d!==undefined&&$.each(d,function(g,j){var l=j.PlayerName,k=j.PlayerScore,
m=j.AvatarUrl,n=j.PlayerId,s={};s.rank=j.Percentile;s.alias=l;s.score=k;s.avatarUrl=m;s.playerId=n;h.push(s)});return h},b=function(d,h){var g={};$.each(h,function(j,l){g[l.leaderboardId]=l.score});d.LEADERBOARD_PLAYER_SCORE=g[d.LEADERBOARD_ID];return d};e.prototype={getData:function(d,h){var g=d.requestParams,j=g.leaderboardIdToDisplay,l=g.dataSet,k=g.dataFilter,m=false;if(l===undefined)l="percentiles";if(k===undefined)k="GLOBAL_ALL_TIME";var n={},s=[],q=$.Deferred(),u=$.Deferred(),p=false;ServiceFactory.getGCSettings().getGuestMode().always(function(o){p=
o;o=ServiceFactory.getRequestFactory().createGetLeaderboardsForGameRequest("gameId",h);ServiceFactory.getRequestRouter().handleRequest(o).always(function(v){m=m||v.getType()!==constants.NativeCallResultCode.SUCCESS;n=a(v,j);if(p){v=ServiceFactory.getRequestFactory().createGetHighestScoreSubmissionsRequest();ServiceFactory.getRequestRouter().handleRequest(v).always(function(w){w&&w.getType()===constants.NativeCallResultCode.SUCCESS&&b(n,w.getResultMap().HighestScoreSubmissions);q.resolve()})}else q.resolve()})});
if(l==="percentiles"){g=ServiceFactory.getRequestFactory().createGetLeaderboardPercentilesRequest(constants.NativeCallKeys.SELF_PLAYER_ID,"gameId",j,k,false,h);ServiceFactory.getRequestRouter().handleRequest(g).always(function(o){m=m||o.getType()!==constants.NativeCallResultCode.SUCCESS;s=c(o);u.resolve()})}else{g=ServiceFactory.getRequestFactory().createGetLeaderboardRanksRequest("gameId",j,k,1,100,false,h);ServiceFactory.getRequestRouter().handleRequest(g).always(function(o){m=m||o.getType()!==
constants.NativeCallResultCode.SUCCESS;s=f(o,1);u.resolve()})}var r={},t=$.Deferred();g=ServiceFactory.getRequestFactory().createGetProfileRequest(h);ServiceFactory.getRequestRouter().handleRequest(g).always(function(o){m=m||o.getType()!==constants.NativeCallResultCode.SUCCESS;r=o.getResultMap();t.resolve()});$.when(q,u,t).always(function(){var o={};o.leaderboardInfo=n;o.detailedList=s;o.profile=r;o.isGuest=p;o.dataSet=l;o.dataFilter=k;if(m)o.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");
d.successHandler(o)})}};return e}();LearnMoreWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("LearnMoreWidgetDAO: start");a.successHandler([]);hostinterface.logMessage("LearnMoreWidgetDAO: end")}};return e}();
MenuWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("MenuWidgetDAO: getData");var f=ServiceFactory.getGCSettings(),c=f.achievementsExist();f=f.leaderboardsExist();$.when(c,f).always(function(b,d){var h={};h.achievementsExist=b==="false"?false:true;h.leaderboardsExist=d==="false"?false:true;hostinterface.logMessage("MenuWidgetDAO: getData end");a.successHandler(h)})}};return e}();
NavigationWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("NavigationWidgetDAO: getData");a.successHandler([]);hostinterface.logMessage("NavigationWidgetDAO: getData end")}};return e}();
ProfileWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a,f){hostinterface.logMessage("ProfileWidgetDAO: getData start: "+f);var c=ServiceFactory.getGCSettings().getGuestMode(),b=$.Deferred();c.always(function(j){if(j)b.resolve(new Result(constants.NativeCallResultCode.ERROR,{}));else{j=ServiceFactory.getRequestFactory().createGetProfileRequest(f);ServiceFactory.getRequestRouter().handleRequest(j).always(function(l){b.resolve(l)})}});var d=ServiceFactory.getGCSettings().isKindle(),
h=ServiceFactory.getRequestFactory().createGetTimePlayedRequest(f);h=ServiceFactory.getRequestRouter().handleRequest(h);var g=this;$.when(c,d,b,h).always(function(j,l,k,m){var n=k.getResultMap(),s="img/gamecircle/img-200x200.png",q;console.log("ProfileWidgetDAO: result: "+JSON.stringify(n)+" "+JSON.stringify(m.getResultMap()));if(n&&n.avatarId){q=n.avatarUrl;s=g.getLocalAvatarUrls([q])[q]}l={isGuest:j,profile:n,isKindle:l,timePlayed:m.getResultMap(),localAvatarUrl:s,avatarUrl:q};if(!j&&k.getType()!==
constants.NativeCallResultCode.SUCCESS||m.getType()!==constants.NativeCallResultCode.SUCCESS)l.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");a.successHandler(l)});hostinterface.logMessage("ProfileWidgetDAO: getData end")},getLocalAvatarUrls:function(a){var f={},c;for(c=0;c<a.length;c++)if(a[c])f[a[c]]=ImageUtility.imageURLToLocalPath(a[c]);return f}};return e}();
RanksNavigationWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a){hostinterface.logMessage("RanksNavigationWidgetDAO: getData start");a.successHandler([]);hostinterface.logMessage("RanksNavigationWidgetDAO: getData end")}};return e}();
SettingsWidgetDAO=function(){function e(a){this.serviceData=a}e.prototype={getData:function(a,f){hostinterface.logMessage("SettingsWidgetDAO: start");var c=false,b=ServiceFactory.getGCSettings().getGuestMode(),d=ServiceFactory.getGCSettings().isKindle(),h=ServiceFactory.getGCSettings().getWhispersyncEnabledUserSetting(),g=$.Deferred();b.always(function(j){if(j)g.resolve({});else{j=ServiceFactory.getRequestFactory().createGetProfileRequest(f);ServiceFactory.getRequestRouter().handleRequest(j).always(function(l){c=
c||l.getType()!==constants.NativeCallResultCode.SUCCESS;g.resolve(l.getResultMap())})}});$.when(b,d,h,g).always(function(j,l,k,m){j={isGuest:j,isKindle:l,whispersyncEnabled:k,profile:m};if(c)j.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");a.successHandler(j)});hostinterface.logMessage("SettingsWidgetDAO: end")}};return e}();
SummaryWidgetDAO=function(){function e(c){this.serviceData=c}e.prototype={getData:function(c,b){hostinterface.logMessage("SummaryWidgetDAO: getData");var d=$.Deferred(),h=$.Deferred(),g=$.Deferred(),j=$.Deferred(),l=$.Deferred(),k=$.Deferred(),m=$.Deferred(),n=false,s=ServiceFactory.getGCSettings(),q=false;s.getGuestMode().always(function(x){q=x;j.resolve()});var u=false;s.isKindle().always(function(x){if(x)u=true;k.resolve()});var p=ServiceFactory.getRequestFactory().createGetLeaderboardsForGameRequest("gameId",
b),r=[];ServiceFactory.getRequestRouter().handleRequest(p).done(function(x){n=n||x.getType()!==constants.NativeCallResultCode.SUCCESS;hostinterface.logMessage("SummaryWidgetDAO: getData: getLeaderboardsRequest came back");r=a(x);d.resolve()}).fail(function(){d.resolve()});p=ServiceFactory.getRequestFactory().createGetAchievementsRequest(constants.NativeCallKeys.SELF_PLAYER_ID,b);var t=[];ServiceFactory.getRequestRouter().handleRequest(p).done(function(x){n=n||x.getType()!==constants.NativeCallResultCode.SUCCESS;
hostinterface.logMessage("SummaryWidgetDAO: getData: getAchievementsRequest came back");t=f(x);h.resolve()}).fail(function(){h.resolve()});var o=0,v=0;p=ServiceFactory.getRequestFactory().createGetTimePlayedRequest();ServiceFactory.getRequestRouter().handleRequest(p).done(function(x){x=x.getResultMap();hostinterface.logMessage("SummaryWidgetDAO: got timeplayed data");o=x.lastTimePlayed;v=x.totalTimePlayed;g.resolve()});var w=null,z=null,B=null;j.always(function(){if(q)l.resolve();else{var x=ServiceFactory.getRequestFactory().createGetProfileRequest(b);
ServiceFactory.getRequestRouter().handleRequest(x).always(function(A){n=n||A.getType()!==constants.NativeCallResultCode.SUCCESS;if(w=A.getResultMap()){B=applicationContext.getObject("ProfileWidgetDAO").getLocalAvatarUrls([w.avatarUrl])[w.avatarUrl];z=w.avatarUrl}l.resolve()})}});var y={};p=s.achievementsExist();s=s.leaderboardsExist();$.when(p,s).always(function(x,A){y.achievementsExist=x==="false"?false:true;y.leaderboardsExist=A==="false"?false:true;m.resolve()});$.when(d,h,g,j,l,k,m).done(function(){var x=
{};x.leaderboards=r;x.achievements=t;x.lastTimePlayed=o;x.totalTimePlayed=v;x.isGuest=q;x.profile=w;x.avatarUrl=z;x.localAvatarUrl=B;x.isKindle=u;x.achievementsExist=y.achievementsExist;x.leaderboardsExist=y.leaderboardsExist;if(n)x.error=applicationContext.getObject("StringLocalizationWrapper").getString("global_error_generic");c.successHandler(x)})}};var a=function(c){hostinterface.logMessage("SummaryWidgetDAO: getData: processGetLeaderboardsResult start");var b=[];c=c.getResultMap().LeaderboardList;
c!==undefined&&$.each(c,function(d,h){var g={},j=h.PercentileRank,l=h.PlayerRank,k=h.PlayerScore,m=h.LeaderboardInfo;g.LEADERBOARD_ID=m.LeaderboardId;g.LEADERBOARD_NAME=m.Name;g.LEADERBOARD_DISPLAY_TEXT=m.DisplayText;g.LEADERBOARD_DATA_FORMAT=m.DataFormat;g.LEADERBOARD_ICON_URL=m.IconUrl;g.LEADERBOARD_POSITION=m.Position;g.LEADERBOARD_PERCENTILE_RANK=j;g.LEADERBOARD_PLAYER_RANK=l;g.LEADERBOARD_PLAYER_SCORE=k;b.push(g)});hostinterface.logMessage("SummaryWidgetDAO: getData: processGetLeaderboardsResult end");
return b},f=function(c){hostinterface.logMessage("SummaryWidgetDAO: getData: processGetAchievementsResult start");var b=[];if(c instanceof Result)if(c.getType()===constants.NativeCallResultCode.SUCCESS){replyCode=constants.NativeCallResultCode.SUCCESS;c=c.getResultMap().achievements;if(c!==undefined){c=c.achievements;c!==undefined&&$.each(c,function(d,h){var g={},j=h.achievementMeta,l=h.playerInfo||{};g.progress=l.progress;var k=j.largeIconUrl,m=j.lockedLargeIconUrl;g.image=g.progress===100?k:m;g.unlockdate=
l.unlocked?l.dateUnlocked:0;g.title=j.title;g.desc=j.description;g.hiddenValue=j.hiddenValue;j.unpublished?hostinterface.logMessage("unpublished achievement detected: "+g.title):b.push(g)})}}hostinterface.logMessage("SummaryWidgetDAO: getData: processGetAchievementsResult end");return b};return e}();
Page={Summary:0,Achievements:1,Leaderboards:2,LeaderboardRanks:3,Settings:4,LearnMore:5,Menu:6,Profile:7,FTUELogin:8,FTUETOS:9,FTUECORSelection:10,EditProfile:11,FTUECORUnsupported:12,FTUEAgeVerification:13,FTUEAgeViolation:14,AchievementSignInPrompt:15,LeaderboardSignInPrompt:16,SummaryPage:"sf",AchievementsPage:"dp",LeaderboardsPage:"fv",getPageFromURL:function(){return this.Summary}};
PageId={Summary:"Summary",Achievements:"Achievements",Leaderboards:"Leaderboards",LeaderboardRanks:"LeaderboardRanks",Settings:"Settings",LearnMore:"LearnMore",Menu:"Menu",Profile:"Profile",FTUELogin:"FTUELogin",FTUETOS:"FTUETOS",FTUECORSelection:"FTUECORSelection",EditProfile:"EditProfile",FTUECORUnsupported:"FTUECORUnsupported",WelcomeToast:"WelcomeToast",AchievementToast:"AchievementToast",LeaderboardToast:"LeaderboardToast",FTUEAgeVerification:"FTUEAgeVerification",FTUEAgeViolation:"FTUEAgeViolation",
AchievementSignInPrompt:"AchievementSignInPrompt",LeaderboardSignInPrompt:"LeaderboardSignInPrompt"};Truncation=function(){return{beautifyString:function(e){var a=/^.*[a-zA-Z0-9]/.exec(e);return null!==a&&0<a.length?a[0]+"...":e},truncate:function(e,a,f){var c=e,b=null;if(e&&e.length>a){c=e.substring(0,a);if(f)c+="...";else c=Truncation.beautifyString(c);b=e.slice(c.length-3)}return{fullString:e,shortString:c,remainderString:b}}}}();
DefaultReadyHandler={init:function(e){hostinterface.logMessage("DefaultReadyHandler.init called");onPlatformReady=function(){};applicationContext.initialize(e)}};window.onPlatformReady=function(e){hostinterface.logMessage("onPlatformReady called");$("body").scrollTop(0);applicationContext.getObject("ReadyHandler").init(e)};
