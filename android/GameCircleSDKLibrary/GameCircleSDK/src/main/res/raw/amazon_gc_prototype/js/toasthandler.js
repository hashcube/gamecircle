/*! Copyright 2013 Amazon Digital Services, Inc. All rights reserved. */
ToastHandler=(function(){var b=function(){var c="ToastRequest";this["getHandledType"]=function(){return c};this["handleRequest"]=function(f){var t=$.Deferred();if(!(f instanceof Request)){console.log("ToastHandler: handleRequest: input was not of type Request");var m=new Result(constants.NativeCallResultCode.REQUEST_FAILURE,{});t.resolve(m)}else{console.log("ToastHandler: handleRequest: message is: "+JSON.stringify(f.getType()));var d=f.getType();var u=f.getParams();var g=u.action;var n={};switch(g){case"toastClick":var r=u[constants.ToastKeys.TOAST_CLICK_DATA_KEY];var l=u[constants.ToastKeys.ACTION_MAPPINGS_KEY];if((l!==undefined)&&(l!==null)&&(r!==undefined)&&(r!==null)){$.each(l,function(z,y){if(a(y.actionType,r)){var D=ServiceFactory.getRequestFactory().createAPIRequest(y.actionRequest);ServiceFactory.getRequestRouter().handleRequest(D);var B=y.actionName;if(B===undefined||B===null){B="UNSPECIFIED"}var F=y.toastTypeMetric;if(F===undefined||F===null){F="UNSPECIFIED"}var E=new GameCircleEvent("ObjectClicked");E.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_OBJECT_ID,B);E.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,F);E.close();var w=y.experiment;var v=y.experimentTreatment;var C=y.experimentConversionKey;if(w!==undefined&&w!==null&&C!==undefined&&C!==null){var A=new GameCircleEvent(C);A.close();var x=new GameCircleEvent("ExperimentConversion");x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,w);x.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,v);x.close()}return false}})}break;case"toastMetric":var i=u[constants.ToastKeys.TOAST_REQUEST_DISPLAYED];if(i!==undefined&&i!==null){var p=i.toastTypeMetric;var q=i.isGuest;var o=i.experiment;var j=i.experimentTreatment;var h=i.experimentViewKey;var e=new GameCircleEvent("PageView");e.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_PAGE_ID,p);e.addAttribute(constants.MetricConstants.MetricRestrictedStringValueAttributeKeys_PAGE_TYPE,constants.MetricConstants.PageTypes_POPUP);e.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,q);e.close();if(o!==undefined&&o!==null&&h!==undefined&&h!==null){var k=new GameCircleEvent(h);k.close();var s=new GameCircleEvent("ExperimentView");s.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_TARGET_ID,o);s.addAttribute(constants.MetricConstants.MetricStringValueAttributesKeys_STATUS,j);s.close()}}break;default:console.log("ToastHandler: handleRequest: actionCode not supported: "+g);var m=new Result(constants.NativeCallResultCode.REQUEST_FAILURE,{});t.resolve(m)}}console.log("ToastHandler: handleRequest: end of call");return t.promise()}};var a=function(h,g){var e=g[constants.ToastKeys.TOAST_TOUCH_X_KEY];var d=g[constants.ToastKeys.TOAST_TOUCH_Y_KEY];var f=g[constants.ToastKeys.TOAST_WIDTH_KEY];var c=g[constants.ToastKeys.TOAST_HEIGHT_KEY];var i=false;if(h==="leftSideClicked"){if(e<=(f/2)){i=true}}else{if(h==="rightSideClicked"){if(e>=(f/2)){i=true}}else{if(h=="toastClicked"){i=true}}}return i};return b}());console.log("ToastHandler loaded.");