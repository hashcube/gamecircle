/*! Copyright 2013 Amazon Digital Services, Inc. All rights reserved. */
CountriesHandler=(function(){var a=function(c){var b=c;this["getDisplayableCountries"]=function(j){if(!b||!b.names){console.error("Country name mapping supplied to CountriesHandler was empty.  Returning empty list of countries.");var k=$.Deferred();k.resolve(new Result(constants.NativeCallResultCode.SUCCESS,{countries:[]}));return k.promise()}var e="en_US";var n=[];var h=j.languageCode;var l=j.countryCode;if(!h){h="en"}if(!l){l="US"}var i=e;var m="";try{m=h.toLowerCase()+"_"+l.toUpperCase()}catch(g){console.error("Invalid languageCode or countryCode provided.  languageCode was: "+h+" countryCode was: "+l)}if(b.names[m]){i=m}else{$.each(b.names,function(p,o){var r=p.split("_");if(r){var q=r[0];if(q===h){i=p;return false}}})}console.log("Target locale for country names: "+i);var f=b.names[i];var d=b.names[e];$.each(b.displayCodes,function(q,o){var r="";try{r=f[o]}catch(p){console.error("Target locale country mapping was undefined")}if(!r){try{r=d[o]}catch(p){console.error("Fallback locale country mapping was undefined")}console.error("No "+i+" translation for country code "+o)}if(r){n.push({code:o,name:r})}else{console.error("No displayable entry for country code "+o)}});n.sort(function(p,o){if(p.name<o.name){return -1}if(p.name>o.name){return 1}return 0});var k=$.Deferred();k.resolve(new Result(constants.NativeCallResultCode.SUCCESS,{countries:n}));return k.promise()};this["getHandledType"]=function(){return"CountriesRequest"}};a.prototype=BaseHandler;return a}());console.log("CountriesHandler loaded.");